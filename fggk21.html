<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.46">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Phillip Alday, Douglas Bates, and Reinhold Kliegl">
<meta name="dcterms.date" content="2024-06-27">

<title>Basics with Emotikon Project – SMLP2024: Advanced Frequentist Track</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script src="site_libs/quarto-contrib/jquery-3.6.3/jquery-3.6.3.min.js"></script>
<script src="site_libs/quarto-contrib/code-fullscreen-1.0.0/code-fullscreen.js" defer="true"></script>
<link href="site_libs/quarto-contrib/code-fullscreen-1.0.0/code-fullscreen.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">SMLP2024: Advanced Frequentist Track</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/RePsychLing/SMLP2024"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Basics with Emotikon Project</li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Getting started with Julia</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./useful_packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Useful packages</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pkg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Package management and reproducible environments</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./arrow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Saving data with Arrow</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Worked examples</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sleepstudy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Analysis of the sleepstudy data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sleepstudy_speed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The sleepstudy: Speed - for a change …</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./kwdyz11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">RePsychLing Kliegl et al.&nbsp;(2011)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./kkl15.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">RePsychLing Kliegl, Kuschela, &amp; Laubrock (2015)- Reduction of Model Complexity</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./largescaledesigned.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A large-scale designed experiment</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mrk17.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">RePsychLing Masson, Rabe, &amp; Kliegl, 2017) with Julia: Specification and selection</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./partial_within.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Partially-within subjects designs</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Contrast coding</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./contrasts_fggk21.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mixed Models Tutorial: Contrast Coding</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./contrasts_kwdyz11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Contrast Coding of Visual Attention Effects</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./glmm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Generalized linear mixed models</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">Bootstrap and profiling</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bootstrap.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Parametric bootstrap for mixed-effects models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./profiling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Confidence intervals from profiled objective</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./kb07.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bootstrapping a fitted model</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Visualizations and diagnostics</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./singularity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Convergence, singularity and all that</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./shrinkageplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">More on shrinkage plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./AoGPlots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Creating multi-panel plots</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul class="collapse">
  <li><a href="#packages-and-functions" id="toc-packages-and-functions" class="nav-link active" data-scroll-target="#packages-and-functions"><span class="header-section-number">1</span> Packages and functions</a></li>
  <li><a href="#readme" id="toc-readme" class="nav-link" data-scroll-target="#readme"><span class="header-section-number">2</span> Readme</a></li>
  <li><a href="#preprocessing" id="toc-preprocessing" class="nav-link" data-scroll-target="#preprocessing"><span class="header-section-number">3</span> Preprocessing</a>
  <ul class="collapse">
  <li><a href="#read-data" id="toc-read-data" class="nav-link" data-scroll-target="#read-data"><span class="header-section-number">3.1</span> Read data</a></li>
  <li><a href="#extract-a-stratified-subsample" id="toc-extract-a-stratified-subsample" class="nav-link" data-scroll-target="#extract-a-stratified-subsample"><span class="header-section-number">3.2</span> Extract a stratified subsample</a></li>
  <li><a href="#no-evidence-for-age-x-sex-x-test-interaction" id="toc-no-evidence-for-age-x-sex-x-test-interaction" class="nav-link" data-scroll-target="#no-evidence-for-age-x-sex-x-test-interaction"><span class="header-section-number">3.3</span> No evidence for <code>age x Sex x Test</code> interaction</a></li>
  <li><a href="#seqdiffcoding-of-test" id="toc-seqdiffcoding-of-test" class="nav-link" data-scroll-target="#seqdiffcoding-of-test"><span class="header-section-number">3.4</span> <em>SeqDiffCoding</em> of <code>Test</code></a></li>
  </ul></li>
  <li><a href="#model-complexification" id="toc-model-complexification" class="nav-link" data-scroll-target="#model-complexification"><span class="header-section-number">4</span> Model complexification</a>
  <ul class="collapse">
  <li><a href="#lmm-m_ovi" id="toc-lmm-m_ovi" class="nav-link" data-scroll-target="#lmm-m_ovi"><span class="header-section-number">4.1</span> LMM <code>m_ovi</code></a></li>
  <li><a href="#lmm-m_zcp" id="toc-lmm-m_zcp" class="nav-link" data-scroll-target="#lmm-m_zcp"><span class="header-section-number">4.2</span> LMM <code>m_zcp</code></a></li>
  <li><a href="#lmm-m_cpx" id="toc-lmm-m_cpx" class="nav-link" data-scroll-target="#lmm-m_cpx"><span class="header-section-number">4.3</span> LMM <code>m_cpx</code></a></li>
  <li><a href="#model-comparisons" id="toc-model-comparisons" class="nav-link" data-scroll-target="#model-comparisons"><span class="header-section-number">4.4</span> Model comparisons</a></li>
  <li><a href="#fitting-an-overparameterized-lmm" id="toc-fitting-an-overparameterized-lmm" class="nav-link" data-scroll-target="#fitting-an-overparameterized-lmm"><span class="header-section-number">4.5</span> Fitting an overparameterized LMM</a></li>
  <li><a href="#fitting-the-published-lmm-m1-to-the-reduced-data" id="toc-fitting-the-published-lmm-m1-to-the-reduced-data" class="nav-link" data-scroll-target="#fitting-the-published-lmm-m1-to-the-reduced-data"><span class="header-section-number">4.6</span> Fitting the published LMM <code>m1</code> to the reduced data</a></li>
  <li><a href="#principle-component-analysis-of-random-effect-structure-repca" id="toc-principle-component-analysis-of-random-effect-structure-repca" class="nav-link" data-scroll-target="#principle-component-analysis-of-random-effect-structure-repca"><span class="header-section-number">4.7</span> Principle Component Analysis of Random Effect Structure (rePCA)</a></li>
  <li><a href="#effects-in-res" id="toc-effects-in-res" class="nav-link" data-scroll-target="#effects-in-res"><span class="header-section-number">4.8</span> Effects in RES</a></li>
  <li><a href="#summary-of-results-for-stratified-subset-of-data" id="toc-summary-of-results-for-stratified-subset-of-data" class="nav-link" data-scroll-target="#summary-of-results-for-stratified-subset-of-data"><span class="header-section-number">4.9</span> Summary of results for stratified subset of data</a></li>
  </ul></li>
  <li><a href="#age-x-sex-nested-in-levels-of-test" id="toc-age-x-sex-nested-in-levels-of-test" class="nav-link" data-scroll-target="#age-x-sex-nested-in-levels-of-test"><span class="header-section-number">5</span> <code>Age x Sex</code> nested in levels of <code>Test</code></a></li>
  <li><a href="#glossary-of-mixedmodels.jl-commands" id="toc-glossary-of-mixedmodels.jl-commands" class="nav-link" data-scroll-target="#glossary-of-mixedmodels.jl-commands"><span class="header-section-number">6</span> Glossary of <em>MixedModels.jl</em> commands</a>
  <ul class="collapse">
  <li><a href="#overall-summary-statistics" id="toc-overall-summary-statistics" class="nav-link" data-scroll-target="#overall-summary-statistics"><span class="header-section-number">6.1</span> Overall summary statistics</a></li>
  <li><a href="#fixed-effect-statistics" id="toc-fixed-effect-statistics" class="nav-link" data-scroll-target="#fixed-effect-statistics"><span class="header-section-number">6.2</span> Fixed-effect statistics</a></li>
  <li><a href="#covariance-parameter-estimates" id="toc-covariance-parameter-estimates" class="nav-link" data-scroll-target="#covariance-parameter-estimates"><span class="header-section-number">6.3</span> Covariance parameter estimates</a></li>
  <li><a href="#model-predictions" id="toc-model-predictions" class="nav-link" data-scroll-target="#model-predictions"><span class="header-section-number">6.4</span> Model “predictions”</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul class="collapse"><li><a href="https://github.com/RePsychLing/SMLP2024/edit/main/fggk21.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/RePsychLing/SMLP2024/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Basics with Emotikon Project</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Phillip Alday, Douglas Bates, and Reinhold Kliegl </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">2024-06-27</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>This script uses a subset of data reported in <span class="citation" data-cites="Fuehner2021">Fühner et al. (<a href="#ref-Fuehner2021" role="doc-biblioref">2021</a>)</span>. To circumvent delays associated with model fitting we work with models that are less complex than those in the reference publication. All the data to reproduce the models in the publication are used here, too; the script requires only a few changes to specify the more complex models in the article.</p>
<p>The script is structured in four main sections:</p>
<ol type="1">
<li><strong>Setup</strong> with reading and examining the data, plotting the main results, and specifying the contrasts for the fixed factor <code>Test</code></li>
<li>a demonstration of <strong>model complexification</strong> to determine a parsimonious random-effect structure appropriate for and supported by the data, including also a quite elaborate demonstration of <strong>principle component analyses (PCAs)</strong> of levels (scores) and effects,</li>
<li>specification of <strong>nested fixed effects or interactions</strong> in the levels of another, superordinate factors,</li>
<li>a <strong>Glossary of MixedModels.jl commands</strong> to inspect the information generated for a fitted model object.</li>
</ol>
<section id="packages-and-functions" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Packages and functions</h1>
<div id="2" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">AlgebraOfGraphics</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">AlgebraOfGraphics</span>: linear</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Arrow</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">CairoMakie</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">CategoricalArrays</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Chain</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">DataFrameMacros</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">DataFrames</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">MixedModels</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">MixedModelsMakie</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">MixedModelsMakie</span>: simplelinreg</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">ProgressMeter</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Random</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Statistics</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">StatsBase</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">SMLP2024</span>: dataset</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>ProgressMeter.<span class="fu">ijulia_behavior</span>(<span class="op">:</span>clear)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>CairoMakie.<span class="fu">activate!</span>(; <span class="kw">type</span><span class="op">=</span><span class="st">"svg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="readme" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Readme</h1>
<p>Number of scores: 525126 in <code>dataset(:fggk21)</code></p>
<ol type="1">
<li><p>Cohort: 9 levels; 2011-2019</p></li>
<li><p>School: 515 levels</p></li>
<li><p>Child: 108295 levels; all children are between 8.0 and 8.99 years old</p></li>
<li><p>Sex: “Girls” (n=55,086), “Boys” (n= 53,209)</p></li>
<li><p>age: testdate - middle of month of birthdate</p></li>
<li><p>Test: 5 levels</p>
<ul>
<li>Endurance (<code>Run</code>): 6 minute endurance run [m]; to nearest 9m in 9x18m field</li>
<li>Coordination (<code>Star_r</code>): star coordination run [m/s]; 9x9m field, 4 x diagonal = 50.912 m</li>
<li>Speed(<code>S20_r</code>): 20-meters sprint [m/s]</li>
<li>Muscle power low (<code>SLJ</code>): standing long jump [cm]</li>
<li>Muscle power up (<code>BPT</code>): 1-kg medicine ball push test [m]</li>
</ul></li>
<li><p>score - see units</p></li>
</ol>
</section>
<section id="preprocessing" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Preprocessing</h1>
<section id="read-data" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="read-data"><span class="header-section-number">3.1</span> Read data</h2>
<div id="4" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> <span class="fu">DataFrame</span>(<span class="fu">dataset</span>(<span class="op">:</span>fggk21))</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">transform!</span>(df,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">:</span>age <span class="op">=&gt;</span> (x <span class="op">-&gt;</span> x <span class="op">.-</span> <span class="fl">8.5</span>) <span class="op">=&gt;</span> <span class="op">:</span>a1,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">:</span>Sex <span class="op">=&gt;</span> categorical <span class="op">=&gt;</span> <span class="op">:</span>Sex,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">:</span><span class="bu">Test</span> <span class="op">=&gt;</span> categorical <span class="op">=&gt;</span> <span class="op">:</span><span class="bu">Test</span>,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="fu">levels!</span>(df.Sex, [<span class="st">"male"</span>, <span class="st">"female"</span>])</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">recode!</span>(df.Sex, <span class="st">"male"</span> <span class="op">=&gt;</span> <span class="st">"Boys"</span>, <span class="st">"female"</span> <span class="op">=&gt;</span> <span class="st">"Girls"</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="fu">levels!</span>(df.<span class="bu">Test</span>, [<span class="st">"Run"</span>, <span class="st">"Star_r"</span>, <span class="st">"S20_r"</span>, <span class="st">"SLJ"</span>, <span class="st">"BPT"</span>])</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="fu">recode!</span>(</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  df.<span class="bu">Test</span>,</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Run"</span> <span class="op">=&gt;</span> <span class="st">"Endurance"</span>,</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Star_r"</span> <span class="op">=&gt;</span> <span class="st">"Coordination"</span>,</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">"S20_r"</span> <span class="op">=&gt;</span> <span class="st">"Speed"</span>,</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">"SLJ"</span> <span class="op">=&gt;</span> <span class="st">"PowerLOW"</span>,</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">"BPT"</span> <span class="op">=&gt;</span> <span class="st">"PowerUP"</span>,</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>8×7 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">variable</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">mean</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">min</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">median</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">max</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">nmissing</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">eltype</th>
</tr>
<tr class="odd subheader headerLastRow">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Symbol">Symbol</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Nothing, Float64}">Union…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Any">Any</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Nothing, Float64}">Union…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Any">Any</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="DataType">DataType</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">Cohort</td>
<td style="text-align: left; font-style: italic;"></td>
<td style="text-align: left;">2011</td>
<td style="text-align: left; font-style: italic;"></td>
<td style="text-align: left;">2019</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">String</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">School</td>
<td style="text-align: left; font-style: italic;"></td>
<td style="text-align: left;">S100043</td>
<td style="text-align: left; font-style: italic;"></td>
<td style="text-align: left;">S800200</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">String</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: left;">Child</td>
<td style="text-align: left; font-style: italic;"></td>
<td style="text-align: left;">C002352</td>
<td style="text-align: left; font-style: italic;"></td>
<td style="text-align: left;">C117966</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">String</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">4</td>
<td style="text-align: left;">Sex</td>
<td style="text-align: left; font-style: italic;"></td>
<td style="text-align: left;">Boys</td>
<td style="text-align: left; font-style: italic;"></td>
<td style="text-align: left;">Girls</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">CategoricalValue{String, UInt32}</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">5</td>
<td style="text-align: left;">age</td>
<td style="text-align: left;">8.56073</td>
<td style="text-align: left;">7.99452</td>
<td style="text-align: left;">8.55852</td>
<td style="text-align: left;">9.10609</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Float64</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">6</td>
<td style="text-align: left;">Test</td>
<td style="text-align: left; font-style: italic;"></td>
<td style="text-align: left;">Endurance</td>
<td style="text-align: left; font-style: italic;"></td>
<td style="text-align: left;">PowerUP</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">CategoricalValue{String, UInt32}</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">7</td>
<td style="text-align: left;">score</td>
<td style="text-align: left;">226.141</td>
<td style="text-align: left;">1.14152</td>
<td style="text-align: left;">4.65116</td>
<td style="text-align: left;">1530.0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Float64</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">8</td>
<td style="text-align: left;">a1</td>
<td style="text-align: left;">0.0607297</td>
<td style="text-align: left;">-0.505476</td>
<td style="text-align: left;">0.0585216</td>
<td style="text-align: left;">0.606092</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Float64</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<section id="transformations" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="transformations"><span class="header-section-number">3.1.1</span> Transformations</h3>
<p>We center <code>age</code> at 8.5 years and compute z-scores for each <code>Test</code>. With these variables the data frame <code>df</code> contains all variables used for the final model in the original publication.</p>
<div id="6" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select!</span>(<span class="fu">groupby</span>(df, <span class="op">:</span><span class="bu">Test</span>),  <span class="fu">Not</span>(<span class="op">:</span>score), <span class="op">:</span>score <span class="op">=&gt;</span> zscore <span class="op">=&gt;</span> <span class="op">:</span>zScore)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>525126×8 DataFrame</span></div><div style="float: right;"><span style="font-style: italic;">525101 rows omitted</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Cohort</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">School</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Child</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Sex</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">age</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">a1</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">zScore</th>
</tr>
<tr class="odd subheader headerLastRow">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt32}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt32}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">Speed</td>
<td style="text-align: left;">2013</td>
<td style="text-align: left;">S100067</td>
<td style="text-align: left;">C002352</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: right;">7.99452</td>
<td style="text-align: right;">-0.505476</td>
<td style="text-align: right;">1.7913</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">PowerUP</td>
<td style="text-align: left;">2013</td>
<td style="text-align: left;">S100067</td>
<td style="text-align: left;">C002352</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: right;">7.99452</td>
<td style="text-align: right;">-0.505476</td>
<td style="text-align: right;">-0.0622317</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: left;">PowerLOW</td>
<td style="text-align: left;">2013</td>
<td style="text-align: left;">S100067</td>
<td style="text-align: left;">C002352</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: right;">7.99452</td>
<td style="text-align: right;">-0.505476</td>
<td style="text-align: right;">-0.0336567</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">4</td>
<td style="text-align: left;">Coordination</td>
<td style="text-align: left;">2013</td>
<td style="text-align: left;">S100067</td>
<td style="text-align: left;">C002352</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: right;">7.99452</td>
<td style="text-align: right;">-0.505476</td>
<td style="text-align: right;">1.46874</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">5</td>
<td style="text-align: left;">Endurance</td>
<td style="text-align: left;">2013</td>
<td style="text-align: left;">S100067</td>
<td style="text-align: left;">C002352</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: right;">7.99452</td>
<td style="text-align: right;">-0.505476</td>
<td style="text-align: right;">0.331058</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">6</td>
<td style="text-align: left;">Speed</td>
<td style="text-align: left;">2013</td>
<td style="text-align: left;">S100067</td>
<td style="text-align: left;">C002353</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: right;">7.99452</td>
<td style="text-align: right;">-0.505476</td>
<td style="text-align: right;">1.15471</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">7</td>
<td style="text-align: left;">PowerUP</td>
<td style="text-align: left;">2013</td>
<td style="text-align: left;">S100067</td>
<td style="text-align: left;">C002353</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: right;">7.99452</td>
<td style="text-align: right;">-0.505476</td>
<td style="text-align: right;">0.498354</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">8</td>
<td style="text-align: left;">PowerLOW</td>
<td style="text-align: left;">2013</td>
<td style="text-align: left;">S100067</td>
<td style="text-align: left;">C002353</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: right;">7.99452</td>
<td style="text-align: right;">-0.505476</td>
<td style="text-align: right;">-0.498822</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">9</td>
<td style="text-align: left;">Coordination</td>
<td style="text-align: left;">2013</td>
<td style="text-align: left;">S100067</td>
<td style="text-align: left;">C002353</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: right;">7.99452</td>
<td style="text-align: right;">-0.505476</td>
<td style="text-align: right;">-0.9773</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">10</td>
<td style="text-align: left;">Endurance</td>
<td style="text-align: left;">2013</td>
<td style="text-align: left;">S100067</td>
<td style="text-align: left;">C002353</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: right;">7.99452</td>
<td style="text-align: right;">-0.505476</td>
<td style="text-align: right;">0.574056</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">11</td>
<td style="text-align: left;">Speed</td>
<td style="text-align: left;">2013</td>
<td style="text-align: left;">S100067</td>
<td style="text-align: left;">C002354</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: right;">7.99452</td>
<td style="text-align: right;">-0.505476</td>
<td style="text-align: right;">0.0551481</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">12</td>
<td style="text-align: left;">PowerUP</td>
<td style="text-align: left;">2013</td>
<td style="text-align: left;">S100067</td>
<td style="text-align: left;">C002354</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: right;">7.99452</td>
<td style="text-align: right;">-0.505476</td>
<td style="text-align: right;">0.218061</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">13</td>
<td style="text-align: left;">PowerLOW</td>
<td style="text-align: left;">2013</td>
<td style="text-align: left;">S100067</td>
<td style="text-align: left;">C002354</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: right;">7.99452</td>
<td style="text-align: right;">-0.505476</td>
<td style="text-align: right;">-0.757248</td>
</tr>
<tr class="even">
<td style="text-align: right;">⋮</td>
<td style="text-align: right;">⋮</td>
<td style="text-align: right;">⋮</td>
<td style="text-align: right;">⋮</td>
<td style="text-align: right;">⋮</td>
<td style="text-align: right;">⋮</td>
<td style="text-align: right;">⋮</td>
<td style="text-align: right;">⋮</td>
<td style="text-align: right;">⋮</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">525115</td>
<td style="text-align: left;">Coordination</td>
<td style="text-align: left;">2018</td>
<td style="text-align: left;">S401470</td>
<td style="text-align: left;">C117964</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: right;">9.10609</td>
<td style="text-align: right;">0.606092</td>
<td style="text-align: right;">-1.43175</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">525116</td>
<td style="text-align: left;">Endurance</td>
<td style="text-align: left;">2018</td>
<td style="text-align: left;">S401470</td>
<td style="text-align: left;">C117964</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: right;">9.10609</td>
<td style="text-align: right;">0.606092</td>
<td style="text-align: right;">-0.944681</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">525117</td>
<td style="text-align: left;">Speed</td>
<td style="text-align: left;">2018</td>
<td style="text-align: left;">S401470</td>
<td style="text-align: left;">C117965</td>
<td style="text-align: left;">Girls</td>
<td style="text-align: right;">9.10609</td>
<td style="text-align: right;">0.606092</td>
<td style="text-align: right;">0.31086</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">525118</td>
<td style="text-align: left;">PowerUP</td>
<td style="text-align: left;">2018</td>
<td style="text-align: left;">S401470</td>
<td style="text-align: left;">C117965</td>
<td style="text-align: left;">Girls</td>
<td style="text-align: right;">9.10609</td>
<td style="text-align: right;">0.606092</td>
<td style="text-align: right;">0.0779146</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">525119</td>
<td style="text-align: left;">PowerLOW</td>
<td style="text-align: left;">2018</td>
<td style="text-align: left;">S401470</td>
<td style="text-align: left;">C117965</td>
<td style="text-align: left;">Girls</td>
<td style="text-align: right;">9.10609</td>
<td style="text-align: right;">0.606092</td>
<td style="text-align: right;">-0.137027</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">525120</td>
<td style="text-align: left;">Coordination</td>
<td style="text-align: left;">2018</td>
<td style="text-align: left;">S401470</td>
<td style="text-align: left;">C117965</td>
<td style="text-align: left;">Girls</td>
<td style="text-align: right;">9.10609</td>
<td style="text-align: right;">0.606092</td>
<td style="text-align: right;">-1.8077</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">525121</td>
<td style="text-align: left;">Endurance</td>
<td style="text-align: left;">2018</td>
<td style="text-align: left;">S401470</td>
<td style="text-align: left;">C117965</td>
<td style="text-align: left;">Girls</td>
<td style="text-align: right;">9.10609</td>
<td style="text-align: right;">0.606092</td>
<td style="text-align: right;">0.513306</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">525122</td>
<td style="text-align: left;">Speed</td>
<td style="text-align: left;">2018</td>
<td style="text-align: left;">S800200</td>
<td style="text-align: left;">C117966</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: right;">9.10609</td>
<td style="text-align: right;">0.606092</td>
<td style="text-align: right;">0.0551481</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">525123</td>
<td style="text-align: left;">PowerUP</td>
<td style="text-align: left;">2018</td>
<td style="text-align: left;">S800200</td>
<td style="text-align: left;">C117966</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: right;">9.10609</td>
<td style="text-align: right;">0.606092</td>
<td style="text-align: right;">0.0779146</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">525124</td>
<td style="text-align: left;">PowerLOW</td>
<td style="text-align: left;">2018</td>
<td style="text-align: left;">S800200</td>
<td style="text-align: left;">C117966</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: right;">9.10609</td>
<td style="text-align: right;">0.606092</td>
<td style="text-align: right;">-1.32578</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">525125</td>
<td style="text-align: left;">Coordination</td>
<td style="text-align: left;">2018</td>
<td style="text-align: left;">S800200</td>
<td style="text-align: left;">C117966</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: right;">9.10609</td>
<td style="text-align: right;">0.606092</td>
<td style="text-align: right;">0.473217</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">525126</td>
<td style="text-align: left;">Endurance</td>
<td style="text-align: left;">2018</td>
<td style="text-align: left;">S800200</td>
<td style="text-align: left;">C117966</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: right;">9.10609</td>
<td style="text-align: right;">0.606092</td>
<td style="text-align: right;">-0.0941883</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
</section>
<section id="extract-a-stratified-subsample" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="extract-a-stratified-subsample"><span class="header-section-number">3.2</span> Extract a stratified subsample</h2>
<p>For the prupose of the tutorial, we extract a random sample of 1000 boys and 1000 girls. <code>Child</code>, <code>School</code>, and <code>Cohort</code> are grouping variables. Traditionally, they are called random factors because the units (levels) of the factor are assumed to be a random sample from the population of their units (levels).</p>
<p>Cohort has only nine “groups” and could have been included as a set of polynomical fixed-effect contrasts rather than a random factor. This choice warrants a short excursion: The secular trends are very different for different tests and require the inclusion of interaction terms with <code>Test</code> contrasts (see Figure 4 in <span class="citation" data-cites="Fuehner2021">(<a href="#ref-Fuehner2021" role="doc-biblioref">Fühner et al., 2021</a>)</span>. The authors opted to absorb these effects in cohort-related variance components for the <code>Test</code> contrasts and plan to address the details of secular changes in a separate analysis.</p>
<p>For complex designs, when they are in the theoretical focus of an article, factors and covariates should be specified as part of the fixed effects. If they are not in the theoretical focus, but serve as statistical control variables, they could be put in the RES - if supported by the data.</p>
<p><strong>Stratified sampling:</strong> We generate a <code>Child</code> table with information about children. <code>MersenneTwister(42)</code> specifies <strong>42</strong> as the seed for the random number generator to ensure reproducibility of the stratification. For a different pattern of results choose, for example, <strong>84</strong>. We randomly sample 1000 boys and 1000 girls from this table; they are stored in <code>samp</code>. Then, we extract the corresponding subset of these children’s test scores from <code>df</code> and store them <code>dat</code>.</p>
<div id="8" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>Child <span class="op">=</span> <span class="fu">unique</span>(<span class="fu">select</span>(df, <span class="op">:</span>Cohort, <span class="op">:</span>School, <span class="op">:</span>Child, <span class="op">:</span>Sex, <span class="op">:</span>age))</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>sample <span class="op">=</span> <span class="kw">let</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  rng <span class="op">=</span> <span class="fu">MersenneTwister</span>(<span class="fl">42</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">combine</span>(</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">groupby</span>(Child, <span class="op">:</span>Sex), x <span class="op">-&gt;</span> x[<span class="fu">rand</span>(rng, <span class="fl">1</span><span class="op">:</span><span class="fu">nrow</span>(x), <span class="fl">1000</span>), <span class="op">:</span>]</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="fu">insamp</span>(x) <span class="op">=</span> x <span class="op">∈</span> sample.Child</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>dat <span class="op">=</span> <span class="pp">@subset</span>(df, <span class="fu">insamp</span>(<span class="op">:</span>Child))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>9663×8 DataFrame</span></div><div style="float: right;"><span style="font-style: italic;">9638 rows omitted</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Cohort</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">School</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Child</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Sex</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">age</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">a1</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">zScore</th>
</tr>
<tr class="odd subheader headerLastRow">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt32}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt32}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">Speed</td>
<td style="text-align: left;">2013</td>
<td style="text-align: left;">S101540</td>
<td style="text-align: left;">C002482</td>
<td style="text-align: left;">Girls</td>
<td style="text-align: right;">7.99452</td>
<td style="text-align: right;">-0.505476</td>
<td style="text-align: right;">0.0551481</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">PowerUP</td>
<td style="text-align: left;">2013</td>
<td style="text-align: left;">S101540</td>
<td style="text-align: left;">C002482</td>
<td style="text-align: left;">Girls</td>
<td style="text-align: right;">7.99452</td>
<td style="text-align: right;">-0.505476</td>
<td style="text-align: right;">-0.342524</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: left;">PowerLOW</td>
<td style="text-align: left;">2013</td>
<td style="text-align: left;">S101540</td>
<td style="text-align: left;">C002482</td>
<td style="text-align: left;">Girls</td>
<td style="text-align: right;">7.99452</td>
<td style="text-align: right;">-0.505476</td>
<td style="text-align: right;">0.74162</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">4</td>
<td style="text-align: left;">Coordination</td>
<td style="text-align: left;">2013</td>
<td style="text-align: left;">S101540</td>
<td style="text-align: left;">C002482</td>
<td style="text-align: left;">Girls</td>
<td style="text-align: right;">7.99452</td>
<td style="text-align: right;">-0.505476</td>
<td style="text-align: right;">-0.209186</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">5</td>
<td style="text-align: left;">Endurance</td>
<td style="text-align: left;">2013</td>
<td style="text-align: left;">S101540</td>
<td style="text-align: left;">C002482</td>
<td style="text-align: left;">Girls</td>
<td style="text-align: right;">7.99452</td>
<td style="text-align: right;">-0.505476</td>
<td style="text-align: right;">-0.127938</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">6</td>
<td style="text-align: left;">Speed</td>
<td style="text-align: left;">2013</td>
<td style="text-align: left;">S102090</td>
<td style="text-align: left;">C002513</td>
<td style="text-align: left;">Girls</td>
<td style="text-align: right;">7.99452</td>
<td style="text-align: right;">-0.505476</td>
<td style="text-align: right;">-0.422921</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">7</td>
<td style="text-align: left;">PowerUP</td>
<td style="text-align: left;">2013</td>
<td style="text-align: left;">S102090</td>
<td style="text-align: left;">C002513</td>
<td style="text-align: left;">Girls</td>
<td style="text-align: right;">7.99452</td>
<td style="text-align: right;">-0.505476</td>
<td style="text-align: right;">-0.762963</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">8</td>
<td style="text-align: left;">PowerLOW</td>
<td style="text-align: left;">2013</td>
<td style="text-align: left;">S102090</td>
<td style="text-align: left;">C002513</td>
<td style="text-align: left;">Girls</td>
<td style="text-align: right;">7.99452</td>
<td style="text-align: right;">-0.505476</td>
<td style="text-align: right;">-0.188712</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">9</td>
<td style="text-align: left;">Coordination</td>
<td style="text-align: left;">2013</td>
<td style="text-align: left;">S102090</td>
<td style="text-align: left;">C002513</td>
<td style="text-align: left;">Girls</td>
<td style="text-align: right;">7.99452</td>
<td style="text-align: right;">-0.505476</td>
<td style="text-align: right;">0.81382</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">10</td>
<td style="text-align: left;">Endurance</td>
<td style="text-align: left;">2013</td>
<td style="text-align: left;">S102090</td>
<td style="text-align: left;">C002513</td>
<td style="text-align: left;">Girls</td>
<td style="text-align: right;">7.99452</td>
<td style="text-align: right;">-0.505476</td>
<td style="text-align: right;">0.452557</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">11</td>
<td style="text-align: left;">Speed</td>
<td style="text-align: left;">2013</td>
<td style="text-align: left;">S103299</td>
<td style="text-align: left;">C002621</td>
<td style="text-align: left;">Girls</td>
<td style="text-align: right;">7.99452</td>
<td style="text-align: right;">-0.505476</td>
<td style="text-align: right;">0.859704</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">12</td>
<td style="text-align: left;">PowerUP</td>
<td style="text-align: left;">2013</td>
<td style="text-align: left;">S103299</td>
<td style="text-align: left;">C002621</td>
<td style="text-align: left;">Girls</td>
<td style="text-align: right;">7.99452</td>
<td style="text-align: right;">-0.505476</td>
<td style="text-align: right;">0.218061</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">13</td>
<td style="text-align: left;">PowerLOW</td>
<td style="text-align: left;">2013</td>
<td style="text-align: left;">S103299</td>
<td style="text-align: left;">C002621</td>
<td style="text-align: left;">Girls</td>
<td style="text-align: right;">7.99452</td>
<td style="text-align: right;">-0.505476</td>
<td style="text-align: right;">0.74162</td>
</tr>
<tr class="even">
<td style="text-align: right;">⋮</td>
<td style="text-align: right;">⋮</td>
<td style="text-align: right;">⋮</td>
<td style="text-align: right;">⋮</td>
<td style="text-align: right;">⋮</td>
<td style="text-align: right;">⋮</td>
<td style="text-align: right;">⋮</td>
<td style="text-align: right;">⋮</td>
<td style="text-align: right;">⋮</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">9652</td>
<td style="text-align: left;">Coordination</td>
<td style="text-align: left;">2018</td>
<td style="text-align: left;">S111508</td>
<td style="text-align: left;">C117805</td>
<td style="text-align: left;">Girls</td>
<td style="text-align: right;">9.10609</td>
<td style="text-align: right;">0.606092</td>
<td style="text-align: right;">-0.95589</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">9653</td>
<td style="text-align: left;">Endurance</td>
<td style="text-align: left;">2018</td>
<td style="text-align: left;">S111508</td>
<td style="text-align: left;">C117805</td>
<td style="text-align: left;">Girls</td>
<td style="text-align: right;">9.10609</td>
<td style="text-align: right;">0.606092</td>
<td style="text-align: right;">-1.67367</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">9654</td>
<td style="text-align: left;">Speed</td>
<td style="text-align: left;">2018</td>
<td style="text-align: left;">S111648</td>
<td style="text-align: left;">C117827</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: right;">9.10609</td>
<td style="text-align: right;">0.606092</td>
<td style="text-align: right;">0.859704</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">9655</td>
<td style="text-align: left;">PowerUP</td>
<td style="text-align: left;">2018</td>
<td style="text-align: left;">S111648</td>
<td style="text-align: left;">C117827</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: right;">9.10609</td>
<td style="text-align: right;">0.606092</td>
<td style="text-align: right;">0.6385</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">9656</td>
<td style="text-align: left;">PowerLOW</td>
<td style="text-align: left;">2018</td>
<td style="text-align: left;">S111648</td>
<td style="text-align: left;">C117827</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: right;">9.10609</td>
<td style="text-align: right;">0.606092</td>
<td style="text-align: right;">0.483194</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">9657</td>
<td style="text-align: left;">Coordination</td>
<td style="text-align: left;">2018</td>
<td style="text-align: left;">S111648</td>
<td style="text-align: left;">C117827</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: right;">9.10609</td>
<td style="text-align: right;">0.606092</td>
<td style="text-align: right;">0.708474</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">9658</td>
<td style="text-align: left;">Endurance</td>
<td style="text-align: left;">2018</td>
<td style="text-align: left;">S111648</td>
<td style="text-align: left;">C117827</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: right;">9.10609</td>
<td style="text-align: right;">0.606092</td>
<td style="text-align: right;">-0.337186</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">9659</td>
<td style="text-align: left;">Speed</td>
<td style="text-align: left;">2018</td>
<td style="text-align: left;">S112197</td>
<td style="text-align: left;">C117868</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: right;">9.10609</td>
<td style="text-align: right;">0.606092</td>
<td style="text-align: right;">0.578748</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">9660</td>
<td style="text-align: left;">PowerUP</td>
<td style="text-align: left;">2018</td>
<td style="text-align: left;">S112197</td>
<td style="text-align: left;">C117868</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: right;">9.10609</td>
<td style="text-align: right;">0.606092</td>
<td style="text-align: right;">0.498354</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">9661</td>
<td style="text-align: left;">PowerLOW</td>
<td style="text-align: left;">2018</td>
<td style="text-align: left;">S112197</td>
<td style="text-align: left;">C117868</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: right;">9.10609</td>
<td style="text-align: right;">0.606092</td>
<td style="text-align: right;">-0.550508</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">9662</td>
<td style="text-align: left;">Coordination</td>
<td style="text-align: left;">2018</td>
<td style="text-align: left;">S112197</td>
<td style="text-align: left;">C117868</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: right;">9.10609</td>
<td style="text-align: right;">0.606092</td>
<td style="text-align: right;">0.538978</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">9663</td>
<td style="text-align: left;">Endurance</td>
<td style="text-align: left;">2018</td>
<td style="text-align: left;">S112197</td>
<td style="text-align: left;">C117868</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: right;">9.10609</td>
<td style="text-align: right;">0.606092</td>
<td style="text-align: right;">0.938553</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Due to missing scores for some tests we have about 2% less than 10,000 observtions.</p>
</section>
<section id="no-evidence-for-age-x-sex-x-test-interaction" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="no-evidence-for-age-x-sex-x-test-interaction"><span class="header-section-number">3.3</span> No evidence for <code>age x Sex x Test</code> interaction</h2>
<p>The main results are captured in the figure constructed in this section. We build it both for the full data and the stratified subset.</p>
<div id="10" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> <span class="fu">combine</span>(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">groupby</span>(</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(df, <span class="op">:</span>, <span class="op">:</span>age <span class="op">=&gt;</span> <span class="fu">ByRow</span>(x <span class="op">-&gt;</span> <span class="fu">round</span>(x; digits<span class="op">=</span><span class="fl">1</span>)) <span class="op">=&gt;</span> <span class="op">:</span>age),</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    [<span class="op">:</span>Sex, <span class="op">:</span><span class="bu">Test</span>, <span class="op">:</span>age],</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="op">:</span>zScore <span class="op">=&gt;</span> mean <span class="op">=&gt;</span> <span class="op">:</span>zScore,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="op">:</span>zScore <span class="op">=&gt;</span> length <span class="op">=&gt;</span> <span class="op">:</span>n,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>120×5 DataFrame</span></div><div style="float: right;"><span style="font-style: italic;">95 rows omitted</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Sex</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">age</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">zScore</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">n</th>
</tr>
<tr class="odd subheader headerLastRow">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt32}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt32}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: left;">Speed</td>
<td style="text-align: right;">8.0</td>
<td style="text-align: right;">-0.0265138</td>
<td style="text-align: right;">1223</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: left;">PowerUP</td>
<td style="text-align: right;">8.0</td>
<td style="text-align: right;">0.026973</td>
<td style="text-align: right;">1227</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: left;">PowerLOW</td>
<td style="text-align: right;">8.0</td>
<td style="text-align: right;">0.121609</td>
<td style="text-align: right;">1227</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">4</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: left;">Coordination</td>
<td style="text-align: right;">8.0</td>
<td style="text-align: right;">-0.0571726</td>
<td style="text-align: right;">1186</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">5</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: left;">Endurance</td>
<td style="text-align: right;">8.0</td>
<td style="text-align: right;">0.292695</td>
<td style="text-align: right;">1210</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">6</td>
<td style="text-align: left;">Girls</td>
<td style="text-align: left;">Speed</td>
<td style="text-align: right;">8.0</td>
<td style="text-align: right;">-0.35164</td>
<td style="text-align: right;">1411</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">7</td>
<td style="text-align: left;">Girls</td>
<td style="text-align: left;">PowerUP</td>
<td style="text-align: right;">8.0</td>
<td style="text-align: right;">-0.610355</td>
<td style="text-align: right;">1417</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">8</td>
<td style="text-align: left;">Girls</td>
<td style="text-align: left;">PowerLOW</td>
<td style="text-align: right;">8.0</td>
<td style="text-align: right;">-0.279872</td>
<td style="text-align: right;">1418</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">9</td>
<td style="text-align: left;">Girls</td>
<td style="text-align: left;">Coordination</td>
<td style="text-align: right;">8.0</td>
<td style="text-align: right;">-0.268221</td>
<td style="text-align: right;">1381</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">10</td>
<td style="text-align: left;">Girls</td>
<td style="text-align: left;">Endurance</td>
<td style="text-align: right;">8.0</td>
<td style="text-align: right;">-0.245573</td>
<td style="text-align: right;">1387</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">11</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: left;">Speed</td>
<td style="text-align: right;">8.1</td>
<td style="text-align: right;">0.0608397</td>
<td style="text-align: right;">3042</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">12</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: left;">PowerUP</td>
<td style="text-align: right;">8.1</td>
<td style="text-align: right;">0.0955413</td>
<td style="text-align: right;">3069</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">13</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: left;">PowerLOW</td>
<td style="text-align: right;">8.1</td>
<td style="text-align: right;">0.123099</td>
<td style="text-align: right;">3069</td>
</tr>
<tr class="even">
<td style="text-align: right;">⋮</td>
<td style="text-align: right;">⋮</td>
<td style="text-align: right;">⋮</td>
<td style="text-align: right;">⋮</td>
<td style="text-align: right;">⋮</td>
<td style="text-align: right;">⋮</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">109</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: left;">Coordination</td>
<td style="text-align: right;">9.0</td>
<td style="text-align: right;">0.254973</td>
<td style="text-align: right;">4049</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">110</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: left;">Endurance</td>
<td style="text-align: right;">9.0</td>
<td style="text-align: right;">0.258082</td>
<td style="text-align: right;">4034</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">111</td>
<td style="text-align: left;">Girls</td>
<td style="text-align: left;">Speed</td>
<td style="text-align: right;">9.1</td>
<td style="text-align: right;">-0.0286172</td>
<td style="text-align: right;">1154</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">112</td>
<td style="text-align: left;">Girls</td>
<td style="text-align: left;">PowerUP</td>
<td style="text-align: right;">9.1</td>
<td style="text-align: right;">-0.0752301</td>
<td style="text-align: right;">1186</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">113</td>
<td style="text-align: left;">Girls</td>
<td style="text-align: left;">PowerLOW</td>
<td style="text-align: right;">9.1</td>
<td style="text-align: right;">-0.094587</td>
<td style="text-align: right;">1174</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">114</td>
<td style="text-align: left;">Girls</td>
<td style="text-align: left;">Coordination</td>
<td style="text-align: right;">9.1</td>
<td style="text-align: right;">0.00276252</td>
<td style="text-align: right;">1162</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">115</td>
<td style="text-align: left;">Girls</td>
<td style="text-align: left;">Endurance</td>
<td style="text-align: right;">9.1</td>
<td style="text-align: right;">-0.235591</td>
<td style="text-align: right;">1150</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">116</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: left;">Speed</td>
<td style="text-align: right;">9.1</td>
<td style="text-align: right;">0.325745</td>
<td style="text-align: right;">1303</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">117</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: left;">PowerUP</td>
<td style="text-align: right;">9.1</td>
<td style="text-align: right;">0.616416</td>
<td style="text-align: right;">1320</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">118</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: left;">PowerLOW</td>
<td style="text-align: right;">9.1</td>
<td style="text-align: right;">0.267577</td>
<td style="text-align: right;">1310</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">119</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: left;">Coordination</td>
<td style="text-align: right;">9.1</td>
<td style="text-align: right;">0.254342</td>
<td style="text-align: right;">1297</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">120</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: left;">Endurance</td>
<td style="text-align: right;">9.1</td>
<td style="text-align: right;">0.251045</td>
<td style="text-align: right;">1294</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<section id="figures-of-interaction" class="level3" data-number="3.3.1">
<h3 data-number="3.3.1" class="anchored" data-anchor-id="figures-of-interaction"><span class="header-section-number">3.3.1</span> Figure(s) of interaction</h3>
<p>The core results of the article are reported in Figure 2 of <span class="citation" data-cites="Fuehner2021">Fühner et al. (<a href="#ref-Fuehner2021" role="doc-biblioref">2021</a>)</span>. In summary:</p>
<ul>
<li>Main effects of <code>age</code> and <code>Sex</code>: There are developmental gains in the ninth year of life; boys outperform girls. There is no main effect of <code>Test</code> because of z-scoring.</li>
<li>Interactions of <code>Test</code> and <code>age</code>: Tests differ in how much children improve during the year (i.e., the magnitude of developmental gain), that is slopes depend on <code>Test</code>.</li>
<li>Interactions of <code>Test</code> and <code>Sex</code>: The sex difference is test dependent, that is the difference between the slopes depends on <code>Test</code>.</li>
<li>The most distinctive result is the absence of evidence for an <code>age x Sex x Test</code> interaction, that is the slopes for boys and girls are statistically parallel for each of the five tests.</li>
</ul>
<div id="cell-fig-agetrends" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  design1 <span class="op">=</span> <span class="fu">mapping</span>(<span class="op">:</span>age, <span class="op">:</span>zScore; color<span class="op">=:</span>Sex, col<span class="op">=:</span><span class="bu">Test</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  lines1 <span class="op">=</span> design1 <span class="op">*</span> <span class="fu">linear</span>()</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  means1 <span class="op">=</span> design1 <span class="op">*</span> <span class="fu">visual</span>(Scatter; markersize<span class="op">=</span><span class="fl">5</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">draw</span>(<span class="fu">data</span>(df2) <span class="op">*</span> means1 <span class="op">+</span> <span class="fu">data</span>(df) <span class="op">*</span> lines1;)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="1">
<div id="fig-agetrends" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-agetrends-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fggk21_files/figure-html/fig-agetrends-output-1.svg" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-agetrends-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Age trends by sex for each Test for the full data set
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-agetrends" class="quarto-xref">Figure&nbsp;1</a> shows performance differences for the <strong>full set of data</strong> between 8.0 and 9.2 years by sex in the five physical fitness tests presented as z-transformed data computed separately for each test.</p>
<ul>
<li><code>Endurance</code> = cardiorespiratory endurance (i.e., 6-min-run test),</li>
<li><code>Coordination</code> = star-run test,</li>
<li><code>Speed</code> = 20-m linear sprint test,</li>
<li><code>PowerLOW</code> = power of lower limbs (i.e., standing long jump test),</li>
<li><code>PowerUP</code> = power of upper limbs (i.e., ball push test),</li>
<li>SD = standard deviation. Points are binned observed child means; lines are simple regression fits to the observations.</li>
</ul>
<p>What do the results look like for the stratified subsample? Here the parallelism is much less clear. In the final LMM we test whether the two regression lines in each of the five panels are statistically parallel for this subset of data. That is, we test the interaction of <code>Sex</code> and <code>age</code> as nested within the levels of <code>Test</code>. Most people want to know the signficance of these five Sex x age interactions.</p>
<p>The theoretical focus of the article, however, is on comparisons between tests displayed next to each other. We ask whether the degree of parallelism is statistically the same for <code>Endurance</code> and <code>Coordination</code> (H1), <code>Coordination</code> and <code>Speed</code> (H2), <code>Speed</code> and <code>PowerLOW</code> (H3), and <code>PowerLow</code> and <code>PowerUP</code> (H4). Hypotheses H1 to H4 require <code>Sequential Difference</code> contrasts c1 to c4 for <code>Test</code>; they are tested as fixed effects for`<code>H1 x age x Sex</code>, <code>H2 x age x Sex</code>, <code>H3 x age x Sex</code>, and <code>H4 x age x Sex</code>.</p>
<div id="14" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>dat2 <span class="op">=</span> <span class="fu">combine</span>(</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">groupby</span>(</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(dat, <span class="op">:</span>, <span class="op">:</span>age <span class="op">=&gt;</span> <span class="fu">ByRow</span>(x <span class="op">-&gt;</span> <span class="fu">round</span>(x; digits<span class="op">=</span><span class="fl">1</span>)) <span class="op">=&gt;</span> <span class="op">:</span>age),</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    [<span class="op">:</span>Sex, <span class="op">:</span><span class="bu">Test</span>, <span class="op">:</span>age],</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="op">:</span>zScore <span class="op">=&gt;</span> mean <span class="op">=&gt;</span> <span class="op">:</span>zScore,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="op">:</span>zScore <span class="op">=&gt;</span> length <span class="op">=&gt;</span> <span class="op">:</span>n,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>120×5 DataFrame</span></div><div style="float: right;"><span style="font-style: italic;">95 rows omitted</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Sex</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">age</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">zScore</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">n</th>
</tr>
<tr class="odd subheader headerLastRow">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt32}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt32}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">Girls</td>
<td style="text-align: left;">Speed</td>
<td style="text-align: right;">8.0</td>
<td style="text-align: right;">-0.323114</td>
<td style="text-align: right;">28</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">Girls</td>
<td style="text-align: left;">PowerUP</td>
<td style="text-align: right;">8.0</td>
<td style="text-align: right;">-0.590476</td>
<td style="text-align: right;">26</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: left;">Girls</td>
<td style="text-align: left;">PowerLOW</td>
<td style="text-align: right;">8.0</td>
<td style="text-align: right;">0.0677992</td>
<td style="text-align: right;">27</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">4</td>
<td style="text-align: left;">Girls</td>
<td style="text-align: left;">Coordination</td>
<td style="text-align: right;">8.0</td>
<td style="text-align: right;">0.0273318</td>
<td style="text-align: right;">25</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">5</td>
<td style="text-align: left;">Girls</td>
<td style="text-align: left;">Endurance</td>
<td style="text-align: right;">8.0</td>
<td style="text-align: right;">-0.17337</td>
<td style="text-align: right;">26</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">6</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: left;">Speed</td>
<td style="text-align: right;">8.0</td>
<td style="text-align: right;">0.394634</td>
<td style="text-align: right;">19</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">7</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: left;">PowerUP</td>
<td style="text-align: right;">8.0</td>
<td style="text-align: right;">0.328703</td>
<td style="text-align: right;">19</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">8</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: left;">PowerLOW</td>
<td style="text-align: right;">8.0</td>
<td style="text-align: right;">0.105077</td>
<td style="text-align: right;">19</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">9</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: left;">Coordination</td>
<td style="text-align: right;">8.0</td>
<td style="text-align: right;">-0.170018</td>
<td style="text-align: right;">19</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">10</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: left;">Endurance</td>
<td style="text-align: right;">8.0</td>
<td style="text-align: right;">0.407084</td>
<td style="text-align: right;">19</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">11</td>
<td style="text-align: left;">Girls</td>
<td style="text-align: left;">Speed</td>
<td style="text-align: right;">8.1</td>
<td style="text-align: right;">-0.205934</td>
<td style="text-align: right;">54</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">12</td>
<td style="text-align: left;">Girls</td>
<td style="text-align: left;">PowerUP</td>
<td style="text-align: right;">8.1</td>
<td style="text-align: right;">-0.653961</td>
<td style="text-align: right;">54</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">13</td>
<td style="text-align: left;">Girls</td>
<td style="text-align: left;">PowerLOW</td>
<td style="text-align: right;">8.1</td>
<td style="text-align: right;">-0.157127</td>
<td style="text-align: right;">54</td>
</tr>
<tr class="even">
<td style="text-align: right;">⋮</td>
<td style="text-align: right;">⋮</td>
<td style="text-align: right;">⋮</td>
<td style="text-align: right;">⋮</td>
<td style="text-align: right;">⋮</td>
<td style="text-align: right;">⋮</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">109</td>
<td style="text-align: left;">Girls</td>
<td style="text-align: left;">Coordination</td>
<td style="text-align: right;">9.0</td>
<td style="text-align: right;">-0.000188842</td>
<td style="text-align: right;">68</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">110</td>
<td style="text-align: left;">Girls</td>
<td style="text-align: left;">Endurance</td>
<td style="text-align: right;">9.0</td>
<td style="text-align: right;">-0.234448</td>
<td style="text-align: right;">68</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">111</td>
<td style="text-align: left;">Girls</td>
<td style="text-align: left;">Speed</td>
<td style="text-align: right;">9.1</td>
<td style="text-align: right;">-0.285047</td>
<td style="text-align: right;">25</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">112</td>
<td style="text-align: left;">Girls</td>
<td style="text-align: left;">PowerUP</td>
<td style="text-align: right;">9.1</td>
<td style="text-align: right;">-0.112684</td>
<td style="text-align: right;">25</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">113</td>
<td style="text-align: left;">Girls</td>
<td style="text-align: left;">PowerLOW</td>
<td style="text-align: right;">9.1</td>
<td style="text-align: right;">-0.117645</td>
<td style="text-align: right;">24</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">114</td>
<td style="text-align: left;">Girls</td>
<td style="text-align: left;">Coordination</td>
<td style="text-align: right;">9.1</td>
<td style="text-align: right;">-0.127844</td>
<td style="text-align: right;">25</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">115</td>
<td style="text-align: left;">Girls</td>
<td style="text-align: left;">Endurance</td>
<td style="text-align: right;">9.1</td>
<td style="text-align: right;">-0.587496</td>
<td style="text-align: right;">24</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">116</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: left;">Speed</td>
<td style="text-align: right;">9.1</td>
<td style="text-align: right;">0.379808</td>
<td style="text-align: right;">17</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">117</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: left;">PowerUP</td>
<td style="text-align: right;">9.1</td>
<td style="text-align: right;">0.523085</td>
<td style="text-align: right;">17</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">118</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: left;">PowerLOW</td>
<td style="text-align: right;">9.1</td>
<td style="text-align: right;">0.294696</td>
<td style="text-align: right;">17</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">119</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: left;">Coordination</td>
<td style="text-align: right;">9.1</td>
<td style="text-align: right;">0.209309</td>
<td style="text-align: right;">16</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">120</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: left;">Endurance</td>
<td style="text-align: right;">9.1</td>
<td style="text-align: right;">0.266512</td>
<td style="text-align: right;">16</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="cell-fig-agetrendssamp" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  design2 <span class="op">=</span> <span class="fu">mapping</span>(<span class="op">:</span>age, <span class="op">:</span>zScore; color<span class="op">=:</span>Sex, col<span class="op">=:</span><span class="bu">Test</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  lines2 <span class="op">=</span> design2 <span class="op">*</span> <span class="fu">linear</span>()</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  means2 <span class="op">=</span> design2 <span class="op">*</span> <span class="fu">visual</span>(Scatter; markersize<span class="op">=</span><span class="fl">5</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">draw</span>(<span class="fu">data</span>(dat2) <span class="op">*</span> means2 <span class="op">+</span> <span class="fu">data</span>(dat) <span class="op">*</span> lines2;)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="1">
<div id="fig-agetrendssamp" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-agetrendssamp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fggk21_files/figure-html/fig-agetrendssamp-output-1.svg" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-agetrendssamp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Age trends by sex for each Test for the stratified sample
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-agetrendssamp" class="quarto-xref">Figure&nbsp;2</a> Performance differences for <strong>subset of data</strong> between 8.0 and 9.2 years by sex in the five physical fitness tests presented as z-transformed data computed separately for each test.</p>
<ul>
<li><code>Endurance</code> = cardiorespiratory endurance (i.e., 6-min-run test),</li>
<li><code>Coordination</code> = star-run test,</li>
<li><code>Speed</code> = 20-m linear sprint test,</li>
<li><code>PowerLOW</code> = power of lower limbs (i.e., standing long jump test),</li>
<li><code>PowerUP</code> = power of upper limbs (i.e., ball push test),</li>
<li>SD = standard deviation. Points are binned observed child means; lines are simple regression fits to the observations.</li>
</ul>
</section>
<section id="regression-on-age-by-sex-for-each-test" class="level3" data-number="3.3.2">
<h3 data-number="3.3.2" class="anchored" data-anchor-id="regression-on-age-by-sex-for-each-test"><span class="header-section-number">3.3.2</span> Regression on <code>age</code> by <code>Sex</code> for each <code>Test</code></h3>
<p>Another set of relevant statistics are the slopes for the regression of performance on age for boys and girls in each of the five tests. The lines in Figures 1 and 2, however, are computed directly from the raw data with the <code>linear()</code> command.</p>
<div id="18" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">combine</span>(</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">groupby</span>(df, [<span class="op">:</span>Sex, <span class="op">:</span><span class="bu">Test</span>]),</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  [<span class="op">:</span>age, <span class="op">:</span>zScore] <span class="op">=&gt;</span> simplelinreg <span class="op">=&gt;</span> <span class="op">:</span>coef,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>10×3 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Sex</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">coef</th>
</tr>
<tr class="odd subheader headerLastRow">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt32}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt32}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Tuple{Float64, Float64}">Tuple…</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: left;">Endurance</td>
<td style="text-align: left;">(0.00256718, 0.0291899)</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: left;">Coordination</td>
<td style="text-align: left;">(-2.47279, 0.302819)</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: left;">Speed</td>
<td style="text-align: left;">(-2.12689, 0.267153)</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">4</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: left;">PowerLOW</td>
<td style="text-align: left;">(-1.4307, 0.189659)</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">5</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: left;">PowerUP</td>
<td style="text-align: left;">(-4.35864, 0.549005)</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">6</td>
<td style="text-align: left;">Girls</td>
<td style="text-align: left;">Endurance</td>
<td style="text-align: left;">(-0.692022, 0.0523217)</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">7</td>
<td style="text-align: left;">Girls</td>
<td style="text-align: left;">Coordination</td>
<td style="text-align: left;">(-2.50524, 0.279119)</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">8</td>
<td style="text-align: left;">Girls</td>
<td style="text-align: left;">Speed</td>
<td style="text-align: left;">(-2.34431, 0.255687)</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">9</td>
<td style="text-align: left;">Girls</td>
<td style="text-align: left;">PowerLOW</td>
<td style="text-align: left;">(-1.87241, 0.196917)</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">10</td>
<td style="text-align: left;">Girls</td>
<td style="text-align: left;">PowerUP</td>
<td style="text-align: left;">(-4.82271, 0.524799)</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="20" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">combine</span>(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">groupby</span>(dat, [<span class="op">:</span>Sex, <span class="op">:</span><span class="bu">Test</span>]),</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  [<span class="op">:</span>age, <span class="op">:</span>zScore] <span class="op">=&gt;</span> simplelinreg <span class="op">=&gt;</span> <span class="op">:</span>coef,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>10×3 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Sex</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">coef</th>
</tr>
<tr class="odd subheader headerLastRow">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt32}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt32}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Tuple{Float64, Float64}">Tuple…</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: left;">Endurance</td>
<td style="text-align: left;">(0.39203, -0.0150694)</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: left;">Coordination</td>
<td style="text-align: left;">(-3.33518, 0.401051)</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: left;">Speed</td>
<td style="text-align: left;">(-1.75685, 0.228662)</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">4</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: left;">PowerLOW</td>
<td style="text-align: left;">(-1.06646, 0.151546)</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">5</td>
<td style="text-align: left;">Boys</td>
<td style="text-align: left;">PowerUP</td>
<td style="text-align: left;">(-4.15536, 0.5245)</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">6</td>
<td style="text-align: left;">Girls</td>
<td style="text-align: left;">Endurance</td>
<td style="text-align: left;">(0.941712, -0.141158)</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">7</td>
<td style="text-align: left;">Girls</td>
<td style="text-align: left;">Coordination</td>
<td style="text-align: left;">(-0.681898, 0.0714891)</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">8</td>
<td style="text-align: left;">Girls</td>
<td style="text-align: left;">Speed</td>
<td style="text-align: left;">(-0.786382, 0.0725931)</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">9</td>
<td style="text-align: left;">Girls</td>
<td style="text-align: left;">PowerLOW</td>
<td style="text-align: left;">(-0.208472, 0.00150731)</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">10</td>
<td style="text-align: left;">Girls</td>
<td style="text-align: left;">PowerUP</td>
<td style="text-align: left;">(-5.23593, 0.570806)</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
</section>
<section id="seqdiffcoding-of-test" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="seqdiffcoding-of-test"><span class="header-section-number">3.4</span> <em>SeqDiffCoding</em> of <code>Test</code></h2>
<p><em>SeqDiffCoding</em> was used in the publication. This specification tests pairwise differences between the five neighboring levels of <code>Test</code>, that is:</p>
<ul>
<li>H1: <code>Star_r</code> - <code>Run</code> (2-1)</li>
<li>H2: <code>S20_r</code> - <code>Star_r</code> (3-2)</li>
<li>H3: <code>SLJ</code> - <code>S20_r</code> (4-3)</li>
<li>H4: <code>BPT</code> - <code>SLJ</code> (5-4)</li>
</ul>
<p>The levels were sorted such that these contrasts map onto four <em>a priori</em> hypotheses; in other words, they are <em>theoretically</em> motivated pairwise comparisons. The motivation also encompasses theoretically motivated interactions with <code>Sex</code>. The order of levels can also be explicitly specified during contrast construction. This is very useful if levels are in a different order in the dataframe.</p>
<p>Note that random factors <code>Child</code>, <code>School</code>, and <code>Cohort</code> are declared as <code>Grouping</code> variables. Technically, this specification is required for variables with a very large number of levels (e.g., 100K+ children). We recommend the explicit specification for all random factors as a general coding style.</p>
<p>The first command recodes names indicating the physical fitness components used in the above figures and tables back to the shorter actual test names. This reduces clutter in LMM outputs.</p>
<div id="22" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">recode!</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  dat.<span class="bu">Test</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Endurance"</span> <span class="op">=&gt;</span> <span class="st">"Run"</span>,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Coordination"</span> <span class="op">=&gt;</span> <span class="st">"Star_r"</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Speed"</span> <span class="op">=&gt;</span> <span class="st">"S20_r"</span>,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"PowerLOW"</span> <span class="op">=&gt;</span> <span class="st">"SLJ"</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"PowerUP"</span> <span class="op">=&gt;</span> <span class="st">"BMT"</span>,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>contrasts <span class="op">=</span> <span class="fu">merge</span>(</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Dict</span>(nm <span class="op">=&gt;</span> <span class="fu">SeqDiffCoding</span>() <span class="cf">for</span> nm <span class="kw">in</span> (<span class="op">:</span><span class="bu">Test</span>, <span class="op">:</span>Sex)),</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Dict</span>(nm <span class="op">=&gt;</span> <span class="fu">Grouping</span>() <span class="cf">for</span> nm <span class="kw">in</span> (<span class="op">:</span>Child, <span class="op">:</span>School, <span class="op">:</span>Cohort)),</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The statistical disadvantage of <em>SeqDiffCoding</em> is that the contrasts are not orthogonal, that is the contrasts are correlated. This is obvious from the fact that levels 2, 3, and 4 are all used in two contrasts. One consequence of this is that correlation parameters estimated between neighboring contrasts (e.g., 2-1 and 3-2) are difficult to interpret. Usually, they will be negative because assuming some practical limitations on the overall range (e.g., between levels 1 and 3), a small “2-1” effect “correlates” negatively with a larger “3-2” effect for mathematical reasons.</p>
<p>Obviously, the tradeoff between theoretical motivation and statistical purity is something that must be considered carefully when planning the analysis.</p>
<p>Various options for contrast coding are the topic of the <em>MixedModelsTutorial_contrasts_emotikon.jl</em> and <em>MixedModelsTutorial_contrasts_kwdyz.jl</em> notebooks.</p>
</section>
</section>
<section id="model-complexification" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Model complexification</h1>
<p>We fit and compare three LMMs with the same fixed-effect structure but increasing complexity of the random-effect structure for <code>School</code>. We ignore the other two random factors <code>Child</code> and <code>Cohort</code> to avoid undue delays when fitting the models.</p>
<ol type="1">
<li>LMM <code>m_ovi</code>: allowing only varying intercepts (“Grand Means”);</li>
<li>LMM <code>m_zcp</code>: adding variance components (VCs) for the four <code>Test</code> contrasts, <code>Sex</code>, and <code>age</code> to LMM <code>m_ovi</code>, yielding the zero-correlation parameters LMM;</li>
<li>LMM <code>m_cpx</code>: adding correlation parameters (CPs) to LMM <code>m_zcp</code>; yielding a complex LMM.</li>
</ol>
<p>In a final part illustrate how to check whether the complex model is supported by the data, rather than leading to a singular fit and, if supported by the data, whether there is an increase in goodness of fit associated with the model complexification.</p>
<section id="lmm-m_ovi" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="lmm-m_ovi"><span class="header-section-number">4.1</span> LMM <code>m_ovi</code></h2>
<p>In its random-effect structure (RES) we only vary intercepts (i.e., Grand Means) for <code>School</code> (LMM <code>m_ovi</code>), that is we allow that the schools differ in the average fitness of its children, average over the five tests.</p>
<p>It is well known that such a simple RES is likely to be anti-conservative with respect to fixed-effect test statistics.</p>
<div id="24" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>m_ovi <span class="op">=</span> <span class="kw">let</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  f <span class="op">=</span> <span class="pp">@formula</span> zScore <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="bu">Test</span> <span class="op">*</span> Sex <span class="op">*</span> a1 <span class="op">+</span> (<span class="fl">1</span> <span class="op">|</span> School)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(MixedModel, f, dat; contrasts)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td style="text-align: left;" data-quarto-table-cell-role="th"></td>
<td style="text-align: right;" data-quarto-table-cell-role="th">Est.</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">SE</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">z</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">p</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">σ_School</td>
</tr>
<tr class="even">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-0.0174</td>
<td style="text-align: right;">0.0198</td>
<td style="text-align: right;">-0.88</td>
<td style="text-align: right;">0.3787</td>
<td style="text-align: right;">0.3417</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: Star_r</td>
<td style="text-align: right;">-0.0026</td>
<td style="text-align: right;">0.0303</td>
<td style="text-align: right;">-0.09</td>
<td style="text-align: right;">0.9304</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: S20_r</td>
<td style="text-align: right;">0.0097</td>
<td style="text-align: right;">0.0302</td>
<td style="text-align: right;">0.32</td>
<td style="text-align: right;">0.7469</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: SLJ</td>
<td style="text-align: right;">0.0033</td>
<td style="text-align: right;">0.0300</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">0.9119</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: BMT</td>
<td style="text-align: right;">-0.0539</td>
<td style="text-align: right;">0.0299</td>
<td style="text-align: right;">-1.80</td>
<td style="text-align: right;">0.0711</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sex: Girls</td>
<td style="text-align: right;">-0.4372</td>
<td style="text-align: right;">0.0205</td>
<td style="text-align: right;">-21.35</td>
<td style="text-align: right;">&lt;1e-99</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">a1</td>
<td style="text-align: right;">0.1761</td>
<td style="text-align: right;">0.0354</td>
<td style="text-align: right;">4.97</td>
<td style="text-align: right;">&lt;1e-06</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: Star_r &amp; Sex: Girls</td>
<td style="text-align: right;">0.3802</td>
<td style="text-align: right;">0.0605</td>
<td style="text-align: right;">6.28</td>
<td style="text-align: right;">&lt;1e-09</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: S20_r &amp; Sex: Girls</td>
<td style="text-align: right;">-0.2038</td>
<td style="text-align: right;">0.0604</td>
<td style="text-align: right;">-3.38</td>
<td style="text-align: right;">0.0007</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: SLJ &amp; Sex: Girls</td>
<td style="text-align: right;">-0.0669</td>
<td style="text-align: right;">0.0600</td>
<td style="text-align: right;">-1.11</td>
<td style="text-align: right;">0.2651</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: BMT &amp; Sex: Girls</td>
<td style="text-align: right;">-0.2730</td>
<td style="text-align: right;">0.0598</td>
<td style="text-align: right;">-4.57</td>
<td style="text-align: right;">&lt;1e-05</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: Star_r &amp; a1</td>
<td style="text-align: right;">0.3146</td>
<td style="text-align: right;">0.1038</td>
<td style="text-align: right;">3.03</td>
<td style="text-align: right;">0.0024</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: S20_r &amp; a1</td>
<td style="text-align: right;">-0.0767</td>
<td style="text-align: right;">0.1034</td>
<td style="text-align: right;">-0.74</td>
<td style="text-align: right;">0.4584</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: SLJ &amp; a1</td>
<td style="text-align: right;">-0.0745</td>
<td style="text-align: right;">0.1027</td>
<td style="text-align: right;">-0.73</td>
<td style="text-align: right;">0.4683</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: BMT &amp; a1</td>
<td style="text-align: right;">0.4724</td>
<td style="text-align: right;">0.1025</td>
<td style="text-align: right;">4.61</td>
<td style="text-align: right;">&lt;1e-05</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sex: Girls &amp; a1</td>
<td style="text-align: right;">-0.1044</td>
<td style="text-align: right;">0.0709</td>
<td style="text-align: right;">-1.47</td>
<td style="text-align: right;">0.1405</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: Star_r &amp; Sex: Girls &amp; a1</td>
<td style="text-align: right;">-0.1912</td>
<td style="text-align: right;">0.2076</td>
<td style="text-align: right;">-0.92</td>
<td style="text-align: right;">0.3570</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: S20_r &amp; Sex: Girls &amp; a1</td>
<td style="text-align: right;">0.1742</td>
<td style="text-align: right;">0.2068</td>
<td style="text-align: right;">0.84</td>
<td style="text-align: right;">0.3997</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: SLJ &amp; Sex: Girls &amp; a1</td>
<td style="text-align: right;">0.0084</td>
<td style="text-align: right;">0.2054</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">0.9672</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: BMT &amp; Sex: Girls &amp; a1</td>
<td style="text-align: right;">0.1923</td>
<td style="text-align: right;">0.2050</td>
<td style="text-align: right;">0.94</td>
<td style="text-align: right;">0.3482</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Residual</td>
<td style="text-align: right;">0.9152</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Is the model singular (overparameterized, degenerate)? In other words: Is the model not supported by the data?</p>
<div id="26" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">issingular</span>(m_ovi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>false</code></pre>
</div>
</div>
<p>Models varying only in intercepts are almost always supported by the data.</p>
</section>
<section id="lmm-m_zcp" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="lmm-m_zcp"><span class="header-section-number">4.2</span> LMM <code>m_zcp</code></h2>
<p>In this LMM we allow that schools differ not only in <code>GM</code>, but also in the size of the four contrasts defined for <code>Test</code>, in the difference between boys and girls (<code>Sex</code>) and the developmental gain children achieve within the third grade (<code>age</code>).</p>
<p>We assume that there is covariance associated with these CPs beyond residual noise, that is we assume that there is no detectable evidence in the data that the CPs are different from zero.</p>
<div id="28" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>m_zcp <span class="op">=</span> <span class="kw">let</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  f <span class="op">=</span> <span class="pp">@formula</span>(</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    zScore <span class="op">~</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>      <span class="fl">1</span> <span class="op">+</span> <span class="bu">Test</span> <span class="op">*</span> Sex <span class="op">*</span> a1 <span class="op">+</span> <span class="fu">zerocorr</span>(<span class="fl">1</span> <span class="op">+</span> <span class="bu">Test</span> <span class="op">+</span> Sex <span class="op">+</span> a1 <span class="op">|</span> School)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(MixedModel, f, dat; contrasts)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Minimizing 92    Time: 0:00:00 ( 1.09 ms/it)
  objective:  25923.4801198341
Minimizing 151    Time: 0:00:00 ( 5.35 ms/it)

Minimizing 152    Time: 0:00:00 ( 5.43 ms/it)
  objective:  25923.46046970646</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="1">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td style="text-align: left;" data-quarto-table-cell-role="th"></td>
<td style="text-align: right;" data-quarto-table-cell-role="th">Est.</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">SE</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">z</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">p</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">σ_School</td>
</tr>
<tr class="even">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-0.0247</td>
<td style="text-align: right;">0.0198</td>
<td style="text-align: right;">-1.24</td>
<td style="text-align: right;">0.2136</td>
<td style="text-align: right;">0.3257</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: Star_r</td>
<td style="text-align: right;">0.0029</td>
<td style="text-align: right;">0.0311</td>
<td style="text-align: right;">0.09</td>
<td style="text-align: right;">0.9254</td>
<td style="text-align: right;">0.2208</td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: S20_r</td>
<td style="text-align: right;">0.0102</td>
<td style="text-align: right;">0.0286</td>
<td style="text-align: right;">0.36</td>
<td style="text-align: right;">0.7209</td>
<td style="text-align: right;">0.0503</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: SLJ</td>
<td style="text-align: right;">0.0049</td>
<td style="text-align: right;">0.0283</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">0.8634</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: BMT</td>
<td style="text-align: right;">-0.0460</td>
<td style="text-align: right;">0.0309</td>
<td style="text-align: right;">-1.49</td>
<td style="text-align: right;">0.1368</td>
<td style="text-align: right;">0.2286</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sex: Girls</td>
<td style="text-align: right;">-0.4399</td>
<td style="text-align: right;">0.0322</td>
<td style="text-align: right;">-13.64</td>
<td style="text-align: right;">&lt;1e-41</td>
<td style="text-align: right;">0.4503</td>
</tr>
<tr class="even">
<td style="text-align: left;">a1</td>
<td style="text-align: right;">0.1840</td>
<td style="text-align: right;">0.0573</td>
<td style="text-align: right;">3.21</td>
<td style="text-align: right;">0.0013</td>
<td style="text-align: right;">0.7780</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: Star_r &amp; Sex: Girls</td>
<td style="text-align: right;">0.3784</td>
<td style="text-align: right;">0.0577</td>
<td style="text-align: right;">6.55</td>
<td style="text-align: right;">&lt;1e-10</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: S20_r &amp; Sex: Girls</td>
<td style="text-align: right;">-0.2019</td>
<td style="text-align: right;">0.0570</td>
<td style="text-align: right;">-3.54</td>
<td style="text-align: right;">0.0004</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: SLJ &amp; Sex: Girls</td>
<td style="text-align: right;">-0.0666</td>
<td style="text-align: right;">0.0566</td>
<td style="text-align: right;">-1.18</td>
<td style="text-align: right;">0.2392</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: BMT &amp; Sex: Girls</td>
<td style="text-align: right;">-0.2780</td>
<td style="text-align: right;">0.0570</td>
<td style="text-align: right;">-4.87</td>
<td style="text-align: right;">&lt;1e-05</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: Star_r &amp; a1</td>
<td style="text-align: right;">0.3101</td>
<td style="text-align: right;">0.0992</td>
<td style="text-align: right;">3.13</td>
<td style="text-align: right;">0.0018</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: S20_r &amp; a1</td>
<td style="text-align: right;">-0.0728</td>
<td style="text-align: right;">0.0976</td>
<td style="text-align: right;">-0.75</td>
<td style="text-align: right;">0.4558</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: SLJ &amp; a1</td>
<td style="text-align: right;">-0.0784</td>
<td style="text-align: right;">0.0968</td>
<td style="text-align: right;">-0.81</td>
<td style="text-align: right;">0.4180</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: BMT &amp; a1</td>
<td style="text-align: right;">0.4741</td>
<td style="text-align: right;">0.0979</td>
<td style="text-align: right;">4.84</td>
<td style="text-align: right;">&lt;1e-05</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sex: Girls &amp; a1</td>
<td style="text-align: right;">-0.1453</td>
<td style="text-align: right;">0.0791</td>
<td style="text-align: right;">-1.84</td>
<td style="text-align: right;">0.0662</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: Star_r &amp; Sex: Girls &amp; a1</td>
<td style="text-align: right;">-0.1570</td>
<td style="text-align: right;">0.1982</td>
<td style="text-align: right;">-0.79</td>
<td style="text-align: right;">0.4284</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: S20_r &amp; Sex: Girls &amp; a1</td>
<td style="text-align: right;">0.1799</td>
<td style="text-align: right;">0.1952</td>
<td style="text-align: right;">0.92</td>
<td style="text-align: right;">0.3566</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: SLJ &amp; Sex: Girls &amp; a1</td>
<td style="text-align: right;">0.0061</td>
<td style="text-align: right;">0.1936</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.9749</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: BMT &amp; Sex: Girls &amp; a1</td>
<td style="text-align: right;">0.1657</td>
<td style="text-align: right;">0.1958</td>
<td style="text-align: right;">0.85</td>
<td style="text-align: right;">0.3974</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Residual</td>
<td style="text-align: right;">0.8623</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Depending on sampling, this model estimating variance components for <code>School</code> may or may not be supported by the data.</p>
<div id="30" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">issingular</span>(m_zcp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>true</code></pre>
</div>
</div>
</section>
<section id="lmm-m_cpx" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="lmm-m_cpx"><span class="header-section-number">4.3</span> LMM <code>m_cpx</code></h2>
<p>In the complex LMM investigated in this sequence we give up the assumption of zero-correlation between VCs.</p>
<div id="32" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>m_cpx <span class="op">=</span> <span class="kw">let</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  f <span class="op">=</span> <span class="pp">@formula</span>(</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    zScore <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="bu">Test</span> <span class="op">*</span> Sex <span class="op">*</span> a1 <span class="op">+</span> (<span class="fl">1</span> <span class="op">+</span> <span class="bu">Test</span> <span class="op">+</span> Sex <span class="op">+</span> a1 <span class="op">|</span> School)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(MixedModel, f, dat; contrasts)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Minimizing 120    Time: 0:00:00 ( 0.84 ms/it)
  objective:  25913.7359953439
Minimizing 239    Time: 0:00:00 ( 0.85 ms/it)
  objective:  25874.84433102616
Minimizing 356    Time: 0:00:00 ( 0.85 ms/it)
  objective:  25872.397822536375
Minimizing 474    Time: 0:00:00 ( 0.85 ms/it)
  objective:  25870.171971430293
Minimizing 626    Time: 0:00:00 ( 0.89 ms/it)
  objective:  25865.73386935914
Minimizing 769    Time: 0:00:00 ( 0.88 ms/it)
  objective:  25864.63197654432
Minimizing 887    Time: 0:00:00 ( 0.88 ms/it)
  objective:  25864.549175037082
Minimizing 1005    Time: 0:00:00 ( 0.88 ms/it)
  objective:  25864.512781331156
Minimizing 1124    Time: 0:00:00 ( 0.87 ms/it)
  objective:  25864.43678434264
Minimizing 1243    Time: 0:00:01 ( 0.87 ms/it)
  objective:  25864.406774217532
Minimizing 1362    Time: 0:00:01 ( 0.87 ms/it)
  objective:  25864.40183533508
Minimizing 1482    Time: 0:00:01 ( 0.87 ms/it)
  objective:  25864.394286069102
Minimizing 1600    Time: 0:00:01 ( 0.87 ms/it)
  objective:  25864.390976008268
Minimizing 1718    Time: 0:00:01 ( 0.86 ms/it)
  objective:  25864.3897916446
Minimizing 1830    Time: 0:00:01 ( 0.86 ms/it)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="1">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td style="text-align: left;" data-quarto-table-cell-role="th"></td>
<td style="text-align: right;" data-quarto-table-cell-role="th">Est.</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">SE</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">z</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">p</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">σ_School</td>
</tr>
<tr class="even">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-0.0268</td>
<td style="text-align: right;">0.0198</td>
<td style="text-align: right;">-1.35</td>
<td style="text-align: right;">0.1757</td>
<td style="text-align: right;">0.3264</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: Star_r</td>
<td style="text-align: right;">0.0055</td>
<td style="text-align: right;">0.0310</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">0.8578</td>
<td style="text-align: right;">0.2203</td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: S20_r</td>
<td style="text-align: right;">0.0104</td>
<td style="text-align: right;">0.0301</td>
<td style="text-align: right;">0.35</td>
<td style="text-align: right;">0.7291</td>
<td style="text-align: right;">0.1757</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: SLJ</td>
<td style="text-align: right;">0.0024</td>
<td style="text-align: right;">0.0294</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">0.9357</td>
<td style="text-align: right;">0.1478</td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: BMT</td>
<td style="text-align: right;">-0.0401</td>
<td style="text-align: right;">0.0305</td>
<td style="text-align: right;">-1.32</td>
<td style="text-align: right;">0.1882</td>
<td style="text-align: right;">0.2245</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sex: Girls</td>
<td style="text-align: right;">-0.4356</td>
<td style="text-align: right;">0.0320</td>
<td style="text-align: right;">-13.61</td>
<td style="text-align: right;">&lt;1e-41</td>
<td style="text-align: right;">0.4483</td>
</tr>
<tr class="even">
<td style="text-align: left;">a1</td>
<td style="text-align: right;">0.1877</td>
<td style="text-align: right;">0.0566</td>
<td style="text-align: right;">3.31</td>
<td style="text-align: right;">0.0009</td>
<td style="text-align: right;">0.7688</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: Star_r &amp; Sex: Girls</td>
<td style="text-align: right;">0.3759</td>
<td style="text-align: right;">0.0575</td>
<td style="text-align: right;">6.53</td>
<td style="text-align: right;">&lt;1e-10</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: S20_r &amp; Sex: Girls</td>
<td style="text-align: right;">-0.1969</td>
<td style="text-align: right;">0.0572</td>
<td style="text-align: right;">-3.44</td>
<td style="text-align: right;">0.0006</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: SLJ &amp; Sex: Girls</td>
<td style="text-align: right;">-0.0673</td>
<td style="text-align: right;">0.0567</td>
<td style="text-align: right;">-1.19</td>
<td style="text-align: right;">0.2349</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: BMT &amp; Sex: Girls</td>
<td style="text-align: right;">-0.2717</td>
<td style="text-align: right;">0.0566</td>
<td style="text-align: right;">-4.80</td>
<td style="text-align: right;">&lt;1e-05</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: Star_r &amp; a1</td>
<td style="text-align: right;">0.3112</td>
<td style="text-align: right;">0.0988</td>
<td style="text-align: right;">3.15</td>
<td style="text-align: right;">0.0016</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: S20_r &amp; a1</td>
<td style="text-align: right;">-0.0707</td>
<td style="text-align: right;">0.0981</td>
<td style="text-align: right;">-0.72</td>
<td style="text-align: right;">0.4709</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: SLJ &amp; a1</td>
<td style="text-align: right;">-0.0642</td>
<td style="text-align: right;">0.0971</td>
<td style="text-align: right;">-0.66</td>
<td style="text-align: right;">0.5086</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: BMT &amp; a1</td>
<td style="text-align: right;">0.4678</td>
<td style="text-align: right;">0.0971</td>
<td style="text-align: right;">4.82</td>
<td style="text-align: right;">&lt;1e-05</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sex: Girls &amp; a1</td>
<td style="text-align: right;">-0.1404</td>
<td style="text-align: right;">0.0783</td>
<td style="text-align: right;">-1.79</td>
<td style="text-align: right;">0.0728</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: Star_r &amp; Sex: Girls &amp; a1</td>
<td style="text-align: right;">-0.1632</td>
<td style="text-align: right;">0.1974</td>
<td style="text-align: right;">-0.83</td>
<td style="text-align: right;">0.4086</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: S20_r &amp; Sex: Girls &amp; a1</td>
<td style="text-align: right;">0.1862</td>
<td style="text-align: right;">0.1961</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.3424</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: SLJ &amp; Sex: Girls &amp; a1</td>
<td style="text-align: right;">0.0011</td>
<td style="text-align: right;">0.1941</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">0.9954</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: BMT &amp; Sex: Girls &amp; a1</td>
<td style="text-align: right;">0.1638</td>
<td style="text-align: right;">0.1942</td>
<td style="text-align: right;">0.84</td>
<td style="text-align: right;">0.3990</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Residual</td>
<td style="text-align: right;">0.8598</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>We also need to see the VCs and CPs of the random-effect structure (RES).</p>
<div id="34" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VarCorr</span>(m_cpx)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td style="text-align: left;" data-quarto-table-cell-role="th"></td>
<td style="text-align: left;" data-quarto-table-cell-role="th">Column</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">Variance</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">Std.Dev</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">Corr.</td>
<td style="text-align: right;" data-quarto-table-cell-role="th"></td>
<td style="text-align: right;" data-quarto-table-cell-role="th"></td>
<td style="text-align: right;" data-quarto-table-cell-role="th"></td>
<td style="text-align: right;" data-quarto-table-cell-role="th"></td>
<td style="text-align: right;" data-quarto-table-cell-role="th"></td>
</tr>
<tr class="even">
<td style="text-align: left;">School</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.106541</td>
<td style="text-align: right;">0.326406</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: Star_r</td>
<td style="text-align: right;">0.048537</td>
<td style="text-align: right;">0.220312</td>
<td style="text-align: right;">+0.10</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: S20_r</td>
<td style="text-align: right;">0.030880</td>
<td style="text-align: right;">0.175726</td>
<td style="text-align: right;">-0.19</td>
<td style="text-align: right;">-0.22</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: SLJ</td>
<td style="text-align: right;">0.021853</td>
<td style="text-align: right;">0.147828</td>
<td style="text-align: right;">-0.10</td>
<td style="text-align: right;">+0.07</td>
<td style="text-align: right;">-0.83</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: BMT</td>
<td style="text-align: right;">0.050389</td>
<td style="text-align: right;">0.224474</td>
<td style="text-align: right;">-0.75</td>
<td style="text-align: right;">+0.43</td>
<td style="text-align: right;">-0.13</td>
<td style="text-align: right;">+0.16</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Sex: Girls</td>
<td style="text-align: right;">0.200960</td>
<td style="text-align: right;">0.448286</td>
<td style="text-align: right;">-0.04</td>
<td style="text-align: right;">+0.25</td>
<td style="text-align: right;">+0.20</td>
<td style="text-align: right;">-0.27</td>
<td style="text-align: right;">-0.10</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">a1</td>
<td style="text-align: right;">0.591058</td>
<td style="text-align: right;">0.768803</td>
<td style="text-align: right;">+0.02</td>
<td style="text-align: right;">-0.13</td>
<td style="text-align: right;">+0.03</td>
<td style="text-align: right;">-0.49</td>
<td style="text-align: right;">+0.17</td>
<td style="text-align: right;">-0.06</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Residual</td>
<td style="text-align: left;"></td>
<td style="text-align: right;">0.739252</td>
<td style="text-align: right;">0.859798</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="36" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">issingular</span>(m_cpx)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>false</code></pre>
</div>
</div>
<p>The complex model may or may not be supported by the data.</p>
</section>
<section id="model-comparisons" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="model-comparisons"><span class="header-section-number">4.4</span> Model comparisons</h2>
<p>The checks of model singularity indicate that the three models are supported by the data. Does model complexification also increase the goodness of fit or are we only fitting noise?</p>
<section id="lrt-and-goodness-of-fit-statistics" class="level3" data-number="4.4.1">
<h3 data-number="4.4.1" class="anchored" data-anchor-id="lrt-and-goodness-of-fit-statistics"><span class="header-section-number">4.4.1</span> LRT and goodness-of-fit statistics</h3>
<p>As the thee models are strictly hierarchically nested, we compare them with a likelihood-ratio tests (LRT) and AIC and BIC goodness-of-fit statistics derived from them.</p>
<div id="38" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>MixedModels.<span class="fu">likelihoodratiotest</span>(m_ovi, m_zcp, m_cpx)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td style="text-align: left;" data-quarto-table-cell-role="th"></td>
<td style="text-align: right;" data-quarto-table-cell-role="th">model-dof</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">deviance</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">χ²</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">χ²-dof</td>
<td style="text-align: left;" data-quarto-table-cell-role="th">P(&gt;χ²)</td>
</tr>
<tr class="even">
<td style="text-align: left;">zScore ~ 1 + Test + Sex + a1 + Test &amp; Sex + Test &amp; a1 + Sex &amp; a1 + Test &amp; Sex &amp; a1 + (1 | School)</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">26273</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">zScore ~ 1 + Test + Sex + a1 + Test &amp; Sex + Test &amp; a1 + Sex &amp; a1 + Test &amp; Sex &amp; a1 + zerocorr(1 + Test + Sex + a1 | School)</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">25923</td>
<td style="text-align: right;">349</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">&lt;1e-71</td>
</tr>
<tr class="even">
<td style="text-align: left;">zScore ~ 1 + Test + Sex + a1 + Test &amp; Sex + Test &amp; a1 + Sex &amp; a1 + Test &amp; Sex &amp; a1 + (1 + Test + Sex + a1 | School)</td>
<td style="text-align: right;">49</td>
<td style="text-align: right;">25864</td>
<td style="text-align: right;">59</td>
<td style="text-align: right;">21</td>
<td style="text-align: left;">&lt;1e-04</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="40" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>gof_summary <span class="op">=</span> <span class="kw">let</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  nms <span class="op">=</span> [<span class="op">:</span>m_ovi, <span class="op">:</span>m_zcp, <span class="op">:</span>m_cpx]</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  mods <span class="op">=</span> <span class="fu">eval</span>.(nms)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">DataFrame</span>(;</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    name<span class="op">=</span>nms,</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    dof<span class="op">=</span><span class="fu">dof</span>.(mods),</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    deviance<span class="op">=</span><span class="fu">deviance</span>.(mods),</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    AIC<span class="op">=</span><span class="fu">aic</span>.(mods),</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    AICc<span class="op">=</span><span class="fu">aicc</span>.(mods),</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    BIC<span class="op">=</span><span class="fu">bic</span>.(mods),</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>3×6 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">name</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">dof</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">deviance</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">AIC</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">AICc</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">BIC</th>
</tr>
<tr class="odd subheader headerLastRow">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Symbol">Symbol</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">m_ovi</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">26272.9</td>
<td style="text-align: right;">26316.9</td>
<td style="text-align: right;">26317.0</td>
<td style="text-align: right;">26474.8</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">m_zcp</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">25923.5</td>
<td style="text-align: right;">25979.5</td>
<td style="text-align: right;">25979.6</td>
<td style="text-align: right;">26180.4</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: left;">m_cpx</td>
<td style="text-align: right;">49</td>
<td style="text-align: right;">25864.4</td>
<td style="text-align: right;">25962.4</td>
<td style="text-align: right;">25962.9</td>
<td style="text-align: right;">26314.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>These statistics will depend on sampling. In general, smaller deviance, AIC, and BIC indicate an improvement in goodness of fit. Usually, χ² should be larger than the associated degrees of freedom; for AIC and BIC the decrease should amount to more than 5, according to some literature. Severity of meeting these criteria increases from deviance to AIC to BIC. Therefore, it is not always the case that the criteria are unanimous in their verdict. Basically, the more confirmatory the analysis, the more one may go with deviance and AIC; for exploratory analyses the BIC is probably a better guide. There are grey zones here.</p>
</section>
<section id="comparing-fixed-effects-of-m_ovi-m_zcp-and-m_cpx" class="level3" data-number="4.4.2">
<h3 data-number="4.4.2" class="anchored" data-anchor-id="comparing-fixed-effects-of-m_ovi-m_zcp-and-m_cpx"><span class="header-section-number">4.4.2</span> Comparing fixed effects of <code>m_ovi</code>, <code>m_zcp</code>, and <code>m_cpx</code></h3>
<p>We check whether enriching the RES changed the significance of fixed effects in the final model.</p>
<div id="42" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>m_ovi_fe <span class="op">=</span> <span class="fu">DataFrame</span>(<span class="fu">coeftable</span>(m_ovi));</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>m_zcp_fe <span class="op">=</span> <span class="fu">DataFrame</span>(<span class="fu">coeftable</span>(m_zcp));</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>m_cpx_fe <span class="op">=</span> <span class="fu">DataFrame</span>(<span class="fu">coeftable</span>(m_cpx));</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>m_all <span class="op">=</span> <span class="fu">hcat</span>(</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  m_ovi_fe[<span class="op">:</span>, [<span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span>]],</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">leftjoin</span>(</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    m_zcp_fe[<span class="op">:</span>, [<span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span>]],</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    m_cpx_fe[<span class="op">:</span>, [<span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span>]];</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>    on<span class="op">=:</span>Name,</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>    makeunique<span class="op">=</span><span class="cn">true</span>,</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>  makeunique<span class="op">=</span><span class="cn">true</span>,</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="fu">rename!</span>(</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>  m_all,</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Coef."</span> <span class="op">=&gt;</span> <span class="st">"b_ovi"</span>,</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Coef._2"</span> <span class="op">=&gt;</span> <span class="st">"b_zcp"</span>,</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Coef._1"</span> <span class="op">=&gt;</span> <span class="st">"b_cpx"</span>,</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>  <span class="st">"z"</span> <span class="op">=&gt;</span> <span class="st">"z_ovi"</span>,</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>  <span class="st">"z_2"</span> <span class="op">=&gt;</span> <span class="st">"z_zcp"</span>,</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>  <span class="st">"z_1"</span> <span class="op">=&gt;</span> <span class="st">"z_cpx"</span>,</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>m_all2 <span class="op">=</span></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>.(</span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>    m_all[<span class="op">:</span>, [<span class="op">:</span>b_ovi, <span class="op">:</span>b_zcp, <span class="op">:</span>b_cpx, <span class="op">:</span>z_ovi, <span class="op">:</span>z_zcp, <span class="op">:</span>z_cpx]],</span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>    digits<span class="op">=</span><span class="fl">2</span>,</span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>m_all3 <span class="op">=</span> <span class="fu">hcat</span>(m_all.Name, m_all2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>20×7 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">x1</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">b_ovi</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">b_zcp</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">b_cpx</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">z_ovi</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">z_zcp</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">z_cpx</th>
</tr>
<tr class="odd subheader headerLastRow">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-0.02</td>
<td style="text-align: right;">-0.02</td>
<td style="text-align: right;">-0.03</td>
<td style="text-align: right;">-0.88</td>
<td style="text-align: right;">-1.24</td>
<td style="text-align: right;">-1.35</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">Test: Star_r</td>
<td style="text-align: right;">-0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">-0.09</td>
<td style="text-align: right;">0.09</td>
<td style="text-align: right;">0.18</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: left;">Test: S20_r</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">0.32</td>
<td style="text-align: right;">0.36</td>
<td style="text-align: right;">0.35</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">4</td>
<td style="text-align: left;">Test: SLJ</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">0.08</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">5</td>
<td style="text-align: left;">Test: BMT</td>
<td style="text-align: right;">-0.05</td>
<td style="text-align: right;">-0.05</td>
<td style="text-align: right;">-0.04</td>
<td style="text-align: right;">-1.8</td>
<td style="text-align: right;">-1.49</td>
<td style="text-align: right;">-1.32</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">6</td>
<td style="text-align: left;">Sex: Girls</td>
<td style="text-align: right;">-0.44</td>
<td style="text-align: right;">-0.44</td>
<td style="text-align: right;">-0.44</td>
<td style="text-align: right;">-21.35</td>
<td style="text-align: right;">-13.64</td>
<td style="text-align: right;">-13.61</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">7</td>
<td style="text-align: left;">a1</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">0.19</td>
<td style="text-align: right;">4.97</td>
<td style="text-align: right;">3.21</td>
<td style="text-align: right;">3.31</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">8</td>
<td style="text-align: left;">Test: Star_r &amp; Sex: Girls</td>
<td style="text-align: right;">0.38</td>
<td style="text-align: right;">0.38</td>
<td style="text-align: right;">0.38</td>
<td style="text-align: right;">6.28</td>
<td style="text-align: right;">6.55</td>
<td style="text-align: right;">6.53</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">9</td>
<td style="text-align: left;">Test: S20_r &amp; Sex: Girls</td>
<td style="text-align: right;">-0.2</td>
<td style="text-align: right;">-0.2</td>
<td style="text-align: right;">-0.2</td>
<td style="text-align: right;">-3.38</td>
<td style="text-align: right;">-3.54</td>
<td style="text-align: right;">-3.44</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">10</td>
<td style="text-align: left;">Test: SLJ &amp; Sex: Girls</td>
<td style="text-align: right;">-0.07</td>
<td style="text-align: right;">-0.07</td>
<td style="text-align: right;">-0.07</td>
<td style="text-align: right;">-1.11</td>
<td style="text-align: right;">-1.18</td>
<td style="text-align: right;">-1.19</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">11</td>
<td style="text-align: left;">Test: BMT &amp; Sex: Girls</td>
<td style="text-align: right;">-0.27</td>
<td style="text-align: right;">-0.28</td>
<td style="text-align: right;">-0.27</td>
<td style="text-align: right;">-4.57</td>
<td style="text-align: right;">-4.87</td>
<td style="text-align: right;">-4.8</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">12</td>
<td style="text-align: left;">Test: Star_r &amp; a1</td>
<td style="text-align: right;">0.31</td>
<td style="text-align: right;">0.31</td>
<td style="text-align: right;">0.31</td>
<td style="text-align: right;">3.03</td>
<td style="text-align: right;">3.13</td>
<td style="text-align: right;">3.15</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">13</td>
<td style="text-align: left;">Test: S20_r &amp; a1</td>
<td style="text-align: right;">-0.08</td>
<td style="text-align: right;">-0.07</td>
<td style="text-align: right;">-0.07</td>
<td style="text-align: right;">-0.74</td>
<td style="text-align: right;">-0.75</td>
<td style="text-align: right;">-0.72</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">14</td>
<td style="text-align: left;">Test: SLJ &amp; a1</td>
<td style="text-align: right;">-0.07</td>
<td style="text-align: right;">-0.08</td>
<td style="text-align: right;">-0.06</td>
<td style="text-align: right;">-0.73</td>
<td style="text-align: right;">-0.81</td>
<td style="text-align: right;">-0.66</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">15</td>
<td style="text-align: left;">Test: BMT &amp; a1</td>
<td style="text-align: right;">0.47</td>
<td style="text-align: right;">0.47</td>
<td style="text-align: right;">0.47</td>
<td style="text-align: right;">4.61</td>
<td style="text-align: right;">4.84</td>
<td style="text-align: right;">4.82</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">16</td>
<td style="text-align: left;">Sex: Girls &amp; a1</td>
<td style="text-align: right;">-0.1</td>
<td style="text-align: right;">-0.15</td>
<td style="text-align: right;">-0.14</td>
<td style="text-align: right;">-1.47</td>
<td style="text-align: right;">-1.84</td>
<td style="text-align: right;">-1.79</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">17</td>
<td style="text-align: left;">Test: Star_r &amp; Sex: Girls &amp; a1</td>
<td style="text-align: right;">-0.19</td>
<td style="text-align: right;">-0.16</td>
<td style="text-align: right;">-0.16</td>
<td style="text-align: right;">-0.92</td>
<td style="text-align: right;">-0.79</td>
<td style="text-align: right;">-0.83</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">18</td>
<td style="text-align: left;">Test: S20_r &amp; Sex: Girls &amp; a1</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">0.19</td>
<td style="text-align: right;">0.84</td>
<td style="text-align: right;">0.92</td>
<td style="text-align: right;">0.95</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">19</td>
<td style="text-align: left;">Test: SLJ &amp; Sex: Girls &amp; a1</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">20</td>
<td style="text-align: left;">Test: BMT &amp; Sex: Girls &amp; a1</td>
<td style="text-align: right;">0.19</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">0.94</td>
<td style="text-align: right;">0.85</td>
<td style="text-align: right;">0.84</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>The three models usually do <strong>not</strong> differ in fixed-effect estimates. For main effects of <code>age</code> and <code>Sex</code>, z-values decrease strongly with the complexity of the model (i.e., standard errors are larger). For other coefficients, the changes are not very large and not consistent.</p>
<p>In general, dropping significant variance components and/or correlation parameters may lead to anti-conservative estimates of fixed effects <span class="citation" data-cites="Schielzeth2008">(e.g., <a href="#ref-Schielzeth2008" role="doc-biblioref">Schielzeth &amp; Forstmeier, 2008</a>)</span>. Basically, some of the variance allocated to <code>age</code> and <code>Sex</code> in LMM <code>m_ovi</code> could also be due to differences between schools. This ambiguity increased the uncertainty of the respective fixed effects in the other two LMMs.</p>
</section>
</section>
<section id="fitting-an-overparameterized-lmm" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="fitting-an-overparameterized-lmm"><span class="header-section-number">4.5</span> Fitting an overparameterized LMM</h2>
<p>The complex LMM was not overparameterized with respect to <code>School</code>, because there are over 400 schools in the data. When the number of units (levels) of a grouping factor is small relative to the number of parameters we are trying to estimate, we often end up with an overparameterized / degenerate random-effect structure.</p>
<p>As an illustration, we fit a full CP matrix for the <code>Cohort</code>. As there are only nine cohorts in the data, we may be asking too much to estimate 5*6/2 = 15 VC/CP parameters.</p>
<div id="44" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>m_cpxCohort <span class="op">=</span> <span class="kw">let</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  f <span class="op">=</span> <span class="pp">@formula</span> zScore <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="bu">Test</span> <span class="op">*</span> a1 <span class="op">*</span> Sex <span class="op">+</span> (<span class="fl">1</span> <span class="op">+</span> <span class="bu">Test</span> <span class="op">|</span> Cohort)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(MixedModel, f, dat; contrasts)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td style="text-align: left;" data-quarto-table-cell-role="th"></td>
<td style="text-align: right;" data-quarto-table-cell-role="th">Est.</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">SE</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">z</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">p</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">σ_Cohort</td>
</tr>
<tr class="even">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-0.0009</td>
<td style="text-align: right;">0.0161</td>
<td style="text-align: right;">-0.06</td>
<td style="text-align: right;">0.9548</td>
<td style="text-align: right;">0.0378</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: Star_r</td>
<td style="text-align: right;">-0.0073</td>
<td style="text-align: right;">0.0380</td>
<td style="text-align: right;">-0.19</td>
<td style="text-align: right;">0.8482</td>
<td style="text-align: right;">0.0614</td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: S20_r</td>
<td style="text-align: right;">0.0056</td>
<td style="text-align: right;">0.0383</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">0.8845</td>
<td style="text-align: right;">0.0636</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: SLJ</td>
<td style="text-align: right;">0.0101</td>
<td style="text-align: right;">0.0451</td>
<td style="text-align: right;">0.22</td>
<td style="text-align: right;">0.8226</td>
<td style="text-align: right;">0.0959</td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: BMT</td>
<td style="text-align: right;">-0.0556</td>
<td style="text-align: right;">0.0335</td>
<td style="text-align: right;">-1.66</td>
<td style="text-align: right;">0.0968</td>
<td style="text-align: right;">0.0330</td>
</tr>
<tr class="odd">
<td style="text-align: left;">a1</td>
<td style="text-align: right;">0.2055</td>
<td style="text-align: right;">0.0349</td>
<td style="text-align: right;">5.90</td>
<td style="text-align: right;">&lt;1e-08</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Sex: Girls</td>
<td style="text-align: right;">-0.4238</td>
<td style="text-align: right;">0.0201</td>
<td style="text-align: right;">-21.07</td>
<td style="text-align: right;">&lt;1e-97</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: Star_r &amp; a1</td>
<td style="text-align: right;">0.2849</td>
<td style="text-align: right;">0.1101</td>
<td style="text-align: right;">2.59</td>
<td style="text-align: right;">0.0097</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: S20_r &amp; a1</td>
<td style="text-align: right;">-0.1172</td>
<td style="text-align: right;">0.1096</td>
<td style="text-align: right;">-1.07</td>
<td style="text-align: right;">0.2851</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: SLJ &amp; a1</td>
<td style="text-align: right;">-0.0270</td>
<td style="text-align: right;">0.1094</td>
<td style="text-align: right;">-0.25</td>
<td style="text-align: right;">0.8049</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: BMT &amp; a1</td>
<td style="text-align: right;">0.4555</td>
<td style="text-align: right;">0.1084</td>
<td style="text-align: right;">4.20</td>
<td style="text-align: right;">&lt;1e-04</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: Star_r &amp; Sex: Girls</td>
<td style="text-align: right;">0.3700</td>
<td style="text-align: right;">0.0640</td>
<td style="text-align: right;">5.78</td>
<td style="text-align: right;">&lt;1e-08</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: S20_r &amp; Sex: Girls</td>
<td style="text-align: right;">-0.2116</td>
<td style="text-align: right;">0.0638</td>
<td style="text-align: right;">-3.32</td>
<td style="text-align: right;">0.0009</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: SLJ &amp; Sex: Girls</td>
<td style="text-align: right;">-0.0552</td>
<td style="text-align: right;">0.0634</td>
<td style="text-align: right;">-0.87</td>
<td style="text-align: right;">0.3844</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: BMT &amp; Sex: Girls</td>
<td style="text-align: right;">-0.2718</td>
<td style="text-align: right;">0.0632</td>
<td style="text-align: right;">-4.30</td>
<td style="text-align: right;">&lt;1e-04</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">a1 &amp; Sex: Girls</td>
<td style="text-align: right;">-0.1368</td>
<td style="text-align: right;">0.0690</td>
<td style="text-align: right;">-1.98</td>
<td style="text-align: right;">0.0473</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: Star_r &amp; a1 &amp; Sex: Girls</td>
<td style="text-align: right;">-0.2099</td>
<td style="text-align: right;">0.2194</td>
<td style="text-align: right;">-0.96</td>
<td style="text-align: right;">0.3387</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: S20_r &amp; a1 &amp; Sex: Girls</td>
<td style="text-align: right;">0.1609</td>
<td style="text-align: right;">0.2186</td>
<td style="text-align: right;">0.74</td>
<td style="text-align: right;">0.4616</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: SLJ &amp; a1 &amp; Sex: Girls</td>
<td style="text-align: right;">0.0225</td>
<td style="text-align: right;">0.2172</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">0.9174</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: BMT &amp; a1 &amp; Sex: Girls</td>
<td style="text-align: right;">0.1901</td>
<td style="text-align: right;">0.2166</td>
<td style="text-align: right;">0.88</td>
<td style="text-align: right;">0.3801</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Residual</td>
<td style="text-align: right;">0.9671</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="46" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VarCorr</span>(m_cpxCohort)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td style="text-align: left;" data-quarto-table-cell-role="th"></td>
<td style="text-align: left;" data-quarto-table-cell-role="th">Column</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">Variance</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">Std.Dev</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">Corr.</td>
<td style="text-align: right;" data-quarto-table-cell-role="th"></td>
<td style="text-align: right;" data-quarto-table-cell-role="th"></td>
<td style="text-align: right;" data-quarto-table-cell-role="th"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Cohort</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.0014274</td>
<td style="text-align: right;">0.0377808</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: Star_r</td>
<td style="text-align: right;">0.0037663</td>
<td style="text-align: right;">0.0613705</td>
<td style="text-align: right;">-0.90</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: S20_r</td>
<td style="text-align: right;">0.0040438</td>
<td style="text-align: right;">0.0635905</td>
<td style="text-align: right;">-1.00</td>
<td style="text-align: right;">+0.87</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: SLJ</td>
<td style="text-align: right;">0.0091897</td>
<td style="text-align: right;">0.0958627</td>
<td style="text-align: right;">+0.98</td>
<td style="text-align: right;">-0.97</td>
<td style="text-align: right;">-0.97</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: BMT</td>
<td style="text-align: right;">0.0010888</td>
<td style="text-align: right;">0.0329966</td>
<td style="text-align: right;">-1.00</td>
<td style="text-align: right;">+0.91</td>
<td style="text-align: right;">+0.99</td>
<td style="text-align: right;">-0.99</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Residual</td>
<td style="text-align: left;"></td>
<td style="text-align: right;">0.9353139</td>
<td style="text-align: right;">0.9671163</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="48" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">issingular</span>(m_cpxCohort)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>true</code></pre>
</div>
</div>
<p>The model is overparameterized with several CPs estimated between |.98| and |1.00|. How about the <strong>zero-correlation parameter</strong> (zcp) version of this LMM?</p>
<div id="50" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>m_zcpCohort <span class="op">=</span> <span class="kw">let</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  f <span class="op">=</span> <span class="pp">@formula</span>(</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    zScore <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="bu">Test</span> <span class="op">*</span> a1 <span class="op">*</span> Sex <span class="op">+</span> <span class="fu">zerocorr</span>(<span class="fl">1</span> <span class="op">+</span> <span class="bu">Test</span> <span class="op">|</span> Cohort)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(MixedModel, f, dat; contrasts)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td style="text-align: left;" data-quarto-table-cell-role="th"></td>
<td style="text-align: right;" data-quarto-table-cell-role="th">Est.</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">SE</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">z</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">p</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">σ_Cohort</td>
</tr>
<tr class="even">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-0.0022</td>
<td style="text-align: right;">0.0152</td>
<td style="text-align: right;">-0.15</td>
<td style="text-align: right;">0.8837</td>
<td style="text-align: right;">0.0341</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: Star_r</td>
<td style="text-align: right;">-0.0042</td>
<td style="text-align: right;">0.0339</td>
<td style="text-align: right;">-0.12</td>
<td style="text-align: right;">0.9023</td>
<td style="text-align: right;">0.0331</td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: S20_r</td>
<td style="text-align: right;">0.0088</td>
<td style="text-align: right;">0.0319</td>
<td style="text-align: right;">0.27</td>
<td style="text-align: right;">0.7837</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: SLJ</td>
<td style="text-align: right;">0.0045</td>
<td style="text-align: right;">0.0317</td>
<td style="text-align: right;">0.14</td>
<td style="text-align: right;">0.8876</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: BMT</td>
<td style="text-align: right;">-0.0536</td>
<td style="text-align: right;">0.0316</td>
<td style="text-align: right;">-1.69</td>
<td style="text-align: right;">0.0903</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">a1</td>
<td style="text-align: right;">0.1999</td>
<td style="text-align: right;">0.0351</td>
<td style="text-align: right;">5.70</td>
<td style="text-align: right;">&lt;1e-07</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Sex: Girls</td>
<td style="text-align: right;">-0.4245</td>
<td style="text-align: right;">0.0201</td>
<td style="text-align: right;">-21.08</td>
<td style="text-align: right;">&lt;1e-97</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: Star_r &amp; a1</td>
<td style="text-align: right;">0.3078</td>
<td style="text-align: right;">0.1101</td>
<td style="text-align: right;">2.80</td>
<td style="text-align: right;">0.0052</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: S20_r &amp; a1</td>
<td style="text-align: right;">-0.0849</td>
<td style="text-align: right;">0.1093</td>
<td style="text-align: right;">-0.78</td>
<td style="text-align: right;">0.4377</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: SLJ &amp; a1</td>
<td style="text-align: right;">-0.0748</td>
<td style="text-align: right;">0.1086</td>
<td style="text-align: right;">-0.69</td>
<td style="text-align: right;">0.4911</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: BMT &amp; a1</td>
<td style="text-align: right;">0.4717</td>
<td style="text-align: right;">0.1084</td>
<td style="text-align: right;">4.35</td>
<td style="text-align: right;">&lt;1e-04</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: Star_r &amp; Sex: Girls</td>
<td style="text-align: right;">0.3729</td>
<td style="text-align: right;">0.0640</td>
<td style="text-align: right;">5.82</td>
<td style="text-align: right;">&lt;1e-08</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: S20_r &amp; Sex: Girls</td>
<td style="text-align: right;">-0.2079</td>
<td style="text-align: right;">0.0638</td>
<td style="text-align: right;">-3.26</td>
<td style="text-align: right;">0.0011</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: SLJ &amp; Sex: Girls</td>
<td style="text-align: right;">-0.0611</td>
<td style="text-align: right;">0.0634</td>
<td style="text-align: right;">-0.96</td>
<td style="text-align: right;">0.3354</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: BMT &amp; Sex: Girls</td>
<td style="text-align: right;">-0.2697</td>
<td style="text-align: right;">0.0632</td>
<td style="text-align: right;">-4.27</td>
<td style="text-align: right;">&lt;1e-04</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">a1 &amp; Sex: Girls</td>
<td style="text-align: right;">-0.1372</td>
<td style="text-align: right;">0.0691</td>
<td style="text-align: right;">-1.99</td>
<td style="text-align: right;">0.0470</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: Star_r &amp; a1 &amp; Sex: Girls</td>
<td style="text-align: right;">-0.2041</td>
<td style="text-align: right;">0.2195</td>
<td style="text-align: right;">-0.93</td>
<td style="text-align: right;">0.3525</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: S20_r &amp; a1 &amp; Sex: Girls</td>
<td style="text-align: right;">0.1733</td>
<td style="text-align: right;">0.2187</td>
<td style="text-align: right;">0.79</td>
<td style="text-align: right;">0.4280</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: SLJ &amp; a1 &amp; Sex: Girls</td>
<td style="text-align: right;">0.0051</td>
<td style="text-align: right;">0.2172</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.9811</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: BMT &amp; a1 &amp; Sex: Girls</td>
<td style="text-align: right;">0.1962</td>
<td style="text-align: right;">0.2168</td>
<td style="text-align: right;">0.90</td>
<td style="text-align: right;">0.3655</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Residual</td>
<td style="text-align: right;">0.9680</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="52" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">issingular</span>(m_zcpCohort)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>true</code></pre>
</div>
</div>
<p>This <code>zcpLMM</code> is also singular. Three of the five VCs are estimated as zero. This raises the possibility that LMM <code>m_oviCohort</code> might fit as well as LMM <code>m_zcpCohort</code>.</p>
<div id="54" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>m_oviCohort <span class="op">=</span> <span class="kw">let</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  f <span class="op">=</span> <span class="pp">@formula</span> zScore <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="bu">Test</span> <span class="op">*</span> a1 <span class="op">*</span> Sex <span class="op">+</span> (<span class="fl">1</span> <span class="op">|</span> Cohort)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(MixedModel, f, dat; contrasts)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td style="text-align: left;" data-quarto-table-cell-role="th"></td>
<td style="text-align: right;" data-quarto-table-cell-role="th">Est.</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">SE</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">z</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">p</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">σ_Cohort</td>
</tr>
<tr class="even">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-0.0022</td>
<td style="text-align: right;">0.0152</td>
<td style="text-align: right;">-0.15</td>
<td style="text-align: right;">0.8835</td>
<td style="text-align: right;">0.0340</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: Star_r</td>
<td style="text-align: right;">-0.0032</td>
<td style="text-align: right;">0.0320</td>
<td style="text-align: right;">-0.10</td>
<td style="text-align: right;">0.9196</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: S20_r</td>
<td style="text-align: right;">0.0087</td>
<td style="text-align: right;">0.0319</td>
<td style="text-align: right;">0.27</td>
<td style="text-align: right;">0.7847</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: SLJ</td>
<td style="text-align: right;">0.0045</td>
<td style="text-align: right;">0.0317</td>
<td style="text-align: right;">0.14</td>
<td style="text-align: right;">0.8869</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: BMT</td>
<td style="text-align: right;">-0.0536</td>
<td style="text-align: right;">0.0316</td>
<td style="text-align: right;">-1.69</td>
<td style="text-align: right;">0.0903</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">a1</td>
<td style="text-align: right;">0.1999</td>
<td style="text-align: right;">0.0351</td>
<td style="text-align: right;">5.69</td>
<td style="text-align: right;">&lt;1e-07</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Sex: Girls</td>
<td style="text-align: right;">-0.4245</td>
<td style="text-align: right;">0.0201</td>
<td style="text-align: right;">-21.08</td>
<td style="text-align: right;">&lt;1e-97</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: Star_r &amp; a1</td>
<td style="text-align: right;">0.3135</td>
<td style="text-align: right;">0.1097</td>
<td style="text-align: right;">2.86</td>
<td style="text-align: right;">0.0043</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: S20_r &amp; a1</td>
<td style="text-align: right;">-0.0848</td>
<td style="text-align: right;">0.1093</td>
<td style="text-align: right;">-0.78</td>
<td style="text-align: right;">0.4378</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: SLJ &amp; a1</td>
<td style="text-align: right;">-0.0748</td>
<td style="text-align: right;">0.1086</td>
<td style="text-align: right;">-0.69</td>
<td style="text-align: right;">0.4910</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: BMT &amp; a1</td>
<td style="text-align: right;">0.4718</td>
<td style="text-align: right;">0.1084</td>
<td style="text-align: right;">4.35</td>
<td style="text-align: right;">&lt;1e-04</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: Star_r &amp; Sex: Girls</td>
<td style="text-align: right;">0.3736</td>
<td style="text-align: right;">0.0640</td>
<td style="text-align: right;">5.84</td>
<td style="text-align: right;">&lt;1e-08</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: S20_r &amp; Sex: Girls</td>
<td style="text-align: right;">-0.2079</td>
<td style="text-align: right;">0.0638</td>
<td style="text-align: right;">-3.26</td>
<td style="text-align: right;">0.0011</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: SLJ &amp; Sex: Girls</td>
<td style="text-align: right;">-0.0611</td>
<td style="text-align: right;">0.0634</td>
<td style="text-align: right;">-0.96</td>
<td style="text-align: right;">0.3356</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: BMT &amp; Sex: Girls</td>
<td style="text-align: right;">-0.2697</td>
<td style="text-align: right;">0.0632</td>
<td style="text-align: right;">-4.27</td>
<td style="text-align: right;">&lt;1e-04</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">a1 &amp; Sex: Girls</td>
<td style="text-align: right;">-0.1371</td>
<td style="text-align: right;">0.0691</td>
<td style="text-align: right;">-1.99</td>
<td style="text-align: right;">0.0471</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: Star_r &amp; a1 &amp; Sex: Girls</td>
<td style="text-align: right;">-0.2022</td>
<td style="text-align: right;">0.2195</td>
<td style="text-align: right;">-0.92</td>
<td style="text-align: right;">0.3568</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: S20_r &amp; a1 &amp; Sex: Girls</td>
<td style="text-align: right;">0.1733</td>
<td style="text-align: right;">0.2187</td>
<td style="text-align: right;">0.79</td>
<td style="text-align: right;">0.4281</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: SLJ &amp; a1 &amp; Sex: Girls</td>
<td style="text-align: right;">0.0051</td>
<td style="text-align: right;">0.2172</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.9811</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: BMT &amp; a1 &amp; Sex: Girls</td>
<td style="text-align: right;">0.1961</td>
<td style="text-align: right;">0.2168</td>
<td style="text-align: right;">0.90</td>
<td style="text-align: right;">0.3657</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Residual</td>
<td style="text-align: right;">0.9681</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="56" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">issingular</span>(m_oviCohort)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>false</code></pre>
</div>
</div>
<p>This solves the problem with singularity, but does LMM <code>m_zcpCohort</code> fit noise relative to the LMM <code>m_oviCohort</code>?</p>
<div id="58" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>MixedModels.<span class="fu">likelihoodratiotest</span>(m_oviCohort, m_zcpCohort)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td style="text-align: left;" data-quarto-table-cell-role="th"></td>
<td style="text-align: right;" data-quarto-table-cell-role="th">model-dof</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">deviance</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">χ²</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">χ²-dof</td>
<td style="text-align: left;" data-quarto-table-cell-role="th">P(&gt;χ²)</td>
</tr>
<tr class="even">
<td style="text-align: left;">zScore ~ 1 + Test + a1 + Sex + Test &amp; a1 + Test &amp; Sex + a1 &amp; Sex + Test &amp; a1 &amp; Sex + (1 | Cohort)</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">26803</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">zScore ~ 1 + Test + a1 + Sex + Test &amp; a1 + Test &amp; Sex + a1 &amp; Sex + Test &amp; a1 &amp; Sex + zerocorr(1 + Test | Cohort)</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">26803</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">0.9968</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="60" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>gof_summary2 <span class="op">=</span> <span class="kw">let</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  mods <span class="op">=</span> [m_oviCohort, m_zcpCohort, m_cpxCohort]</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">DataFrame</span>(;</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    dof<span class="op">=</span><span class="fu">dof</span>.(mods),</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    deviance<span class="op">=</span><span class="fu">deviance</span>.(mods),</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    AIC<span class="op">=</span><span class="fu">aic</span>.(mods),</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>    AICc<span class="op">=</span><span class="fu">aicc</span>.(mods),</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>    BIC<span class="op">=</span><span class="fu">bic</span>.(mods),</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>3×5 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">dof</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">deviance</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">AIC</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">AICc</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">BIC</th>
</tr>
<tr class="odd subheader headerLastRow">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">26802.9</td>
<td style="text-align: right;">26846.9</td>
<td style="text-align: right;">26847.0</td>
<td style="text-align: right;">27004.7</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">26802.7</td>
<td style="text-align: right;">26854.7</td>
<td style="text-align: right;">26854.8</td>
<td style="text-align: right;">27041.3</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">26790.5</td>
<td style="text-align: right;">26862.5</td>
<td style="text-align: right;">26862.7</td>
<td style="text-align: right;">27120.8</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Indeed, adding VCs is fitting noise. Again, the goodness of fit statistics unanimously favor the selection of the LMM <code>m_oviCohort</code>.</p>
<p>Not shown here, but the <code>Cohort</code>-related VCs for the <code>Test</code> contrasts could be estimated reliably for the <strong>full</strong> data. Thus, the small number of cohorts does not necessarily prevent the determination of reliable differences between tests across cohorts. What if we include VCs and CPs related to random factors <code>Child</code> and <code>School</code>?</p>
</section>
<section id="fitting-the-published-lmm-m1-to-the-reduced-data" class="level2" data-number="4.6">
<h2 data-number="4.6" class="anchored" data-anchor-id="fitting-the-published-lmm-m1-to-the-reduced-data"><span class="header-section-number">4.6</span> Fitting the published LMM <code>m1</code> to the reduced data</h2>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>The following LMMs <code>m1</code>, <code>m2</code>, etc. take a bit longer (e.g., close to 6 minutes in the Pluto notebook, close to 3 minutes in the REPL on a MacBook Pro).</p>
</div>
</div>
<p>LMM <code>m1</code> reported in <span class="citation" data-cites="Fuehner2021">Fühner et al. (<a href="#ref-Fuehner2021" role="doc-biblioref">2021</a>)</span> included random factors for <code>School</code>, <code>Child</code>, and <code>Cohort</code>. The RES for <code>School</code> was specified like in LMM <code>m_cpx</code>. The RES for <code>Child</code> included VCs and CPs for <code>Test</code>, but not for linear developmental gain in the ninth year of life <code>a1</code> or <code>Sex</code>; they are between-<code>Child</code> effects.</p>
<p>The RES for <code>Cohort</code> included only VCs, no CPs for <code>Test</code>. The <em>parsimony</em> was due to the small number of nine levels for this grouping factor.</p>
<p>Here we fit this LMM <code>m1</code> for the reduced data. For a different subset of similar size on MacBook Pro [13 | 15 | 16] this took [303 | 250 | 244 ] s; for LMM <code>m1a</code> (i.e., dropping 1 school-relate VC for <code>Sex</code>), times are [212 | 165 | 160] s. The corresponding <code>lme4</code> times for LMM <code>m1</code> are [397 | 348 | 195].</p>
<p>Finally, times for fitting the full set of data –not in this script–, for LMM <code>m1</code>are [60 | 62 | 85] minutes (!); for LMM <code>m1a</code> the times were [46 | 48 | 34] minutes. It was not possible to fit the full set of data with <code>lme4</code>; after about 13 to 18 minutes the program stopped with: <code>Error in eval_f(x, ...) : Downdated VtV is not positive definite.</code></p>
<div id="62" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="op">=</span> <span class="kw">let</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  f <span class="op">=</span> <span class="pp">@formula</span>(</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    zScore <span class="op">~</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>      <span class="fl">1</span> <span class="op">+</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>      <span class="bu">Test</span> <span class="op">*</span> a1 <span class="op">*</span> Sex <span class="op">+</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>      (<span class="fl">1</span> <span class="op">+</span> <span class="bu">Test</span> <span class="op">+</span> a1 <span class="op">+</span> Sex <span class="op">|</span> School) <span class="op">+</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>      (<span class="fl">1</span> <span class="op">+</span> <span class="bu">Test</span> <span class="op">|</span> Child) <span class="op">+</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">zerocorr</span>(<span class="fl">1</span> <span class="op">+</span> <span class="bu">Test</span> <span class="op">|</span> Cohort)</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(MixedModel, f, dat; contrasts)</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Minimizing 2    Time: 0:00:01 ( 0.61  s/it)
  objective:  26263.798630532
Minimizing 10    Time: 0:00:01 ( 0.13  s/it)
  objective:  26032.802373659586
Minimizing 18    Time: 0:00:01 (79.12 ms/it)
  objective:  25909.53939555904
Minimizing 26    Time: 0:00:01 (58.76 ms/it)
  objective:  25986.562881083046
Minimizing 34    Time: 0:00:01 (48.00 ms/it)
  objective:  25898.37560027311
Minimizing 42    Time: 0:00:01 (41.44 ms/it)
  objective:  25880.23790580926
Minimizing 50    Time: 0:00:01 (36.87 ms/it)
  objective:  27685.247320995768
Minimizing 58    Time: 0:00:01 (33.60 ms/it)
  objective:  26001.805014197045
Minimizing 66    Time: 0:00:02 (31.12 ms/it)
  objective:  25912.198496703462
Minimizing 74    Time: 0:00:02 (29.18 ms/it)
  objective:  25949.27949843974
Minimizing 82    Time: 0:00:02 (27.63 ms/it)
  objective:  25921.90653011039
Minimizing 90    Time: 0:00:02 (26.37 ms/it)
  objective:  25836.707585481112
Minimizing 98    Time: 0:00:02 (25.28 ms/it)
  objective:  25218.359672227205
Minimizing 106    Time: 0:00:02 (24.35 ms/it)
  objective:  25054.4576240143
Minimizing 114    Time: 0:00:02 (23.55 ms/it)
  objective:  25052.320501610564
Minimizing 122    Time: 0:00:02 (22.84 ms/it)
  objective:  24999.384497783954
Minimizing 130    Time: 0:00:02 (22.27 ms/it)
  objective:  24956.41343582866
Minimizing 138    Time: 0:00:03 (21.75 ms/it)
  objective:  24914.946584626545
Minimizing 146    Time: 0:00:03 (21.26 ms/it)
  objective:  24893.847196663002
Minimizing 154    Time: 0:00:03 (20.83 ms/it)
  objective:  24865.46703494803
Minimizing 162    Time: 0:00:03 (20.43 ms/it)
  objective:  24852.889649488112
Minimizing 170    Time: 0:00:03 (20.08 ms/it)
  objective:  24833.636378199408
Minimizing 178    Time: 0:00:03 (19.76 ms/it)
  objective:  24821.186037541243
Minimizing 186    Time: 0:00:03 (19.46 ms/it)
  objective:  24791.370242087396
Minimizing 194    Time: 0:00:03 (19.23 ms/it)
  objective:  24786.669733863615
Minimizing 202    Time: 0:00:03 (19.02 ms/it)
  objective:  24772.413565464158
Minimizing 210    Time: 0:00:03 (18.83 ms/it)
  objective:  24766.46535676397
Minimizing 218    Time: 0:00:04 (18.62 ms/it)
  objective:  24762.134758352295
Minimizing 226    Time: 0:00:04 (18.44 ms/it)
  objective:  24757.76410159139
Minimizing 234    Time: 0:00:04 (18.25 ms/it)
  objective:  24753.58928112908
Minimizing 242    Time: 0:00:04 (18.08 ms/it)
  objective:  24747.304757821454
Minimizing 250    Time: 0:00:04 (17.94 ms/it)
  objective:  24742.824950872637
Minimizing 257    Time: 0:00:04 (17.84 ms/it)
  objective:  24744.29596899636
Minimizing 265    Time: 0:00:04 (17.72 ms/it)
  objective:  24739.72217648851
Minimizing 273    Time: 0:00:04 (17.60 ms/it)
  objective:  24736.572876439044
Minimizing 281    Time: 0:00:04 (17.47 ms/it)
  objective:  24731.59897556257
Minimizing 289    Time: 0:00:05 (17.34 ms/it)
  objective:  24725.792527037745
Minimizing 297    Time: 0:00:05 (17.24 ms/it)
  objective:  24723.377321071024
Minimizing 305    Time: 0:00:05 (17.15 ms/it)
  objective:  24718.708289643593
Minimizing 313    Time: 0:00:05 (17.05 ms/it)
  objective:  24714.227854491233
Minimizing 321    Time: 0:00:05 (16.95 ms/it)
  objective:  24716.813508738473
Minimizing 329    Time: 0:00:05 (16.88 ms/it)
  objective:  24715.458991594605
Minimizing 337    Time: 0:00:05 (16.81 ms/it)
  objective:  24712.949077361896
Minimizing 345    Time: 0:00:05 (16.75 ms/it)
  objective:  24708.166068056376
Minimizing 353    Time: 0:00:05 (16.68 ms/it)
  objective:  24706.765806621424
Minimizing 361    Time: 0:00:06 (16.63 ms/it)
  objective:  24707.913284010036
Minimizing 369    Time: 0:00:06 (16.55 ms/it)
  objective:  24705.05082837271
Minimizing 377    Time: 0:00:06 (16.48 ms/it)
  objective:  24703.819443003686
Minimizing 385    Time: 0:00:06 (16.41 ms/it)
  objective:  24703.677592919787
Minimizing 393    Time: 0:00:06 (16.34 ms/it)
  objective:  24703.18196364243
Minimizing 401    Time: 0:00:06 (16.27 ms/it)
  objective:  24702.363946121135
Minimizing 409    Time: 0:00:06 (16.21 ms/it)
  objective:  24701.63190102658
Minimizing 417    Time: 0:00:06 (16.14 ms/it)
  objective:  24701.09678875273
Minimizing 425    Time: 0:00:06 (16.09 ms/it)
  objective:  24700.896820937352
Minimizing 433    Time: 0:00:06 (16.03 ms/it)
  objective:  24700.61501064425
Minimizing 441    Time: 0:00:07 (15.98 ms/it)
  objective:  24700.15273724909
Minimizing 449    Time: 0:00:07 (15.92 ms/it)
  objective:  24699.86376118735
Minimizing 457    Time: 0:00:07 (15.87 ms/it)
  objective:  24699.362939096965
Minimizing 465    Time: 0:00:07 (15.82 ms/it)
  objective:  24699.246571817333
Minimizing 473    Time: 0:00:07 (15.84 ms/it)
  objective:  24699.151605194136
Minimizing 481    Time: 0:00:07 (15.80 ms/it)
  objective:  24699.115862227438
Minimizing 489    Time: 0:00:07 (15.76 ms/it)
  objective:  24698.8833308756
Minimizing 497    Time: 0:00:07 (15.72 ms/it)
  objective:  24698.1518893173
Minimizing 505    Time: 0:00:07 (15.68 ms/it)
  objective:  24698.060517805414
Minimizing 513    Time: 0:00:08 (15.65 ms/it)
  objective:  24697.917889344237
Minimizing 521    Time: 0:00:08 (15.61 ms/it)
  objective:  24697.383587125103
Minimizing 529    Time: 0:00:08 (15.57 ms/it)
  objective:  24696.53884071827
Minimizing 537    Time: 0:00:08 (15.53 ms/it)
  objective:  24695.698401968824
Minimizing 545    Time: 0:00:08 (15.49 ms/it)
  objective:  24695.55574667539
Minimizing 553    Time: 0:00:08 (15.50 ms/it)
  objective:  24695.12738701081
Minimizing 560    Time: 0:00:08 (15.51 ms/it)
  objective:  24693.13130315552
Minimizing 567    Time: 0:00:08 (15.53 ms/it)
  objective:  24692.038142708494
Minimizing 574    Time: 0:00:08 (15.54 ms/it)
  objective:  24678.58646800586
Minimizing 581    Time: 0:00:09 (15.55 ms/it)
  objective:  24678.818908833953
Minimizing 587    Time: 0:00:09 (15.57 ms/it)
  objective:  24676.389341414582
Minimizing 593    Time: 0:00:09 (15.58 ms/it)
  objective:  24671.56373576434
Minimizing 599    Time: 0:00:09 (15.59 ms/it)
  objective:  24667.705378898834
Minimizing 606    Time: 0:00:09 (15.61 ms/it)
  objective:  24667.11381795389
Minimizing 614    Time: 0:00:09 (15.57 ms/it)
  objective:  24666.42084029146
Minimizing 622    Time: 0:00:09 (15.54 ms/it)
  objective:  24661.542615706596
Minimizing 630    Time: 0:00:09 (15.52 ms/it)
  objective:  24660.649476650564
Minimizing 638    Time: 0:00:09 (15.49 ms/it)
  objective:  24659.11680999573
Minimizing 646    Time: 0:00:09 (15.46 ms/it)
  objective:  24658.428278522435
Minimizing 654    Time: 0:00:10 (15.43 ms/it)
  objective:  24657.25952023676
Minimizing 662    Time: 0:00:10 (15.40 ms/it)
  objective:  24656.446859476826
Minimizing 670    Time: 0:00:10 (15.37 ms/it)
  objective:  24655.168140020396
Minimizing 678    Time: 0:00:10 (15.34 ms/it)
  objective:  24654.28041030011
Minimizing 686    Time: 0:00:10 (15.31 ms/it)
  objective:  24654.06780229167
Minimizing 694    Time: 0:00:10 (15.28 ms/it)
  objective:  24653.68974304936
Minimizing 702    Time: 0:00:10 (15.25 ms/it)
  objective:  24653.619827101793
Minimizing 710    Time: 0:00:10 (15.22 ms/it)
  objective:  24653.302664698494
Minimizing 718    Time: 0:00:10 (15.19 ms/it)
  objective:  24652.929449183524
Minimizing 726    Time: 0:00:11 (15.17 ms/it)
  objective:  24652.857108753622
Minimizing 734    Time: 0:00:11 (15.15 ms/it)
  objective:  24652.625565747767
Minimizing 742    Time: 0:00:11 (15.13 ms/it)
  objective:  24652.411127345717
Minimizing 750    Time: 0:00:11 (15.10 ms/it)
  objective:  24652.463586626553
Minimizing 758    Time: 0:00:11 (15.08 ms/it)
  objective:  24652.239417018252
Minimizing 766    Time: 0:00:11 (15.05 ms/it)
  objective:  24652.160141388435
Minimizing 774    Time: 0:00:11 (15.03 ms/it)
  objective:  24652.03116855609
Minimizing 782    Time: 0:00:11 (15.02 ms/it)
  objective:  24651.847046943094
Minimizing 790    Time: 0:00:11 (14.99 ms/it)
  objective:  24651.784127586812
Minimizing 798    Time: 0:00:11 (14.97 ms/it)
  objective:  24651.69274006296
Minimizing 806    Time: 0:00:12 (14.95 ms/it)
  objective:  24651.687996332294
Minimizing 814    Time: 0:00:12 (14.94 ms/it)
  objective:  24651.635508109248
Minimizing 822    Time: 0:00:12 (14.92 ms/it)
  objective:  24651.56875905724
Minimizing 830    Time: 0:00:12 (14.90 ms/it)
  objective:  24651.496126553197
Minimizing 838    Time: 0:00:12 (14.88 ms/it)
  objective:  24651.40481671076
Minimizing 846    Time: 0:00:12 (14.86 ms/it)
  objective:  24651.407354575
Minimizing 854    Time: 0:00:12 (14.84 ms/it)
  objective:  24651.323434626982
Minimizing 862    Time: 0:00:12 (14.83 ms/it)
  objective:  24651.29504631603
Minimizing 870    Time: 0:00:12 (14.81 ms/it)
  objective:  24651.311300901056
Minimizing 878    Time: 0:00:12 (14.79 ms/it)
  objective:  24651.298276056354
Minimizing 886    Time: 0:00:13 (14.77 ms/it)
  objective:  24651.31025509899
Minimizing 894    Time: 0:00:13 (14.76 ms/it)
  objective:  24651.274571547197
Minimizing 902    Time: 0:00:13 (14.75 ms/it)
  objective:  24651.26716024734
Minimizing 910    Time: 0:00:13 (14.74 ms/it)
  objective:  24651.248490126316
Minimizing 918    Time: 0:00:13 (14.73 ms/it)
  objective:  24651.22649740443
Minimizing 926    Time: 0:00:13 (14.71 ms/it)
  objective:  24651.210418520248
Minimizing 934    Time: 0:00:13 (14.70 ms/it)
  objective:  24651.19685424194
Minimizing 942    Time: 0:00:13 (14.69 ms/it)
  objective:  24651.18964335481
Minimizing 950    Time: 0:00:13 (14.68 ms/it)
  objective:  24651.17759926623
Minimizing 958    Time: 0:00:14 (14.66 ms/it)
  objective:  24651.149153464376
Minimizing 966    Time: 0:00:14 (14.65 ms/it)
  objective:  24651.129084109743
Minimizing 974    Time: 0:00:14 (14.64 ms/it)
  objective:  24651.11081631579
Minimizing 982    Time: 0:00:14 (14.63 ms/it)
  objective:  24651.10298571695
Minimizing 990    Time: 0:00:14 (14.61 ms/it)
  objective:  24651.098979115603
Minimizing 998    Time: 0:00:14 (14.60 ms/it)
  objective:  24651.093761686083
Minimizing 1006    Time: 0:00:14 (14.59 ms/it)
  objective:  24651.09213271858
Minimizing 1014    Time: 0:00:14 (14.57 ms/it)
  objective:  24651.08392533141
Minimizing 1022    Time: 0:00:14 (14.56 ms/it)
  objective:  24651.067859962568
Minimizing 1030    Time: 0:00:14 (14.55 ms/it)
  objective:  24651.06520194812
Minimizing 1038    Time: 0:00:15 (14.54 ms/it)
  objective:  24651.060810670366
Minimizing 1046    Time: 0:00:15 (14.53 ms/it)
  objective:  24651.05670350074
Minimizing 1054    Time: 0:00:15 (14.51 ms/it)
  objective:  24651.054605778412
Minimizing 1062    Time: 0:00:15 (14.50 ms/it)
  objective:  24651.049284248373
Minimizing 1070    Time: 0:00:15 (14.49 ms/it)
  objective:  24651.0464201929
Minimizing 1078    Time: 0:00:15 (14.48 ms/it)
  objective:  24651.045596860844
Minimizing 1086    Time: 0:00:15 (14.47 ms/it)
  objective:  24651.040420920246
Minimizing 1094    Time: 0:00:15 (14.46 ms/it)
  objective:  24651.039182749253
Minimizing 1102    Time: 0:00:15 (14.45 ms/it)
  objective:  24651.037359140148
Minimizing 1110    Time: 0:00:16 (14.44 ms/it)
  objective:  24651.03330462238
Minimizing 1118    Time: 0:00:16 (14.43 ms/it)
  objective:  24651.03151596733
Minimizing 1126    Time: 0:00:16 (14.42 ms/it)
  objective:  24651.030760071368
Minimizing 1134    Time: 0:00:16 (14.41 ms/it)
  objective:  24651.027194386923
Minimizing 1142    Time: 0:00:16 (14.40 ms/it)
  objective:  24651.025631575212
Minimizing 1150    Time: 0:00:16 (14.38 ms/it)
  objective:  24651.024596174822
Minimizing 1158    Time: 0:00:16 (14.37 ms/it)
  objective:  24651.02241015472
Minimizing 1166    Time: 0:00:16 (14.36 ms/it)
  objective:  24651.021905047914
Minimizing 1174    Time: 0:00:16 (14.35 ms/it)
  objective:  24651.020751495194
Minimizing 1182    Time: 0:00:16 (14.34 ms/it)
  objective:  24651.01996893064
Minimizing 1190    Time: 0:00:17 (14.33 ms/it)
  objective:  24651.019319883733
Minimizing 1198    Time: 0:00:17 (14.33 ms/it)
  objective:  24651.019552708614
Minimizing 1206    Time: 0:00:17 (14.33 ms/it)
  objective:  24651.018277036655
Minimizing 1214    Time: 0:00:17 (14.33 ms/it)
  objective:  24651.018391170022
Minimizing 1222    Time: 0:00:17 (14.32 ms/it)
  objective:  24651.01799501553
Minimizing 1230    Time: 0:00:17 (14.31 ms/it)
  objective:  24651.017306673806
Minimizing 1238    Time: 0:00:17 (14.31 ms/it)
  objective:  24651.01716018239
Minimizing 1246    Time: 0:00:17 (14.30 ms/it)
  objective:  24651.01700720565
Minimizing 1254    Time: 0:00:17 (14.29 ms/it)
  objective:  24651.017156225666
Minimizing 1262    Time: 0:00:18 (14.28 ms/it)
  objective:  24651.017078825065
Minimizing 1270    Time: 0:00:18 (14.28 ms/it)
  objective:  24651.017081048733
Minimizing 1278    Time: 0:00:18 (14.27 ms/it)
  objective:  24651.017027630012
Minimizing 1286    Time: 0:00:18 (14.27 ms/it)
  objective:  24651.0165249109
Minimizing 1294    Time: 0:00:18 (14.26 ms/it)
  objective:  24651.016514311843
Minimizing 1302    Time: 0:00:18 (14.26 ms/it)
  objective:  24651.01643433857
Minimizing 1310    Time: 0:00:18 (14.25 ms/it)
  objective:  24651.016395205435
Minimizing 1318    Time: 0:00:18 (14.25 ms/it)
  objective:  24651.016339884165
Minimizing 1326    Time: 0:00:18 (14.24 ms/it)
  objective:  24651.016310890016
Minimizing 1334    Time: 0:00:18 (14.24 ms/it)
  objective:  24651.016295792695
Minimizing 1342    Time: 0:00:19 (14.24 ms/it)
  objective:  24651.016276136255
Minimizing 1350    Time: 0:00:19 (14.23 ms/it)
  objective:  24651.016203243234
Minimizing 1358    Time: 0:00:19 (14.23 ms/it)
  objective:  24651.0161912915
Minimizing 1366    Time: 0:00:19 (14.22 ms/it)
  objective:  24651.01610875644
Minimizing 1374    Time: 0:00:19 (14.21 ms/it)
  objective:  24651.015989577405
Minimizing 1382    Time: 0:00:19 (14.21 ms/it)
  objective:  24651.01595999897
Minimizing 1390    Time: 0:00:19 (14.20 ms/it)
  objective:  24651.015947854627
Minimizing 1398    Time: 0:00:19 (14.20 ms/it)
  objective:  24651.01595044735
Minimizing 1406    Time: 0:00:19 (14.19 ms/it)
  objective:  24651.015917806668
Minimizing 1414    Time: 0:00:20 (14.19 ms/it)
  objective:  24651.015892329753
Minimizing 1422    Time: 0:00:20 (14.18 ms/it)
  objective:  24651.015874911966
Minimizing 1430    Time: 0:00:20 (14.18 ms/it)
  objective:  24651.015796210548
Minimizing 1438    Time: 0:00:20 (14.18 ms/it)
  objective:  24651.01577879441
Minimizing 1446    Time: 0:00:20 (14.17 ms/it)
  objective:  24651.015705768066
Minimizing 1454    Time: 0:00:20 (14.17 ms/it)
  objective:  24651.01572673725
Minimizing 1462    Time: 0:00:20 (14.16 ms/it)
  objective:  24651.01561362497
Minimizing 1470    Time: 0:00:20 (14.16 ms/it)
  objective:  24651.01560258209
Minimizing 1478    Time: 0:00:20 (14.15 ms/it)
  objective:  24651.01557792974
Minimizing 1486    Time: 0:00:21 (14.15 ms/it)
  objective:  24651.015571319556
Minimizing 1494    Time: 0:00:21 (14.14 ms/it)
  objective:  24651.01549903939
Minimizing 1502    Time: 0:00:21 (14.14 ms/it)
  objective:  24651.01547620207
Minimizing 1510    Time: 0:00:21 (14.13 ms/it)
  objective:  24651.01541885895
Minimizing 1518    Time: 0:00:21 (14.13 ms/it)
  objective:  24651.015409991058
Minimizing 1539    Time: 0:00:21 (14.16 ms/it)
  objective:  24651.01534260885
Minimizing 1549    Time: 0:00:21 (14.15 ms/it)
  objective:  24651.015331627394
Minimizing 1557    Time: 0:00:22 (14.15 ms/it)
  objective:  24651.015299824558
Minimizing 1565    Time: 0:00:22 (14.14 ms/it)
  objective:  24651.015234156173
Minimizing 1573    Time: 0:00:22 (14.14 ms/it)
  objective:  24651.015191282593
Minimizing 1581    Time: 0:00:22 (14.13 ms/it)
  objective:  24651.015172503638
Minimizing 1589    Time: 0:00:22 (14.13 ms/it)
  objective:  24651.01514874262
Minimizing 1597    Time: 0:00:22 (14.13 ms/it)
  objective:  24651.01511623719
Minimizing 1605    Time: 0:00:22 (14.12 ms/it)
  objective:  24651.015053709496
Minimizing 1613    Time: 0:00:22 (14.12 ms/it)
  objective:  24651.01502497716
Minimizing 1621    Time: 0:00:22 (14.12 ms/it)
  objective:  24651.01497446181
Minimizing 1629    Time: 0:00:22 (14.11 ms/it)
  objective:  24651.014941877227
Minimizing 1637    Time: 0:00:23 (14.11 ms/it)
  objective:  24651.01494574121
Minimizing 1645    Time: 0:00:23 (14.10 ms/it)
  objective:  24651.01487685147
Minimizing 1653    Time: 0:00:23 (14.10 ms/it)
  objective:  24651.014834119243
Minimizing 1661    Time: 0:00:23 (14.10 ms/it)
  objective:  24651.014801303565
Minimizing 1669    Time: 0:00:23 (14.09 ms/it)
  objective:  24651.014780782607
Minimizing 1677    Time: 0:00:23 (14.09 ms/it)
  objective:  24651.014723134558
Minimizing 1684    Time: 0:00:23 (14.09 ms/it)
  objective:  24651.01470064149
Minimizing 1692    Time: 0:00:23 (14.09 ms/it)
  objective:  24651.014673650465
Minimizing 1700    Time: 0:00:23 (14.08 ms/it)
  objective:  24651.014635317995
Minimizing 1708    Time: 0:00:24 (14.08 ms/it)
  objective:  24651.01459270252
Minimizing 1716    Time: 0:00:24 (14.08 ms/it)
  objective:  24651.01455564439
Minimizing 1724    Time: 0:00:24 (14.08 ms/it)
  objective:  24651.014519669363
Minimizing 1732    Time: 0:00:24 (14.07 ms/it)
  objective:  24651.014505054405
Minimizing 1740    Time: 0:00:24 (14.07 ms/it)
  objective:  24651.01449206109
Minimizing 1748    Time: 0:00:24 (14.06 ms/it)
  objective:  24651.01445794005
Minimizing 1756    Time: 0:00:24 (14.06 ms/it)
  objective:  24651.0144058898
Minimizing 1764    Time: 0:00:24 (14.05 ms/it)
  objective:  24651.014378787884
Minimizing 1772    Time: 0:00:24 (14.05 ms/it)
  objective:  24651.01434324346
Minimizing 1780    Time: 0:00:24 (14.04 ms/it)
  objective:  24651.014334378262
Minimizing 1788    Time: 0:00:25 (14.04 ms/it)
  objective:  24651.014273782956
Minimizing 1796    Time: 0:00:25 (14.03 ms/it)
  objective:  24651.014245677798
Minimizing 1804    Time: 0:00:25 (14.02 ms/it)
  objective:  24651.01423229063
Minimizing 1812    Time: 0:00:25 (14.02 ms/it)
  objective:  24651.014222059363
Minimizing 1820    Time: 0:00:25 (14.01 ms/it)
  objective:  24651.01418156778
Minimizing 1828    Time: 0:00:25 (14.01 ms/it)
  objective:  24651.014162000316
Minimizing 1836    Time: 0:00:25 (14.01 ms/it)
  objective:  24651.014132598506
Minimizing 1844    Time: 0:00:25 (14.01 ms/it)
  objective:  24651.0141144742
Minimizing 1852    Time: 0:00:25 (14.01 ms/it)
  objective:  24651.01409509868
Minimizing 1860    Time: 0:00:26 (14.01 ms/it)
  objective:  24651.0140637523
Minimizing 1868    Time: 0:00:26 (14.00 ms/it)
  objective:  24651.01405627704
Minimizing 1876    Time: 0:00:26 (14.00 ms/it)
  objective:  24651.014037037705
Minimizing 1877    Time: 0:00:26 (14.00 ms/it)

Minimizing 1878    Time: 0:00:26 (14.00 ms/it)
  objective:  24651.014036789165</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="1">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td style="text-align: left;" data-quarto-table-cell-role="th"></td>
<td style="text-align: right;" data-quarto-table-cell-role="th">Est.</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">SE</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">z</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">p</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">σ_Child</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">σ_School</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">σ_Cohort</td>
</tr>
<tr class="even">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-0.0133</td>
<td style="text-align: right;">0.0192</td>
<td style="text-align: right;">-0.69</td>
<td style="text-align: right;">0.4877</td>
<td style="text-align: right;">0.5873</td>
<td style="text-align: right;">0.2138</td>
<td style="text-align: right;">0.0132</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: Star_r</td>
<td style="text-align: right;">0.0088</td>
<td style="text-align: right;">0.0375</td>
<td style="text-align: right;">0.24</td>
<td style="text-align: right;">0.8135</td>
<td style="text-align: right;">0.7434</td>
<td style="text-align: right;">0.3328</td>
<td style="text-align: right;">0.0638</td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: S20_r</td>
<td style="text-align: right;">0.0092</td>
<td style="text-align: right;">0.0293</td>
<td style="text-align: right;">0.31</td>
<td style="text-align: right;">0.7546</td>
<td style="text-align: right;">0.6341</td>
<td style="text-align: right;">0.3280</td>
<td style="text-align: right;">0.0076</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: SLJ</td>
<td style="text-align: right;">0.0034</td>
<td style="text-align: right;">0.0300</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">0.9102</td>
<td style="text-align: right;">0.5421</td>
<td style="text-align: right;">0.3212</td>
<td style="text-align: right;">0.0339</td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: BMT</td>
<td style="text-align: right;">-0.0383</td>
<td style="text-align: right;">0.0296</td>
<td style="text-align: right;">-1.29</td>
<td style="text-align: right;">0.1954</td>
<td style="text-align: right;">0.7213</td>
<td style="text-align: right;">0.3130</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">a1</td>
<td style="text-align: right;">0.1956</td>
<td style="text-align: right;">0.0545</td>
<td style="text-align: right;">3.59</td>
<td style="text-align: right;">0.0003</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">0.2825</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Sex: Girls</td>
<td style="text-align: right;">-0.4287</td>
<td style="text-align: right;">0.0312</td>
<td style="text-align: right;">-13.75</td>
<td style="text-align: right;">&lt;1e-42</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">0.1435</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: Star_r &amp; a1</td>
<td style="text-align: right;">0.2898</td>
<td style="text-align: right;">0.0887</td>
<td style="text-align: right;">3.27</td>
<td style="text-align: right;">0.0011</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: S20_r &amp; a1</td>
<td style="text-align: right;">-0.0784</td>
<td style="text-align: right;">0.0817</td>
<td style="text-align: right;">-0.96</td>
<td style="text-align: right;">0.3370</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: SLJ &amp; a1</td>
<td style="text-align: right;">-0.0631</td>
<td style="text-align: right;">0.0769</td>
<td style="text-align: right;">-0.82</td>
<td style="text-align: right;">0.4118</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: BMT &amp; a1</td>
<td style="text-align: right;">0.4713</td>
<td style="text-align: right;">0.0852</td>
<td style="text-align: right;">5.54</td>
<td style="text-align: right;">&lt;1e-07</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: Star_r &amp; Sex: Girls</td>
<td style="text-align: right;">0.3756</td>
<td style="text-align: right;">0.0511</td>
<td style="text-align: right;">7.35</td>
<td style="text-align: right;">&lt;1e-12</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: S20_r &amp; Sex: Girls</td>
<td style="text-align: right;">-0.1867</td>
<td style="text-align: right;">0.0475</td>
<td style="text-align: right;">-3.93</td>
<td style="text-align: right;">&lt;1e-04</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: SLJ &amp; Sex: Girls</td>
<td style="text-align: right;">-0.0695</td>
<td style="text-align: right;">0.0445</td>
<td style="text-align: right;">-1.56</td>
<td style="text-align: right;">0.1184</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: BMT &amp; Sex: Girls</td>
<td style="text-align: right;">-0.2812</td>
<td style="text-align: right;">0.0495</td>
<td style="text-align: right;">-5.68</td>
<td style="text-align: right;">&lt;1e-07</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">a1 &amp; Sex: Girls</td>
<td style="text-align: right;">-0.1267</td>
<td style="text-align: right;">0.1048</td>
<td style="text-align: right;">-1.21</td>
<td style="text-align: right;">0.2269</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: Star_r &amp; a1 &amp; Sex: Girls</td>
<td style="text-align: right;">-0.1382</td>
<td style="text-align: right;">0.1756</td>
<td style="text-align: right;">-0.79</td>
<td style="text-align: right;">0.4312</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: S20_r &amp; a1 &amp; Sex: Girls</td>
<td style="text-align: right;">0.1753</td>
<td style="text-align: right;">0.1633</td>
<td style="text-align: right;">1.07</td>
<td style="text-align: right;">0.2832</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: SLJ &amp; a1 &amp; Sex: Girls</td>
<td style="text-align: right;">-0.0154</td>
<td style="text-align: right;">0.1530</td>
<td style="text-align: right;">-0.10</td>
<td style="text-align: right;">0.9196</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: BMT &amp; a1 &amp; Sex: Girls</td>
<td style="text-align: right;">0.1548</td>
<td style="text-align: right;">0.1702</td>
<td style="text-align: right;">0.91</td>
<td style="text-align: right;">0.3630</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Residual</td>
<td style="text-align: right;">0.5331</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="64" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VarCorr</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td style="text-align: left;" data-quarto-table-cell-role="th"></td>
<td style="text-align: left;" data-quarto-table-cell-role="th">Column</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">Variance</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">Std.Dev</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">Corr.</td>
<td style="text-align: right;" data-quarto-table-cell-role="th"></td>
<td style="text-align: right;" data-quarto-table-cell-role="th"></td>
<td style="text-align: right;" data-quarto-table-cell-role="th"></td>
<td style="text-align: right;" data-quarto-table-cell-role="th"></td>
<td style="text-align: right;" data-quarto-table-cell-role="th"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Child</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.34495271</td>
<td style="text-align: right;">0.58732675</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: Star_r</td>
<td style="text-align: right;">0.55269763</td>
<td style="text-align: right;">0.74343636</td>
<td style="text-align: right;">+0.14</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: S20_r</td>
<td style="text-align: right;">0.40212511</td>
<td style="text-align: right;">0.63413336</td>
<td style="text-align: right;">+0.00</td>
<td style="text-align: right;">-0.52</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: SLJ</td>
<td style="text-align: right;">0.29385597</td>
<td style="text-align: right;">0.54208484</td>
<td style="text-align: right;">+0.05</td>
<td style="text-align: right;">-0.04</td>
<td style="text-align: right;">-0.35</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: BMT</td>
<td style="text-align: right;">0.52032198</td>
<td style="text-align: right;">0.72133347</td>
<td style="text-align: right;">-0.35</td>
<td style="text-align: right;">+0.14</td>
<td style="text-align: right;">-0.18</td>
<td style="text-align: right;">-0.22</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">School</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.04570702</td>
<td style="text-align: right;">0.21379201</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: Star_r</td>
<td style="text-align: right;">0.11076869</td>
<td style="text-align: right;">0.33281931</td>
<td style="text-align: right;">-0.06</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: S20_r</td>
<td style="text-align: right;">0.10761018</td>
<td style="text-align: right;">0.32803990</td>
<td style="text-align: right;">-0.08</td>
<td style="text-align: right;">-0.39</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: SLJ</td>
<td style="text-align: right;">0.10318843</td>
<td style="text-align: right;">0.32122956</td>
<td style="text-align: right;">-0.19</td>
<td style="text-align: right;">+0.21</td>
<td style="text-align: right;">-0.81</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: BMT</td>
<td style="text-align: right;">0.09795181</td>
<td style="text-align: right;">0.31297254</td>
<td style="text-align: right;">-0.33</td>
<td style="text-align: right;">-0.02</td>
<td style="text-align: right;">+0.13</td>
<td style="text-align: right;">-0.38</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">a1</td>
<td style="text-align: right;">0.07982565</td>
<td style="text-align: right;">0.28253433</td>
<td style="text-align: right;">+0.62</td>
<td style="text-align: right;">-0.20</td>
<td style="text-align: right;">+0.11</td>
<td style="text-align: right;">-0.61</td>
<td style="text-align: right;">+0.45</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Sex: Girls</td>
<td style="text-align: right;">0.02059180</td>
<td style="text-align: right;">0.14349843</td>
<td style="text-align: right;">-0.45</td>
<td style="text-align: right;">+0.45</td>
<td style="text-align: right;">+0.31</td>
<td style="text-align: right;">-0.27</td>
<td style="text-align: right;">-0.15</td>
<td style="text-align: right;">-0.37</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cohort</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.00017441</td>
<td style="text-align: right;">0.01320652</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: Star_r</td>
<td style="text-align: right;">0.00406549</td>
<td style="text-align: right;">0.06376120</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: S20_r</td>
<td style="text-align: right;">0.00005702</td>
<td style="text-align: right;">0.00755108</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: SLJ</td>
<td style="text-align: right;">0.00114959</td>
<td style="text-align: right;">0.03390556</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: BMT</td>
<td style="text-align: right;">0.00000000</td>
<td style="text-align: right;">0.00000000</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Residual</td>
<td style="text-align: left;"></td>
<td style="text-align: right;">0.28422522</td>
<td style="text-align: right;">0.53312777</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="66" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">issingular</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>true</code></pre>
</div>
</div>
<p>Depending on the random number for stratified samplign, LMM <code>m1</code> may or may not be supported by the data.</p>
<p>We also fit an alternative parameterization, estimating VCs and CPs for <code>Test</code> scores rather than <code>Test</code> effects by replacing the <code>1 + ...</code> in the RE terms with <code>0 + ...</code>.</p>
<div id="68" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>m2 <span class="op">=</span> <span class="kw">let</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  f <span class="op">=</span> <span class="pp">@formula</span>(</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>    zScore <span class="op">~</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>      <span class="fl">1</span> <span class="op">+</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>      <span class="bu">Test</span> <span class="op">*</span> a1 <span class="op">*</span> Sex <span class="op">+</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>      (<span class="fl">0</span> <span class="op">+</span> <span class="bu">Test</span> <span class="op">+</span> a1 <span class="op">+</span> Sex <span class="op">|</span> School) <span class="op">+</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>      (<span class="fl">0</span> <span class="op">+</span> <span class="bu">Test</span> <span class="op">|</span> Child) <span class="op">+</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">zerocorr</span>(<span class="fl">0</span> <span class="op">+</span> <span class="bu">Test</span> <span class="op">|</span> Cohort)</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(MixedModel, f, dat; contrasts)</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Minimizing 8    Time: 0:00:00 (13.13 ms/it)
  objective:  26540.628428689935
Minimizing 16    Time: 0:00:00 (12.98 ms/it)
  objective:  27013.20266803618
Minimizing 24    Time: 0:00:00 (13.30 ms/it)
  objective:  26938.094323301608
Minimizing 32    Time: 0:00:00 (13.37 ms/it)
  objective:  26816.3549662712
Minimizing 40    Time: 0:00:00 (13.36 ms/it)
  objective:  26764.50301863997
Minimizing 48    Time: 0:00:00 (13.37 ms/it)
  objective:  26748.52532251481
Minimizing 56    Time: 0:00:00 (13.35 ms/it)
  objective:  27607.74073471175
Minimizing 64    Time: 0:00:00 (13.34 ms/it)
  objective:  27035.518325217672
Minimizing 72    Time: 0:00:00 (13.26 ms/it)
  objective:  26743.04860536076
Minimizing 80    Time: 0:00:01 (13.20 ms/it)
  objective:  26914.37946666574
Minimizing 88    Time: 0:00:01 (13.15 ms/it)
  objective:  26750.53281469535
Minimizing 96    Time: 0:00:01 (13.13 ms/it)
  objective:  26718.60071956578
Minimizing 104    Time: 0:00:01 (13.14 ms/it)
  objective:  25121.980475037257
Minimizing 112    Time: 0:00:01 (13.13 ms/it)
  objective:  25011.13301114371
Minimizing 120    Time: 0:00:01 (13.13 ms/it)
  objective:  24997.24925764957
Minimizing 128    Time: 0:00:01 (13.12 ms/it)
  objective:  24953.65373230762
Minimizing 136    Time: 0:00:01 (13.11 ms/it)
  objective:  24958.120022161565
Minimizing 144    Time: 0:00:01 (13.10 ms/it)
  objective:  24900.668392425818
Minimizing 152    Time: 0:00:01 (13.10 ms/it)
  objective:  24893.96205392398
Minimizing 160    Time: 0:00:02 (13.10 ms/it)
  objective:  24873.636974246172
Minimizing 168    Time: 0:00:02 (13.23 ms/it)
  objective:  24859.799925935025
Minimizing 174    Time: 0:00:02 (13.37 ms/it)
  objective:  24831.117936158902
Minimizing 181    Time: 0:00:02 (13.49 ms/it)
  objective:  24808.0196415159
Minimizing 188    Time: 0:00:02 (13.61 ms/it)
  objective:  24810.622141936405
Minimizing 195    Time: 0:00:02 (13.71 ms/it)
  objective:  24764.74836706018
Minimizing 201    Time: 0:00:02 (13.81 ms/it)
  objective:  24750.864655709753
Minimizing 207    Time: 0:00:02 (13.90 ms/it)
  objective:  24728.7014244585
Minimizing 213    Time: 0:00:02 (13.98 ms/it)
  objective:  24721.802789535843
Minimizing 220    Time: 0:00:03 (14.05 ms/it)
  objective:  24724.978892060455
Minimizing 228    Time: 0:00:03 (14.03 ms/it)
  objective:  24714.559421284797
Minimizing 236    Time: 0:00:03 (13.99 ms/it)
  objective:  24713.749570295942
Minimizing 244    Time: 0:00:03 (13.95 ms/it)
  objective:  24703.141786459488
Minimizing 252    Time: 0:00:03 (13.93 ms/it)
  objective:  24706.525178828168
Minimizing 260    Time: 0:00:03 (13.94 ms/it)
  objective:  24696.13455573986
Minimizing 268    Time: 0:00:03 (13.92 ms/it)
  objective:  24691.657571354426
Minimizing 277    Time: 0:00:03 (13.88 ms/it)
  objective:  24685.654228629654
Minimizing 286    Time: 0:00:03 (13.83 ms/it)
  objective:  24682.51124245504
Minimizing 295    Time: 0:00:04 (13.79 ms/it)
  objective:  24681.05913327908
Minimizing 304    Time: 0:00:04 (13.75 ms/it)
  objective:  24676.468113148057
Minimizing 312    Time: 0:00:04 (13.72 ms/it)
  objective:  24678.73775724656
Minimizing 321    Time: 0:00:04 (13.68 ms/it)
  objective:  24673.49816406841
Minimizing 330    Time: 0:00:04 (13.65 ms/it)
  objective:  24671.722762394973
Minimizing 338    Time: 0:00:04 (13.66 ms/it)
  objective:  24666.188917121326
Minimizing 345    Time: 0:00:04 (13.68 ms/it)
  objective:  24664.77883152221
Minimizing 353    Time: 0:00:04 (13.66 ms/it)
  objective:  24659.4656714057
Minimizing 361    Time: 0:00:04 (13.64 ms/it)
  objective:  24661.552652523183
Minimizing 369    Time: 0:00:05 (13.62 ms/it)
  objective:  24657.54743509639
Minimizing 377    Time: 0:00:05 (13.60 ms/it)
  objective:  24657.906277135386
Minimizing 385    Time: 0:00:05 (13.58 ms/it)
  objective:  24657.22098196359
Minimizing 393    Time: 0:00:05 (13.58 ms/it)
  objective:  24654.084092197903
Minimizing 401    Time: 0:00:05 (13.56 ms/it)
  objective:  24654.660376842156
Minimizing 410    Time: 0:00:05 (13.53 ms/it)
  objective:  24653.05933991388
Minimizing 419    Time: 0:00:05 (13.51 ms/it)
  objective:  24652.690785417355
Minimizing 428    Time: 0:00:05 (13.48 ms/it)
  objective:  24651.576869207296
Minimizing 437    Time: 0:00:05 (13.45 ms/it)
  objective:  24651.345249844635
Minimizing 446    Time: 0:00:05 (13.42 ms/it)
  objective:  24650.935321003628
Minimizing 455    Time: 0:00:06 (13.39 ms/it)
  objective:  24650.460659691147
Minimizing 464    Time: 0:00:06 (13.37 ms/it)
  objective:  24650.033417605235
Minimizing 473    Time: 0:00:06 (13.35 ms/it)
  objective:  24649.881648448623
Minimizing 482    Time: 0:00:06 (13.33 ms/it)
  objective:  24649.617387416143
Minimizing 491    Time: 0:00:06 (13.31 ms/it)
  objective:  24649.54221767746
Minimizing 500    Time: 0:00:06 (13.29 ms/it)
  objective:  24649.053690507884
Minimizing 509    Time: 0:00:06 (13.27 ms/it)
  objective:  24648.905068218475
Minimizing 518    Time: 0:00:06 (13.25 ms/it)
  objective:  24648.68854571072
Minimizing 527    Time: 0:00:06 (13.23 ms/it)
  objective:  24648.58020652706
Minimizing 536    Time: 0:00:07 (13.21 ms/it)
  objective:  24648.4299572324
Minimizing 544    Time: 0:00:07 (13.20 ms/it)
  objective:  24648.359137537387
Minimizing 553    Time: 0:00:07 (13.19 ms/it)
  objective:  24648.121508962126
Minimizing 562    Time: 0:00:07 (13.17 ms/it)
  objective:  24648.099993862208
Minimizing 570    Time: 0:00:07 (13.17 ms/it)
  objective:  24648.006992328505
Minimizing 578    Time: 0:00:07 (13.17 ms/it)
  objective:  24647.966554206134
Minimizing 586    Time: 0:00:07 (13.16 ms/it)
  objective:  24647.839547408417
Minimizing 594    Time: 0:00:07 (13.16 ms/it)
  objective:  24647.748757753267
Minimizing 602    Time: 0:00:07 (13.16 ms/it)
  objective:  24647.703056529623
Minimizing 610    Time: 0:00:08 (13.16 ms/it)
  objective:  24647.65634691922
Minimizing 618    Time: 0:00:08 (13.16 ms/it)
  objective:  24647.56439257673
Minimizing 626    Time: 0:00:08 (13.17 ms/it)
  objective:  24647.50067749583
Minimizing 634    Time: 0:00:08 (13.18 ms/it)
  objective:  24647.459579058945
Minimizing 642    Time: 0:00:08 (13.18 ms/it)
  objective:  24647.47873341732
Minimizing 651    Time: 0:00:08 (13.16 ms/it)
  objective:  24647.343086450237
Minimizing 660    Time: 0:00:08 (13.15 ms/it)
  objective:  24647.34116898825
Minimizing 669    Time: 0:00:08 (13.14 ms/it)
  objective:  24647.348823056633
Minimizing 678    Time: 0:00:08 (13.14 ms/it)
  objective:  24647.27411314765
Minimizing 686    Time: 0:00:09 (13.13 ms/it)
  objective:  24647.250608569215
Minimizing 695    Time: 0:00:09 (13.12 ms/it)
  objective:  24647.22520161305
Minimizing 704    Time: 0:00:09 (13.11 ms/it)
  objective:  24647.23198462193
Minimizing 713    Time: 0:00:09 (13.10 ms/it)
  objective:  24647.200084946257
Minimizing 722    Time: 0:00:09 (13.08 ms/it)
  objective:  24647.209350541543
Minimizing 731    Time: 0:00:09 (13.07 ms/it)
  objective:  24647.150885420226
Minimizing 740    Time: 0:00:09 (13.06 ms/it)
  objective:  24647.129446947456
Minimizing 749    Time: 0:00:09 (13.06 ms/it)
  objective:  24647.125530564546
Minimizing 758    Time: 0:00:09 (13.05 ms/it)
  objective:  24647.13683106716
Minimizing 766    Time: 0:00:09 (13.05 ms/it)
  objective:  24647.091680123256
Minimizing 775    Time: 0:00:10 (13.04 ms/it)
  objective:  24647.098428585
Minimizing 783    Time: 0:00:10 (13.04 ms/it)
  objective:  24647.094389500824
Minimizing 791    Time: 0:00:10 (13.04 ms/it)
  objective:  24647.05192467993
Minimizing 799    Time: 0:00:10 (13.04 ms/it)
  objective:  24647.069433509034
Minimizing 807    Time: 0:00:10 (13.04 ms/it)
  objective:  24647.038241950948
Minimizing 815    Time: 0:00:10 (13.05 ms/it)
  objective:  24647.03569193548
Minimizing 823    Time: 0:00:10 (13.05 ms/it)
  objective:  24647.02367144438
Minimizing 831    Time: 0:00:10 (13.05 ms/it)
  objective:  24647.014044510084
Minimizing 839    Time: 0:00:10 (13.05 ms/it)
  objective:  24647.00941961279
Minimizing 847    Time: 0:00:11 (13.05 ms/it)
  objective:  24646.98532430834
Minimizing 856    Time: 0:00:11 (13.04 ms/it)
  objective:  24646.965197407808
Minimizing 864    Time: 0:00:11 (13.04 ms/it)
  objective:  24646.97000154094
Minimizing 872    Time: 0:00:11 (13.05 ms/it)
  objective:  24646.98178371837
Minimizing 880    Time: 0:00:11 (13.05 ms/it)
  objective:  24646.983776073634
Minimizing 889    Time: 0:00:11 (13.04 ms/it)
  objective:  24646.9319241572
Minimizing 897    Time: 0:00:11 (13.04 ms/it)
  objective:  24646.931978735825
Minimizing 906    Time: 0:00:11 (13.03 ms/it)
  objective:  24646.928020882224
Minimizing 915    Time: 0:00:11 (13.03 ms/it)
  objective:  24646.946012804347
Minimizing 923    Time: 0:00:12 (13.03 ms/it)
  objective:  24646.92061262158
Minimizing 931    Time: 0:00:12 (13.03 ms/it)
  objective:  24646.919364692974
Minimizing 940    Time: 0:00:12 (13.04 ms/it)
  objective:  24646.952962425272
Minimizing 948    Time: 0:00:12 (13.04 ms/it)
  objective:  24646.910649209145
Minimizing 956    Time: 0:00:12 (13.04 ms/it)
  objective:  24646.908075010928
Minimizing 964    Time: 0:00:12 (13.04 ms/it)
  objective:  24646.9254264908
Minimizing 973    Time: 0:00:12 (13.03 ms/it)
  objective:  24646.93194511519
Minimizing 982    Time: 0:00:12 (13.02 ms/it)
  objective:  24646.895063711723
Minimizing 991    Time: 0:00:12 (13.01 ms/it)
  objective:  24646.922305142616
Minimizing 1000    Time: 0:00:13 (13.00 ms/it)
  objective:  24646.891929413974
Minimizing 1009    Time: 0:00:13 (13.00 ms/it)
  objective:  24646.891099685534
Minimizing 1018    Time: 0:00:13 (12.99 ms/it)
  objective:  24646.889709339343
Minimizing 1027    Time: 0:00:13 (12.98 ms/it)
  objective:  24646.88810835629
Minimizing 1036    Time: 0:00:13 (12.97 ms/it)
  objective:  24646.887297493624
Minimizing 1045    Time: 0:00:13 (12.96 ms/it)
  objective:  24646.885784030797
Minimizing 1054    Time: 0:00:13 (12.96 ms/it)
  objective:  24646.885450896836
Minimizing 1063    Time: 0:00:13 (12.95 ms/it)
  objective:  24646.88351475452
Minimizing 1072    Time: 0:00:13 (12.94 ms/it)
  objective:  24646.88199866625
Minimizing 1081    Time: 0:00:13 (12.93 ms/it)
  objective:  24646.88095125399
Minimizing 1090    Time: 0:00:14 (12.92 ms/it)
  objective:  24646.878879374555
Minimizing 1099    Time: 0:00:14 (12.92 ms/it)
  objective:  24646.877898696042
Minimizing 1108    Time: 0:00:14 (12.91 ms/it)
  objective:  24646.87745016371
Minimizing 1117    Time: 0:00:14 (12.90 ms/it)
  objective:  24646.877039090396
Minimizing 1126    Time: 0:00:14 (12.90 ms/it)
  objective:  24646.87678163265
Minimizing 1134    Time: 0:00:14 (12.90 ms/it)
  objective:  24646.87620262606
Minimizing 1142    Time: 0:00:14 (12.90 ms/it)
  objective:  24646.875795879896
Minimizing 1150    Time: 0:00:14 (12.90 ms/it)
  objective:  24646.87474805087
Minimizing 1158    Time: 0:00:14 (12.91 ms/it)
  objective:  24646.874187797846
Minimizing 1166    Time: 0:00:15 (12.91 ms/it)
  objective:  24646.874226968095
Minimizing 1174    Time: 0:00:15 (12.91 ms/it)
  objective:  24646.873636962468
Minimizing 1182    Time: 0:00:15 (12.91 ms/it)
  objective:  24646.873134800753
Minimizing 1190    Time: 0:00:15 (12.91 ms/it)
  objective:  24646.873438121496
Minimizing 1199    Time: 0:00:15 (12.91 ms/it)
  objective:  24646.872948485317
Minimizing 1207    Time: 0:00:15 (12.91 ms/it)
  objective:  24646.8732539235
Minimizing 1215    Time: 0:00:15 (12.91 ms/it)
  objective:  24646.87300746512
Minimizing 1223    Time: 0:00:15 (12.91 ms/it)
  objective:  24646.872786788605
Minimizing 1231    Time: 0:00:15 (12.91 ms/it)
  objective:  24646.872757429453
Minimizing 1239    Time: 0:00:15 (12.91 ms/it)
  objective:  24646.872603076466
Minimizing 1247    Time: 0:00:16 (12.91 ms/it)
  objective:  24646.87241628748
Minimizing 1255    Time: 0:00:16 (12.91 ms/it)
  objective:  24646.872497083332
Minimizing 1264    Time: 0:00:16 (12.91 ms/it)
  objective:  24646.872561572494
Minimizing 1273    Time: 0:00:16 (12.91 ms/it)
  objective:  24646.87224029468
Minimizing 1281    Time: 0:00:16 (12.91 ms/it)
  objective:  24646.87251841221
Minimizing 1289    Time: 0:00:16 (12.91 ms/it)
  objective:  24646.872198901816
Minimizing 1297    Time: 0:00:16 (12.91 ms/it)
  objective:  24646.872169110415
Minimizing 1306    Time: 0:00:16 (12.91 ms/it)
  objective:  24646.872090365337
Minimizing 1314    Time: 0:00:16 (12.91 ms/it)
  objective:  24646.872070330082
Minimizing 1322    Time: 0:00:17 (12.92 ms/it)
  objective:  24646.872060506095
Minimizing 1330    Time: 0:00:17 (12.92 ms/it)
  objective:  24646.87204513132
Minimizing 1336    Time: 0:00:17 (12.95 ms/it)
  objective:  24646.87204792878
Minimizing 1343    Time: 0:00:17 (12.95 ms/it)
  objective:  24646.872012693733
Minimizing 1350    Time: 0:00:17 (12.97 ms/it)
  objective:  24646.871999364565
Minimizing 1356    Time: 0:00:17 (12.99 ms/it)
  objective:  24646.87199265028
Minimizing 1363    Time: 0:00:17 (13.00 ms/it)
  objective:  24646.871988545125
Minimizing 1370    Time: 0:00:17 (13.02 ms/it)
  objective:  24646.871980256794
Minimizing 1376    Time: 0:00:17 (13.04 ms/it)
  objective:  24646.871978006355
Minimizing 1384    Time: 0:00:18 (13.04 ms/it)
  objective:  24646.871966648752
Minimizing 1391    Time: 0:00:18 (13.06 ms/it)
  objective:  24646.87196321425
Minimizing 1398    Time: 0:00:18 (13.07 ms/it)
  objective:  24646.87195640274
Minimizing 1406    Time: 0:00:18 (13.07 ms/it)
  objective:  24646.87195198112
Minimizing 1414    Time: 0:00:18 (13.08 ms/it)
  objective:  24646.871947813554
Minimizing 1422    Time: 0:00:18 (13.08 ms/it)
  objective:  24646.871944653773
Minimizing 1429    Time: 0:00:18 (13.08 ms/it)
  objective:  24646.8719410536
Minimizing 1437    Time: 0:00:18 (13.09 ms/it)
  objective:  24646.871936481075
Minimizing 1444    Time: 0:00:18 (13.10 ms/it)
  objective:  24646.871933621453
Minimizing 1451    Time: 0:00:19 (13.10 ms/it)
  objective:  24646.871927196844
Minimizing 1459    Time: 0:00:19 (13.11 ms/it)
  objective:  24646.871925448948
Minimizing 1467    Time: 0:00:19 (13.12 ms/it)
  objective:  24646.871922590137
Minimizing 1475    Time: 0:00:19 (13.12 ms/it)
  objective:  24646.871922920815
Minimizing 1483    Time: 0:00:19 (13.12 ms/it)
  objective:  24646.871921975307
Minimizing 1491    Time: 0:00:19 (13.13 ms/it)
  objective:  24646.871918160934
Minimizing 1499    Time: 0:00:19 (13.13 ms/it)
  objective:  24646.87191685501
Minimizing 1507    Time: 0:00:19 (13.14 ms/it)
  objective:  24646.87191685694
Minimizing 1515    Time: 0:00:19 (13.14 ms/it)
  objective:  24646.871916002106
Minimizing 1523    Time: 0:00:20 (13.14 ms/it)
  objective:  24646.871913093604
Minimizing 1530    Time: 0:00:20 (13.15 ms/it)

Minimizing 1531    Time: 0:00:20 (13.15 ms/it)
  objective:  24646.871911983937</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="1">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td style="text-align: left;" data-quarto-table-cell-role="th"></td>
<td style="text-align: right;" data-quarto-table-cell-role="th">Est.</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">SE</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">z</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">p</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">σ_Child</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">σ_School</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">σ_Cohort</td>
</tr>
<tr class="even">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-0.0136</td>
<td style="text-align: right;">0.0195</td>
<td style="text-align: right;">-0.70</td>
<td style="text-align: right;">0.4844</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: Star_r</td>
<td style="text-align: right;">0.0093</td>
<td style="text-align: right;">0.0365</td>
<td style="text-align: right;">0.26</td>
<td style="text-align: right;">0.7986</td>
<td style="text-align: right;">0.7969</td>
<td style="text-align: right;">0.3103</td>
<td style="text-align: right;">0.0208</td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: S20_r</td>
<td style="text-align: right;">0.0060</td>
<td style="text-align: right;">0.0354</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">0.8653</td>
<td style="text-align: right;">0.7675</td>
<td style="text-align: right;">0.3305</td>
<td style="text-align: right;">0.0563</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: SLJ</td>
<td style="text-align: right;">0.0052</td>
<td style="text-align: right;">0.0339</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">0.8787</td>
<td style="text-align: right;">0.7803</td>
<td style="text-align: right;">0.2478</td>
<td style="text-align: right;">0.0156</td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: BMT</td>
<td style="text-align: right;">-0.0388</td>
<td style="text-align: right;">0.0300</td>
<td style="text-align: right;">-1.29</td>
<td style="text-align: right;">0.1967</td>
<td style="text-align: right;">0.6967</td>
<td style="text-align: right;">0.1969</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">a1</td>
<td style="text-align: right;">0.1935</td>
<td style="text-align: right;">0.0545</td>
<td style="text-align: right;">3.55</td>
<td style="text-align: right;">0.0004</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">0.2833</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Sex: Girls</td>
<td style="text-align: right;">-0.4290</td>
<td style="text-align: right;">0.0312</td>
<td style="text-align: right;">-13.75</td>
<td style="text-align: right;">&lt;1e-42</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">0.1434</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: Star_r &amp; a1</td>
<td style="text-align: right;">0.2932</td>
<td style="text-align: right;">0.0887</td>
<td style="text-align: right;">3.31</td>
<td style="text-align: right;">0.0009</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: S20_r &amp; a1</td>
<td style="text-align: right;">-0.1007</td>
<td style="text-align: right;">0.0826</td>
<td style="text-align: right;">-1.22</td>
<td style="text-align: right;">0.2228</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: SLJ &amp; a1</td>
<td style="text-align: right;">-0.0456</td>
<td style="text-align: right;">0.0773</td>
<td style="text-align: right;">-0.59</td>
<td style="text-align: right;">0.5549</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: BMT &amp; a1</td>
<td style="text-align: right;">0.4685</td>
<td style="text-align: right;">0.0853</td>
<td style="text-align: right;">5.50</td>
<td style="text-align: right;">&lt;1e-07</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: Star_r &amp; Sex: Girls</td>
<td style="text-align: right;">0.3759</td>
<td style="text-align: right;">0.0511</td>
<td style="text-align: right;">7.36</td>
<td style="text-align: right;">&lt;1e-12</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: S20_r &amp; Sex: Girls</td>
<td style="text-align: right;">-0.1892</td>
<td style="text-align: right;">0.0475</td>
<td style="text-align: right;">-3.98</td>
<td style="text-align: right;">&lt;1e-04</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: SLJ &amp; Sex: Girls</td>
<td style="text-align: right;">-0.0680</td>
<td style="text-align: right;">0.0445</td>
<td style="text-align: right;">-1.53</td>
<td style="text-align: right;">0.1262</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: BMT &amp; Sex: Girls</td>
<td style="text-align: right;">-0.2815</td>
<td style="text-align: right;">0.0495</td>
<td style="text-align: right;">-5.68</td>
<td style="text-align: right;">&lt;1e-07</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">a1 &amp; Sex: Girls</td>
<td style="text-align: right;">-0.1262</td>
<td style="text-align: right;">0.1049</td>
<td style="text-align: right;">-1.20</td>
<td style="text-align: right;">0.2290</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: Star_r &amp; a1 &amp; Sex: Girls</td>
<td style="text-align: right;">-0.1371</td>
<td style="text-align: right;">0.1756</td>
<td style="text-align: right;">-0.78</td>
<td style="text-align: right;">0.4348</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: S20_r &amp; a1 &amp; Sex: Girls</td>
<td style="text-align: right;">0.1720</td>
<td style="text-align: right;">0.1634</td>
<td style="text-align: right;">1.05</td>
<td style="text-align: right;">0.2926</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: SLJ &amp; a1 &amp; Sex: Girls</td>
<td style="text-align: right;">-0.0125</td>
<td style="text-align: right;">0.1529</td>
<td style="text-align: right;">-0.08</td>
<td style="text-align: right;">0.9348</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: BMT &amp; a1 &amp; Sex: Girls</td>
<td style="text-align: right;">0.1542</td>
<td style="text-align: right;">0.1702</td>
<td style="text-align: right;">0.91</td>
<td style="text-align: right;">0.3648</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: Run</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;">0.7498</td>
<td style="text-align: right;">0.3702</td>
<td style="text-align: right;">0.0548</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Residual</td>
<td style="text-align: right;">0.5122</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="70" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">issingular</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>true</code></pre>
</div>
</div>
<p>Depending on the random number generator seed, the model may or may not be supported in the alternative parameterization of scores. The fixed-effects profile is not affected (see 2.8 below).</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Caution
</div>
</div>
<div class="callout-body-container callout-body">
<p>RK: The order of RE terms is critical. In formula <code>f2</code> the <code>zerocorr()</code> term must be placed last as shown. If it is placed first, School-related and Child-related CPs are estimated/reported (?) as zero. This was not the case for formula <code>m1</code>. Thus, it appears to be related to the <code>0</code>-intercepts in School and Child terms. Need a reprex.</p>
</div>
</div>
<div id="72" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VarCorr</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td style="text-align: left;" data-quarto-table-cell-role="th"></td>
<td style="text-align: left;" data-quarto-table-cell-role="th">Column</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">Variance</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">Std.Dev</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">Corr.</td>
<td style="text-align: right;" data-quarto-table-cell-role="th"></td>
<td style="text-align: right;" data-quarto-table-cell-role="th"></td>
<td style="text-align: right;" data-quarto-table-cell-role="th"></td>
<td style="text-align: right;" data-quarto-table-cell-role="th"></td>
<td style="text-align: right;" data-quarto-table-cell-role="th"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Child</td>
<td style="text-align: left;">Test: Run</td>
<td style="text-align: right;">0.5622290</td>
<td style="text-align: right;">0.7498193</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: Star_r</td>
<td style="text-align: right;">0.6350899</td>
<td style="text-align: right;">0.7969253</td>
<td style="text-align: right;">+0.50</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: S20_r</td>
<td style="text-align: right;">0.5890796</td>
<td style="text-align: right;">0.7675152</td>
<td style="text-align: right;">+0.56</td>
<td style="text-align: right;">+0.64</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: SLJ</td>
<td style="text-align: right;">0.6089346</td>
<td style="text-align: right;">0.7803426</td>
<td style="text-align: right;">+0.55</td>
<td style="text-align: right;">+0.60</td>
<td style="text-align: right;">+0.72</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: BMT</td>
<td style="text-align: right;">0.4854398</td>
<td style="text-align: right;">0.6967351</td>
<td style="text-align: right;">+0.19</td>
<td style="text-align: right;">+0.40</td>
<td style="text-align: right;">+0.37</td>
<td style="text-align: right;">+0.49</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">School</td>
<td style="text-align: left;">Test: Run</td>
<td style="text-align: right;">0.1370455</td>
<td style="text-align: right;">0.3701965</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: Star_r</td>
<td style="text-align: right;">0.0962783</td>
<td style="text-align: right;">0.3102874</td>
<td style="text-align: right;">+0.53</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: S20_r</td>
<td style="text-align: right;">0.1092383</td>
<td style="text-align: right;">0.3305122</td>
<td style="text-align: right;">+0.47</td>
<td style="text-align: right;">+0.48</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: SLJ</td>
<td style="text-align: right;">0.0613838</td>
<td style="text-align: right;">0.2477575</td>
<td style="text-align: right;">+0.47</td>
<td style="text-align: right;">+0.76</td>
<td style="text-align: right;">+0.41</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: BMT</td>
<td style="text-align: right;">0.0387541</td>
<td style="text-align: right;">0.1968606</td>
<td style="text-align: right;">+0.15</td>
<td style="text-align: right;">+0.38</td>
<td style="text-align: right;">+0.18</td>
<td style="text-align: right;">+0.02</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">a1</td>
<td style="text-align: right;">0.0802336</td>
<td style="text-align: right;">0.2832554</td>
<td style="text-align: right;">+0.58</td>
<td style="text-align: right;">+0.47</td>
<td style="text-align: right;">+0.56</td>
<td style="text-align: right;">-0.05</td>
<td style="text-align: right;">+0.65</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Sex: Girls</td>
<td style="text-align: right;">0.0205546</td>
<td style="text-align: right;">0.1433686</td>
<td style="text-align: right;">-0.63</td>
<td style="text-align: right;">-0.27</td>
<td style="text-align: right;">+0.06</td>
<td style="text-align: right;">-0.28</td>
<td style="text-align: right;">-0.58</td>
<td style="text-align: right;">-0.37</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cohort</td>
<td style="text-align: left;">Test: Run</td>
<td style="text-align: right;">0.0030066</td>
<td style="text-align: right;">0.0548320</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: Star_r</td>
<td style="text-align: right;">0.0004344</td>
<td style="text-align: right;">0.0208416</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: S20_r</td>
<td style="text-align: right;">0.0031716</td>
<td style="text-align: right;">0.0563170</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: SLJ</td>
<td style="text-align: right;">0.0002448</td>
<td style="text-align: right;">0.0156459</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: BMT</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Residual</td>
<td style="text-align: left;"></td>
<td style="text-align: right;">0.2623127</td>
<td style="text-align: right;">0.5121647</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="principle-component-analysis-of-random-effect-structure-repca" class="level2" data-number="4.7">
<h2 data-number="4.7" class="anchored" data-anchor-id="principle-component-analysis-of-random-effect-structure-repca"><span class="header-section-number">4.7</span> Principle Component Analysis of Random Effect Structure (rePCA)</h2>
<p>The <code>ìssingular()</code> command is sort of a shortcut for a quick inspection of the principle components (PCs) of the variance-covariance matrix of the RES. With the <code>MixedModels.PCA()</code> command, we also obtain information about the amount of cumulative variance accounted for as we add PCs.</p>
<p>The output also provides PC loadings which may facilitate interpretation of the CP matrices (if estimated). This topic will be picked uo in a separate vignette. See also <span class="citation" data-cites="Fuehner2021">Fühner et al. (<a href="#ref-Fuehner2021" role="doc-biblioref">2021</a>)</span> for an application.</p>
</section>
<section id="effects-in-res" class="level2" data-number="4.8">
<h2 data-number="4.8" class="anchored" data-anchor-id="effects-in-res"><span class="header-section-number">4.8</span> Effects in RES</h2>
<p>For every random factor, <code>MixedModels.PCA()</code> extracts as many PCs as there are VCs. Therefore, the cumulation of variance across PCs within a random factor will always add up to 100% – at the latest with the last VC, but, in the case of overparameterized LMMs, the ceiling will be reached earlier. The final PCs are usually quite small.</p>
<p>PCs are extracted in the order of the amount of unique variance they account for. The first PC accounts for the largest and the final PC for the least amount of variance. The number the PCs with percent variance above a certain threshold indicates the number of weighted composites needed and reflects the dimensionality of the orthogonal space within which (almost) all the variance can be accounted for. The weights for forming composite scores are the listed loadings. For ease of interpretation it is often useful to change the sign of some composite scores.</p>
<p>The PCA for LMM <code>m1</code> shows that each of the five PCs for <code>Child</code> accounts for a non-zero percent of unique variance.</p>
<p>For <code>School</code> fewer than seven PCs have unique variance. The exact number depends on sampling. The overparameterization of <code>School</code> might be resolved when the CPs for <code>Sex</code> are dropped from the LMM.</p>
<p><code>Cohort</code> was estimated with CPs forced to zero. Therefore, the VCs were forced to be orthogonal; they already represent the PCA solution. However, depending on sampling, not all PCs may be identified for this random factor either.</p>
<p>Importantly, again depending on sampling, a non-singular fit does not imply that unique variance is associated with all PCs (i.e., not for last PC for <code>School</code>). Embrace uncertainty!</p>
<div id="74" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>MixedModels.<span class="fu">PCA</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>(Child = 
Principal components based on correlation matrix
 (Intercept)    1.0     .      .      .      .
 Test: Star_r   0.14   1.0     .      .      .
 Test: S20_r    0.0   -0.52   1.0     .      .
 Test: SLJ      0.05  -0.04  -0.35   1.0     .
 Test: BMT     -0.35   0.14  -0.18  -0.22   1.0

Normalized cumulative variances:
[0.3288, 0.616, 0.8285, 0.9371, 1.0]

Component loadings
                 PC1    PC2    PC3    PC4    PC5
 (Intercept)   -0.04   0.58   0.55  -0.6   -0.03
 Test: Star_r  -0.61  -0.04   0.45   0.4    0.51
 Test: S20_r    0.71  -0.02   0.15   0.03   0.69
 Test: SLJ     -0.28   0.44  -0.69  -0.21   0.46
 Test: BMT     -0.21  -0.69  -0.01  -0.66   0.22, School = 
Principal components based on correlation matrix
 (Intercept)    1.0     .      .      .      .      .      .
 Test: Star_r  -0.06   1.0     .      .      .      .      .
 Test: S20_r   -0.08  -0.39   1.0     .      .      .      .
 Test: SLJ     -0.19   0.21  -0.81   1.0     .      .      .
 Test: BMT     -0.33  -0.02   0.13  -0.38   1.0     .      .
 a1             0.62  -0.2    0.11  -0.61   0.45   1.0     .
 Sex: Girls    -0.45   0.45   0.31  -0.27  -0.15  -0.37   1.0

Normalized cumulative variances:
[0.3567, 0.6348, 0.8056, 0.9684, 0.9999, 1.0, 1.0]

Component loadings
                 PC1    PC2    PC3    PC4    PC5    PC6    PC7
 (Intercept)   -0.25  -0.49  -0.41  -0.37   0.19   0.52   0.27
 Test: Star_r   0.31   0.12   0.18  -0.75   0.47  -0.25  -0.09
 Test: S20_r   -0.4    0.44  -0.32   0.2    0.52  -0.28   0.4
 Test: SLJ      0.55  -0.31   0.1    0.2    0.02  -0.19   0.72
 Test: BMT     -0.29   0.14   0.79   0.01   0.16   0.42   0.27
 a1            -0.52  -0.27   0.16  -0.31  -0.42  -0.56   0.21
 Sex: Girls     0.14   0.6   -0.19  -0.34  -0.53   0.24   0.35, Cohort = 
Principal components based on correlation matrix
 (Intercept)   1.0  .    .    .    .
 Test: Star_r  0.0  1.0  .    .    .
 Test: S20_r   0.0  0.0  1.0  .    .
 Test: SLJ     0.0  0.0  0.0  1.0  .
 Test: BMT     0.0  0.0  0.0  0.0  0.0

Normalized cumulative variances:
[0.25, 0.5, 0.75, 1.0, 1.0]

Component loadings
                PC1   PC2   PC3   PC4     PC5
 (Intercept)   1.0   0.0   0.0   0.0     0.0
 Test: Star_r  0.0   1.0   0.0   0.0     0.0
 Test: S20_r   0.0   0.0   1.0   0.0     0.0
 Test: SLJ     0.0   0.0   0.0   1.0     0.0
 Test: BMT     0.0   0.0   0.0   0.0   NaN)</code></pre>
</div>
</div>
<section id="scores-in-res" class="level3" data-number="4.8.1">
<h3 data-number="4.8.1" class="anchored" data-anchor-id="scores-in-res"><span class="header-section-number">4.8.1</span> Scores in RES</h3>
<p>Now lets looks at the PCA results for the alternative parameterization of LMM <code>m2</code>. It is important to note that the reparameterization to base estimates of VCs and CPs on scores rather than effects applies only to the <code>Test</code> factor (i.e., the first factor in the formula); VCs for <code>Sex</code> and <code>age</code> refer to the associated effects.</p>
<p>Depending on sampling, the difference between LMM <code>m1</code> and LMM <code>m2</code> may show that overparameterization according to PCs may depend on the specification chosen for the other the random-effect structure.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>For the <em>complete</em> data, all PCs had unique variance associated with them.</p>
</div>
</div>
<div id="76" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>MixedModels.<span class="fu">PCA</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>(Child = 
Principal components based on correlation matrix
 Test: Run     1.0    .     .     .     .
 Test: Star_r  0.5   1.0    .     .     .
 Test: S20_r   0.56  0.64  1.0    .     .
 Test: SLJ     0.55  0.6   0.72  1.0    .
 Test: BMT     0.19  0.4   0.37  0.49  1.0

Normalized cumulative variances:
[0.6117, 0.7769, 0.8677, 0.9485, 1.0]

Component loadings
                 PC1    PC2    PC3    PC4    PC5
 Test: Run     -0.42   0.53   0.63   0.37   0.08
 Test: Star_r  -0.47   0.03  -0.65   0.58  -0.16
 Test: S20_r   -0.49   0.15  -0.24  -0.49   0.66
 Test: SLJ     -0.5   -0.05   0.09  -0.5   -0.7
 Test: BMT     -0.34  -0.83   0.33   0.2    0.2, School = 
Principal components based on correlation matrix
 Test: Run      1.0     .      .      .      .      .      .
 Test: Star_r   0.53   1.0     .      .      .      .      .
 Test: S20_r    0.47   0.48   1.0     .      .      .      .
 Test: SLJ      0.47   0.76   0.41   1.0     .      .      .
 Test: BMT      0.15   0.38   0.18   0.02   1.0     .      .
 a1             0.58   0.47   0.56  -0.05   0.65   1.0     .
 Sex: Girls    -0.63  -0.27   0.06  -0.28  -0.58  -0.37   1.0

Normalized cumulative variances:
[0.4822, 0.6938, 0.8508, 0.9553, 1.0, 1.0, 1.0]

Component loadings
                 PC1    PC2    PC3    PC4    PC5    PC6    PC7
 Test: Run     -0.44   0.08   0.15  -0.64  -0.16   0.41   0.42
 Test: Star_r  -0.44   0.28   0.02   0.41  -0.56   0.29  -0.4
 Test: S20_r   -0.34   0.27  -0.58  -0.1    0.6    0.15  -0.28
 Test: SLJ     -0.32   0.56   0.33   0.25   0.22  -0.48   0.36
 Test: BMT     -0.32  -0.53  -0.02   0.55   0.25   0.3    0.41
 a1            -0.41  -0.35  -0.42  -0.14  -0.33  -0.63   0.05
 Sex: Girls     0.34   0.35  -0.59   0.18  -0.29   0.14   0.53, Cohort = 
Principal components based on correlation matrix
 Test: Run     1.0  .    .    .    .
 Test: Star_r  0.0  1.0  .    .    .
 Test: S20_r   0.0  0.0  1.0  .    .
 Test: SLJ     0.0  0.0  0.0  1.0  .
 Test: BMT     0.0  0.0  0.0  0.0  0.0

Normalized cumulative variances:
[0.25, 0.5, 0.75, 1.0, 1.0]

Component loadings
                PC1   PC2   PC3   PC4     PC5
 Test: Run     0.0   0.0   1.0   0.0     0.0
 Test: Star_r  1.0   0.0   0.0   0.0     0.0
 Test: S20_r   0.0   1.0   0.0   0.0     0.0
 Test: SLJ     0.0   0.0   0.0   1.0     0.0
 Test: BMT     0.0   0.0   0.0   0.0   NaN)</code></pre>
</div>
</div>
</section>
</section>
<section id="summary-of-results-for-stratified-subset-of-data" class="level2" data-number="4.9">
<h2 data-number="4.9" class="anchored" data-anchor-id="summary-of-results-for-stratified-subset-of-data"><span class="header-section-number">4.9</span> Summary of results for stratified subset of data</h2>
<p>Returning to the theoretical focus of the article, the significant main effects of <code>age</code> and <code>Sex</code>, the interactions between <code>age</code> and c1 and c4 contrasts and the interactions between <code>Sex</code> and three test contrasts (c1, c2, c4) are replicated. Obviously, the subset of data is much noisier than the full set.</p>
</section>
</section>
<section id="age-x-sex-nested-in-levels-of-test" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> <code>Age x Sex</code> nested in levels of <code>Test</code></h1>
<p>In this final LMM, we test <em>post-hoc</em> five <code>age x Sex</code> interactions by nesting the interaction in the levels of <code>Test</code>. As this LMM <code>m2_nested</code> is a reparameterization of LMM <code>m2</code>.</p>
<div id="78" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>m2_nested <span class="op">=</span> <span class="kw">let</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  f <span class="op">=</span> <span class="pp">@formula</span>(</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>    zScore <span class="op">~</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>      <span class="fl">1</span> <span class="op">+</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>      <span class="bu">Test</span> <span class="op">+</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>      <span class="bu">Test</span> <span class="op">&amp;</span> (a1 <span class="op">*</span> Sex) <span class="op">+</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>      (<span class="fl">0</span> <span class="op">+</span> <span class="bu">Test</span> <span class="op">+</span> a1 <span class="op">+</span> Sex <span class="op">|</span> School) <span class="op">+</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>      (<span class="fl">0</span> <span class="op">+</span> <span class="bu">Test</span> <span class="op">|</span> Child) <span class="op">+</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">zerocorr</span>(<span class="fl">0</span> <span class="op">+</span> <span class="bu">Test</span> <span class="op">|</span> Cohort)</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(MixedModel, f, dat; contrasts)</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Minimizing 8    Time: 0:00:00 (13.70 ms/it)
  objective:  26540.628428689935
Minimizing 16    Time: 0:00:00 (13.64 ms/it)
  objective:  27013.20266803618
Minimizing 24    Time: 0:00:00 (13.30 ms/it)
  objective:  26938.094323301608
Minimizing 32    Time: 0:00:00 (13.17 ms/it)
  objective:  26816.3549662712
Minimizing 40    Time: 0:00:00 (13.11 ms/it)
  objective:  26764.50301863997
Minimizing 48    Time: 0:00:00 (13.04 ms/it)
  objective:  26748.52532251481
Minimizing 56    Time: 0:00:00 (13.00 ms/it)
  objective:  27607.74073471175
Minimizing 64    Time: 0:00:00 (12.99 ms/it)
  objective:  27035.518325217672
Minimizing 72    Time: 0:00:00 (12.99 ms/it)
  objective:  26743.04860536076
Minimizing 80    Time: 0:00:01 (13.00 ms/it)
  objective:  26914.37946666574
Minimizing 88    Time: 0:00:01 (13.00 ms/it)
  objective:  26750.53281469535
Minimizing 96    Time: 0:00:01 (13.01 ms/it)
  objective:  26718.60071956578
Minimizing 104    Time: 0:00:01 (13.02 ms/it)
  objective:  25121.98047503751
Minimizing 112    Time: 0:00:01 (13.03 ms/it)
  objective:  25011.13301114361
Minimizing 120    Time: 0:00:01 (13.04 ms/it)
  objective:  24997.24925764848
Minimizing 128    Time: 0:00:01 (13.04 ms/it)
  objective:  24953.65373233215
Minimizing 136    Time: 0:00:01 (13.04 ms/it)
  objective:  24958.120022841867
Minimizing 144    Time: 0:00:01 (13.03 ms/it)
  objective:  24900.66839637635
Minimizing 152    Time: 0:00:01 (13.03 ms/it)
  objective:  24893.96206104777
Minimizing 160    Time: 0:00:02 (13.03 ms/it)
  objective:  24873.63692651054
Minimizing 168    Time: 0:00:02 (13.03 ms/it)
  objective:  24859.80007224154
Minimizing 176    Time: 0:00:02 (13.03 ms/it)
  objective:  24821.00416416074
Minimizing 184    Time: 0:00:02 (13.02 ms/it)
  objective:  24798.88989693187
Minimizing 192    Time: 0:00:02 (13.03 ms/it)
  objective:  24766.536560173186
Minimizing 200    Time: 0:00:02 (13.09 ms/it)
  objective:  24761.12632180778
Minimizing 208    Time: 0:00:02 (13.08 ms/it)
  objective:  24724.779616583975
Minimizing 216    Time: 0:00:02 (13.08 ms/it)
  objective:  24724.49577912816
Minimizing 224    Time: 0:00:02 (13.08 ms/it)
  objective:  24715.333118629766
Minimizing 232    Time: 0:00:03 (13.08 ms/it)
  objective:  24719.605256362156
Minimizing 240    Time: 0:00:03 (13.07 ms/it)
  objective:  24711.563183426377
Minimizing 248    Time: 0:00:03 (13.06 ms/it)
  objective:  24704.355886249505
Minimizing 256    Time: 0:00:03 (13.04 ms/it)
  objective:  24698.8869058769
Minimizing 264    Time: 0:00:03 (13.03 ms/it)
  objective:  24691.48588894165
Minimizing 272    Time: 0:00:03 (13.02 ms/it)
  objective:  24687.055840617446
Minimizing 280    Time: 0:00:03 (13.01 ms/it)
  objective:  24686.841979619934
Minimizing 288    Time: 0:00:03 (13.00 ms/it)
  objective:  24689.10334812927
Minimizing 296    Time: 0:00:03 (13.00 ms/it)
  objective:  24686.91689329679
Minimizing 304    Time: 0:00:03 (12.99 ms/it)
  objective:  24679.277504378595
Minimizing 312    Time: 0:00:04 (12.99 ms/it)
  objective:  24674.37908345073
Minimizing 320    Time: 0:00:04 (13.00 ms/it)
  objective:  24673.037400233883
Minimizing 328    Time: 0:00:04 (13.00 ms/it)
  objective:  24665.151187408235
Minimizing 336    Time: 0:00:04 (12.99 ms/it)
  objective:  24665.56628719779
Minimizing 344    Time: 0:00:04 (12.98 ms/it)
  objective:  24663.666240292307
Minimizing 352    Time: 0:00:04 (12.98 ms/it)
  objective:  24660.144044891324
Minimizing 360    Time: 0:00:04 (12.97 ms/it)
  objective:  24656.98099205523
Minimizing 368    Time: 0:00:04 (12.96 ms/it)
  objective:  24657.25658119654
Minimizing 376    Time: 0:00:04 (12.96 ms/it)
  objective:  24655.730669618533
Minimizing 384    Time: 0:00:04 (12.97 ms/it)
  objective:  24655.69430533625
Minimizing 392    Time: 0:00:05 (12.98 ms/it)
  objective:  24654.44310560729
Minimizing 400    Time: 0:00:05 (12.99 ms/it)
  objective:  24653.219229949507
Minimizing 408    Time: 0:00:05 (13.00 ms/it)
  objective:  24652.796781257577
Minimizing 416    Time: 0:00:05 (13.01 ms/it)
  objective:  24652.338978753978
Minimizing 424    Time: 0:00:05 (13.02 ms/it)
  objective:  24651.634776007268
Minimizing 432    Time: 0:00:05 (13.02 ms/it)
  objective:  24651.28876234426
Minimizing 440    Time: 0:00:05 (13.04 ms/it)
  objective:  24651.142181131778
Minimizing 448    Time: 0:00:05 (13.04 ms/it)
  objective:  24650.645188828414
Minimizing 456    Time: 0:00:05 (13.06 ms/it)
  objective:  24649.9503876729
Minimizing 464    Time: 0:00:06 (13.07 ms/it)
  objective:  24649.431921117473
Minimizing 472    Time: 0:00:06 (13.08 ms/it)
  objective:  24649.263203381008
Minimizing 480    Time: 0:00:06 (13.08 ms/it)
  objective:  24649.182140293356
Minimizing 488    Time: 0:00:06 (13.08 ms/it)
  objective:  24649.076840932066
Minimizing 496    Time: 0:00:06 (13.08 ms/it)
  objective:  24648.86837610833
Minimizing 504    Time: 0:00:06 (13.08 ms/it)
  objective:  24648.66301915268
Minimizing 512    Time: 0:00:06 (13.09 ms/it)
  objective:  24648.46906034212
Minimizing 520    Time: 0:00:06 (13.10 ms/it)
  objective:  24648.40844853464
Minimizing 527    Time: 0:00:06 (13.13 ms/it)
  objective:  24648.324979985635
Minimizing 534    Time: 0:00:07 (13.14 ms/it)
  objective:  24648.227736776775
Minimizing 542    Time: 0:00:07 (13.14 ms/it)
  objective:  24648.0698415218
Minimizing 551    Time: 0:00:07 (13.13 ms/it)
  objective:  24647.96157394349
Minimizing 560    Time: 0:00:07 (13.12 ms/it)
  objective:  24647.81291490624
Minimizing 569    Time: 0:00:07 (13.10 ms/it)
  objective:  24647.821741951735
Minimizing 578    Time: 0:00:07 (13.09 ms/it)
  objective:  24647.70521181008
Minimizing 586    Time: 0:00:07 (13.09 ms/it)
  objective:  24647.621294995508
Minimizing 594    Time: 0:00:07 (13.08 ms/it)
  objective:  24647.523956625257
Minimizing 602    Time: 0:00:07 (13.08 ms/it)
  objective:  24647.432574352344
Minimizing 610    Time: 0:00:07 (13.09 ms/it)
  objective:  24647.417512320426
Minimizing 617    Time: 0:00:08 (13.10 ms/it)
  objective:  24647.341430766
Minimizing 624    Time: 0:00:08 (13.12 ms/it)
  objective:  24647.28424499031
Minimizing 631    Time: 0:00:08 (13.14 ms/it)
  objective:  24647.319589671955
Minimizing 638    Time: 0:00:08 (13.17 ms/it)
  objective:  24647.294944454985
Minimizing 645    Time: 0:00:08 (13.18 ms/it)
  objective:  24647.20468054565
Minimizing 653    Time: 0:00:08 (13.20 ms/it)
  objective:  24647.136963121862
Minimizing 659    Time: 0:00:08 (13.27 ms/it)
  objective:  24647.111462800207
Minimizing 666    Time: 0:00:08 (13.31 ms/it)
  objective:  24647.087755084372
Minimizing 673    Time: 0:00:08 (13.33 ms/it)
  objective:  24647.09819673813
Minimizing 680    Time: 0:00:09 (13.36 ms/it)
  objective:  24647.07095995461
Minimizing 687    Time: 0:00:09 (13.38 ms/it)
  objective:  24647.05393722359
Minimizing 694    Time: 0:00:09 (13.41 ms/it)
  objective:  24647.03777228371
Minimizing 702    Time: 0:00:09 (13.41 ms/it)
  objective:  24647.024951772564
Minimizing 710    Time: 0:00:09 (13.41 ms/it)
  objective:  24647.003427057458
Minimizing 718    Time: 0:00:09 (13.41 ms/it)
  objective:  24646.99498896721
Minimizing 726    Time: 0:00:09 (13.40 ms/it)
  objective:  24646.990730607544
Minimizing 734    Time: 0:00:09 (13.40 ms/it)
  objective:  24646.97906190287
Minimizing 742    Time: 0:00:09 (13.40 ms/it)
  objective:  24646.975885698288
Minimizing 749    Time: 0:00:10 (13.43 ms/it)
  objective:  24646.972542464464
Minimizing 756    Time: 0:00:10 (13.44 ms/it)
  objective:  24646.968502912674
Minimizing 764    Time: 0:00:10 (13.43 ms/it)
  objective:  24646.962831158467
Minimizing 772    Time: 0:00:10 (13.43 ms/it)
  objective:  24646.958674438207
Minimizing 780    Time: 0:00:10 (13.43 ms/it)
  objective:  24646.955826234305
Minimizing 788    Time: 0:00:10 (13.43 ms/it)
  objective:  24646.953060155472
Minimizing 796    Time: 0:00:10 (13.42 ms/it)
  objective:  24646.9521054153
Minimizing 804    Time: 0:00:10 (13.42 ms/it)
  objective:  24646.948478094586
Minimizing 812    Time: 0:00:10 (13.42 ms/it)
  objective:  24646.944019135743
Minimizing 820    Time: 0:00:11 (13.42 ms/it)
  objective:  24646.938953934987
Minimizing 828    Time: 0:00:11 (13.43 ms/it)
  objective:  24646.93645979881
Minimizing 836    Time: 0:00:11 (13.43 ms/it)
  objective:  24646.933609880332
Minimizing 843    Time: 0:00:11 (13.47 ms/it)
  objective:  24646.932514518587
Minimizing 849    Time: 0:00:11 (13.52 ms/it)
  objective:  24646.929970979138
Minimizing 855    Time: 0:00:11 (13.55 ms/it)
  objective:  24646.92748526191
Minimizing 863    Time: 0:00:11 (13.55 ms/it)
  objective:  24646.925214377407
Minimizing 871    Time: 0:00:11 (13.55 ms/it)
  objective:  24646.920939489395
Minimizing 878    Time: 0:00:11 (13.57 ms/it)
  objective:  24646.918463218877
Minimizing 885    Time: 0:00:12 (13.58 ms/it)
  objective:  24646.916193014382
Minimizing 892    Time: 0:00:12 (13.60 ms/it)
  objective:  24646.913466439146
Minimizing 900    Time: 0:00:12 (13.60 ms/it)
  objective:  24646.911044916513
Minimizing 909    Time: 0:00:12 (13.59 ms/it)
  objective:  24646.907532175603
Minimizing 917    Time: 0:00:12 (13.58 ms/it)
  objective:  24646.90240499966
Minimizing 925    Time: 0:00:12 (13.57 ms/it)
  objective:  24646.900343604117
Minimizing 934    Time: 0:00:12 (13.56 ms/it)
  objective:  24646.898298083204
Minimizing 942    Time: 0:00:12 (13.56 ms/it)
  objective:  24646.899863259383
Minimizing 950    Time: 0:00:12 (13.55 ms/it)
  objective:  24646.894943659114
Minimizing 958    Time: 0:00:12 (13.55 ms/it)
  objective:  24646.89168722892
Minimizing 966    Time: 0:00:13 (13.55 ms/it)
  objective:  24646.891871020714
Minimizing 974    Time: 0:00:13 (13.56 ms/it)
  objective:  24646.888629902307
Minimizing 982    Time: 0:00:13 (13.56 ms/it)
  objective:  24646.88626510772
Minimizing 990    Time: 0:00:13 (13.56 ms/it)
  objective:  24646.88553929728
Minimizing 998    Time: 0:00:13 (13.57 ms/it)
  objective:  24646.88299185763
Minimizing 1006    Time: 0:00:13 (13.56 ms/it)
  objective:  24646.88143965367
Minimizing 1014    Time: 0:00:13 (13.57 ms/it)
  objective:  24646.88048005483
Minimizing 1022    Time: 0:00:13 (13.57 ms/it)
  objective:  24646.87982841355
Minimizing 1030    Time: 0:00:13 (13.57 ms/it)
  objective:  24646.879231505678
Minimizing 1038    Time: 0:00:14 (13.57 ms/it)
  objective:  24646.87890762983
Minimizing 1046    Time: 0:00:14 (13.57 ms/it)
  objective:  24646.877528120545
Minimizing 1054    Time: 0:00:14 (13.57 ms/it)
  objective:  24646.876792163104
Minimizing 1062    Time: 0:00:14 (13.57 ms/it)
  objective:  24646.876315545996
Minimizing 1070    Time: 0:00:14 (13.58 ms/it)
  objective:  24646.87562600356
Minimizing 1078    Time: 0:00:14 (13.58 ms/it)
  objective:  24646.875434427
Minimizing 1086    Time: 0:00:14 (13.58 ms/it)
  objective:  24646.87526486469
Minimizing 1088    Time: 0:00:14 (13.58 ms/it)

Minimizing 1089    Time: 0:00:14 (13.58 ms/it)
  objective:  24646.875245743373</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="1">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td style="text-align: left;" data-quarto-table-cell-role="th"></td>
<td style="text-align: right;" data-quarto-table-cell-role="th">Est.</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">SE</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">z</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">p</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">σ_Child</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">σ_School</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">σ_Cohort</td>
</tr>
<tr class="even">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-0.0136</td>
<td style="text-align: right;">0.0195</td>
<td style="text-align: right;">-0.70</td>
<td style="text-align: right;">0.4840</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: Star_r</td>
<td style="text-align: right;">0.0093</td>
<td style="text-align: right;">0.0366</td>
<td style="text-align: right;">0.26</td>
<td style="text-align: right;">0.7984</td>
<td style="text-align: right;">0.7977</td>
<td style="text-align: right;">0.3103</td>
<td style="text-align: right;">0.0213</td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: S20_r</td>
<td style="text-align: right;">0.0060</td>
<td style="text-align: right;">0.0354</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">0.8657</td>
<td style="text-align: right;">0.7683</td>
<td style="text-align: right;">0.3307</td>
<td style="text-align: right;">0.0563</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: SLJ</td>
<td style="text-align: right;">0.0052</td>
<td style="text-align: right;">0.0339</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">0.8781</td>
<td style="text-align: right;">0.7811</td>
<td style="text-align: right;">0.2479</td>
<td style="text-align: right;">0.0157</td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: BMT</td>
<td style="text-align: right;">-0.0388</td>
<td style="text-align: right;">0.0300</td>
<td style="text-align: right;">-1.29</td>
<td style="text-align: right;">0.1970</td>
<td style="text-align: right;">0.6978</td>
<td style="text-align: right;">0.1967</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: Run &amp; a1</td>
<td style="text-align: right;">-0.0560</td>
<td style="text-align: right;">0.0783</td>
<td style="text-align: right;">-0.72</td>
<td style="text-align: right;">0.4745</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: Star_r &amp; a1</td>
<td style="text-align: right;">0.2372</td>
<td style="text-align: right;">0.0801</td>
<td style="text-align: right;">2.96</td>
<td style="text-align: right;">0.0031</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: S20_r &amp; a1</td>
<td style="text-align: right;">0.1365</td>
<td style="text-align: right;">0.0786</td>
<td style="text-align: right;">1.74</td>
<td style="text-align: right;">0.0823</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: SLJ &amp; a1</td>
<td style="text-align: right;">0.0908</td>
<td style="text-align: right;">0.0774</td>
<td style="text-align: right;">1.17</td>
<td style="text-align: right;">0.2405</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: BMT &amp; a1</td>
<td style="text-align: right;">0.5593</td>
<td style="text-align: right;">0.0716</td>
<td style="text-align: right;">7.81</td>
<td style="text-align: right;">&lt;1e-14</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: Run &amp; Sex: Girls</td>
<td style="text-align: right;">-0.5327</td>
<td style="text-align: right;">0.0448</td>
<td style="text-align: right;">-11.90</td>
<td style="text-align: right;">&lt;1e-31</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: Star_r &amp; Sex: Girls</td>
<td style="text-align: right;">-0.1569</td>
<td style="text-align: right;">0.0461</td>
<td style="text-align: right;">-3.40</td>
<td style="text-align: right;">0.0007</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: S20_r &amp; Sex: Girls</td>
<td style="text-align: right;">-0.3460</td>
<td style="text-align: right;">0.0449</td>
<td style="text-align: right;">-7.70</td>
<td style="text-align: right;">&lt;1e-13</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: SLJ &amp; Sex: Girls</td>
<td style="text-align: right;">-0.4140</td>
<td style="text-align: right;">0.0447</td>
<td style="text-align: right;">-9.26</td>
<td style="text-align: right;">&lt;1e-19</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: BMT &amp; Sex: Girls</td>
<td style="text-align: right;">-0.6955</td>
<td style="text-align: right;">0.0414</td>
<td style="text-align: right;">-16.80</td>
<td style="text-align: right;">&lt;1e-62</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: Run &amp; a1 &amp; Sex: Girls</td>
<td style="text-align: right;">-0.1456</td>
<td style="text-align: right;">0.1523</td>
<td style="text-align: right;">-0.96</td>
<td style="text-align: right;">0.3393</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: Star_r &amp; a1 &amp; Sex: Girls</td>
<td style="text-align: right;">-0.2826</td>
<td style="text-align: right;">0.1572</td>
<td style="text-align: right;">-1.80</td>
<td style="text-align: right;">0.0723</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: S20_r &amp; a1 &amp; Sex: Girls</td>
<td style="text-align: right;">-0.1106</td>
<td style="text-align: right;">0.1530</td>
<td style="text-align: right;">-0.72</td>
<td style="text-align: right;">0.4696</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: SLJ &amp; a1 &amp; Sex: Girls</td>
<td style="text-align: right;">-0.1231</td>
<td style="text-align: right;">0.1516</td>
<td style="text-align: right;">-0.81</td>
<td style="text-align: right;">0.4168</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: BMT &amp; a1 &amp; Sex: Girls</td>
<td style="text-align: right;">0.0311</td>
<td style="text-align: right;">0.1404</td>
<td style="text-align: right;">0.22</td>
<td style="text-align: right;">0.8246</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">a1</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;">0.2847</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sex: Girls</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;">0.1431</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: Run</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;">0.7506</td>
<td style="text-align: right;">0.3703</td>
<td style="text-align: right;">0.0548</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Residual</td>
<td style="text-align: right;">0.5109</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The results show that none of the interactions in the panels of <a href="#fig-agetrendssamp" class="quarto-xref">Figure&nbsp;2</a> is significant. The size and direction of interaction effects correspond with what is shown in <a href="#fig-agetrendssamp" class="quarto-xref">Figure&nbsp;2</a>.</p>
<section id="construction-site-more-model-comparisons" class="level3" data-number="5.0.1">
<h3 data-number="5.0.1" class="anchored" data-anchor-id="construction-site-more-model-comparisons"><span class="header-section-number">5.0.1</span> CONSTRUCTION SITE: More model comparisons</h3>
<div id="80" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>gof_summary3 <span class="op">=</span> <span class="kw">let</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  nms <span class="op">=</span> [<span class="op">:</span>m1, <span class="op">:</span>m2, <span class="op">:</span>m2_nested]</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  mods <span class="op">=</span> <span class="fu">eval</span>.(nms)</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">DataFrame</span>(;</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>    name<span class="op">=</span>nms,</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>    dof<span class="op">=</span><span class="fu">dof</span>.(mods),</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>    deviance<span class="op">=</span><span class="fu">deviance</span>.(mods),</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>    AIC<span class="op">=</span><span class="fu">aic</span>.(mods),</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>    AICc<span class="op">=</span><span class="fu">aicc</span>.(mods),</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>    BIC<span class="op">=</span><span class="fu">bic</span>.(mods),</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>3×6 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">name</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">dof</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">deviance</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">AIC</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">AICc</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">BIC</th>
</tr>
<tr class="odd subheader headerLastRow">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Symbol">Symbol</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">m1</td>
<td style="text-align: right;">69</td>
<td style="text-align: right;">24651.0</td>
<td style="text-align: right;">24789.0</td>
<td style="text-align: right;">24790.0</td>
<td style="text-align: right;">25284.2</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">m2</td>
<td style="text-align: right;">69</td>
<td style="text-align: right;">24646.9</td>
<td style="text-align: right;">24784.9</td>
<td style="text-align: right;">24785.9</td>
<td style="text-align: right;">25280.0</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: left;">m2_nested</td>
<td style="text-align: right;">69</td>
<td style="text-align: right;">24646.9</td>
<td style="text-align: right;">24784.9</td>
<td style="text-align: right;">24785.9</td>
<td style="text-align: right;">25280.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="82" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>n, p, q, k <span class="op">=</span> <span class="fu">size</span>(m1)  <span class="co"># nobs, fe params, VCs+CPs, re terms</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>(9663, 20, 13076, 3)</code></pre>
</div>
</div>
<p>In principle, the models should yield the save deviance. When models are not supported by the data, that is for singular models, there may be small differences between deviances for these reparameterizations. During optimization such models search for the absolute minimum in a very shallow surface and may end up in a local minimum instead.</p>
</section>
<section id="geometric-degrees-of-freedom" class="level3" data-number="5.0.2">
<h3 data-number="5.0.2" class="anchored" data-anchor-id="geometric-degrees-of-freedom"><span class="header-section-number">5.0.2</span> Geometric degrees of freedom</h3>
<p>From MixedModels documentation: “The sum of the leverage values is the rank of the model matrix and <code>n - sum(leverage(m))</code> is the degrees of freedom for residuals. The sum of the leverage values is also the trace of the so-called”hat” matrix<code>H</code>.”</p>
<p>New term: <em>geometric degrees of freedom</em>.</p>
<div id="84" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>m1_geomdf <span class="op">=</span> <span class="fu">sum</span>(<span class="fu">leverage</span>(m1))  <span class="co"># geom_dof</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>5442.453779672519</code></pre>
</div>
</div>
<div id="86" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">leverage</span>(m2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>5764.6241405763985</code></pre>
</div>
</div>
<div id="88" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">leverage</span>(m2_nested))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>5784.56392159439</code></pre>
</div>
</div>
<div id="90" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>n <span class="op">-</span> m1_geomdf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>4220.546220327481</code></pre>
</div>
</div>
<div id="92" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>m1.feterm.rank</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>20</code></pre>
</div>
</div>
<div id="94" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dof</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>69</code></pre>
</div>
</div>
</section>
</section>
<section id="glossary-of-mixedmodels.jl-commands" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Glossary of <em>MixedModels.jl</em> commands</h1>
<p>Here we introduce most of the commands available in the <em>MixedModels.jl</em> package that allow the immediate inspection and analysis of results returned in a fitted <em>linear</em> mixed-effect model.</p>
<p>Postprocessing related to conditional modes will be dealt with in a different tutorial.</p>
<section id="overall-summary-statistics" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="overall-summary-statistics"><span class="header-section-number">6.1</span> Overall summary statistics</h2>
<pre><code>+ julia&gt; m1.optsum         # MixedModels.OptSummary:  gets all info
+ julia&gt; loglikelihood(m1) # StatsBase.loglikelihood: return loglikelihood
                             of the model
+ julia&gt; deviance(m1)      # StatsBase.deviance: negative twice the log-likelihood
                             relative to saturated model
+ julia&gt; objective(m1)     # MixedModels.objective: saturated model not clear:
                             negative twice the log-likelihood
+ julia&gt; nobs(m1)          # n of observations; they are not independent
+ julia&gt; dof(m1)           # n of degrees of freedom is number of model parameters
+ julia&gt; aic(m1)           # objective(m1) + 2*dof(m1)
+ julia&gt; bic(m1)           # objective(m1) + dof(m1)*log(nobs(m1))</code></pre>
<div id="96" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>m1.optsum            <span class="co"># MixedModels.OptSummary:  gets all info</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td style="text-align: left;" data-quarto-table-cell-role="th"></td>
<td style="text-align: left;" data-quarto-table-cell-role="th"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Initialization</strong></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Initial parameter vector</td>
<td style="text-align: left;">[1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]</td>
</tr>
<tr class="even">
<td style="text-align: left;">Initial objective value</td>
<td style="text-align: left;">25840.653755409803</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Optimizer settings</strong></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Optimizer (from NLopt)</td>
<td style="text-align: left;"><code>LN_BOBYQA</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Lower bounds</td>
<td style="text-align: left;">[0.0, -Inf, -Inf, -Inf, -Inf, 0.0, -Inf, -Inf, -Inf, 0.0, -Inf, -Inf, 0.0, -Inf, 0.0, 0.0, -Inf, -Inf, -Inf, -Inf, -Inf, -Inf, 0.0, -Inf, -Inf, -Inf, -Inf, -Inf, 0.0, -Inf, -Inf, -Inf, -Inf, 0.0, -Inf, -Inf, -Inf, 0.0, -Inf, -Inf, 0.0, -Inf, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>ftol_rel</code></td>
<td style="text-align: left;">1.0e-12</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>ftol_abs</code></td>
<td style="text-align: left;">1.0e-8</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>xtol_rel</code></td>
<td style="text-align: left;">0.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>xtol_abs</code></td>
<td style="text-align: left;">[1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10]</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>initial_step</code></td>
<td style="text-align: left;">[0.75, 1.0, 1.0, 1.0, 1.0, 0.75, 1.0, 1.0, 1.0, 0.75, 1.0, 1.0, 0.75, 1.0, 0.75, 0.75, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.75, 1.0, 1.0, 1.0, 1.0, 1.0, 0.75, 1.0, 1.0, 1.0, 1.0, 0.75, 1.0, 1.0, 1.0, 0.75, 1.0, 1.0, 0.75, 1.0, 0.75, 0.75, 0.75, 0.75, 0.75, 0.75]</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>maxfeval</code></td>
<td style="text-align: left;">-1</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>maxtime</code></td>
<td style="text-align: left;">-1.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Result</strong></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Function evaluations</td>
<td style="text-align: left;">1877</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Final parameter vector</td>
<td style="text-align: left;">[1.1017, 0.1998, 0.0008, 0.0492, -0.4673, 1.3801, -0.627, -0.0493, 0.2525, 1.0108, -0.4543, -0.1363, 0.907, -0.3692, 1.1806, 0.401, -0.0372, -0.0463, -0.1124, -0.1955, 0.3284, -0.1207, 0.6232, -0.2454, 0.121, -0.0246, -0.0876, 0.1131, 0.5624, -0.4873, 0.0578, 0.051, 0.1313, 0.3136, -0.404, -0.3872, -0.0241, 0.3732, 0.1119, -0.165, 0.0177, -0.0054, 0.0, 0.0248, 0.1196, 0.0142, 0.0636, 0.0]</td>
</tr>
<tr class="even">
<td style="text-align: left;">Final objective value</td>
<td style="text-align: left;">24651.014</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Return code</td>
<td style="text-align: left;"><code>FTOL_REACHED</code></td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="98" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">loglikelihood</span>(m1) <span class="co"># StatsBase.loglikelihood: return loglikelihood of the model</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-12325.507018394583</code></pre>
</div>
</div>
<div id="100" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">deviance</span>(m1)      <span class="co"># StatsBase.deviance: negative twice the log-likelihood relative to saturated mode`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>24651.014036789165</code></pre>
</div>
</div>
<div id="102" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">objective</span>(m1)    <span class="co"># MixedModels.objective: saturated model not clear: negative twice the log-likelihood</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>24651.014036789165</code></pre>
</div>
</div>
<div id="104" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nobs</span>(m1) <span class="co"># n of observations; they are not independent</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>9663</code></pre>
</div>
</div>
<div id="106" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>n_, p_, q_, k_ <span class="op">=</span> <span class="fu">size</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>(9663, 20, 13076, 3)</code></pre>
</div>
</div>
<div id="108" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dof</span>(m1)  <span class="co"># n of degrees of freedom is number of model parameters</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>69</code></pre>
</div>
</div>
<div id="110" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>geom_df <span class="op">=</span> <span class="fu">sum</span>(<span class="fu">leverage</span>(m1)) <span class="co"># trace of hat / rank of model matrix / geom dof</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>5442.453779672519</code></pre>
</div>
</div>
<div id="112" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>resid_df <span class="op">=</span> <span class="fu">nobs</span>(m1) <span class="op">-</span> geom_df  <span class="co"># eff. residual degrees of freedom</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>4220.546220327481</code></pre>
</div>
</div>
<div id="114" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aic</span>(m1)  <span class="co"># objective(m1) + 2*dof(m1)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>24789.014036789165</code></pre>
</div>
</div>
<div id="116" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bic</span>(m1)  <span class="co"># objective(m1) + dof(m1)*log(nobs(m1))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>25284.162138011117</code></pre>
</div>
</div>
</section>
<section id="fixed-effect-statistics" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="fixed-effect-statistics"><span class="header-section-number">6.2</span> Fixed-effect statistics</h2>
<pre><code>+ julia&gt; coeftable(m1)     # StatsBase.coeftable: fixed-effects statiscs;
                             default level=0.95
+ julia&gt; Arrow.write("./data/m_cpx_fe.arrow", DataFrame(coeftable(m1)));
+ julia&gt; coef(m1)          # StatsBase.coef - parts of the table
+ julia&gt; fixef(m1)         # MixedModels.fixef: not the same as coef()
                             for rank-deficient case
+ julia&gt; m1.beta           # alternative extractor
+ julia&gt; fixefnames(m1)    # works also for coefnames(m1)
+ julia&gt; vcov(m1)          # StatsBase.vcov: var-cov matrix of fixed-effects coef.
+ julia&gt; stderror(m1)      # StatsBase.stderror: SE for fixed-effects coefficients
+ julia&gt; propertynames(m1) # names of available extractors</code></pre>
<div id="118" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftable</span>(m1) <span class="co"># StatsBase.coeftable: fixed-effects statiscs; default level=0.95</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="1">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 42%">
<col style="width: 17%">
<col style="width: 15%">
<col style="width: 10%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Coef.</th>
<th style="text-align: right;">Std. Error</th>
<th style="text-align: right;">z</th>
<th style="text-align: left;">Pr(&gt;</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-0.0133231</td>
<td style="text-align: right;">0.0191965</td>
<td style="text-align: right;">-0.69</td>
<td style="text-align: left;">0.4877</td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: Star_r</td>
<td style="text-align: right;">0.00883861</td>
<td style="text-align: right;">0.0374707</td>
<td style="text-align: right;">0.24</td>
<td style="text-align: left;">0.8135</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: S20_r</td>
<td style="text-align: right;">0.0091502</td>
<td style="text-align: right;">0.0292733</td>
<td style="text-align: right;">0.31</td>
<td style="text-align: left;">0.7546</td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: SLJ</td>
<td style="text-align: right;">0.00337867</td>
<td style="text-align: right;">0.0299512</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: left;">0.9102</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: BMT</td>
<td style="text-align: right;">-0.0382941</td>
<td style="text-align: right;">0.0295742</td>
<td style="text-align: right;">-1.29</td>
<td style="text-align: left;">0.1954</td>
</tr>
<tr class="even">
<td style="text-align: left;">a1</td>
<td style="text-align: right;">0.195588</td>
<td style="text-align: right;">0.0544537</td>
<td style="text-align: right;">3.59</td>
<td style="text-align: left;">0.0003</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sex: Girls</td>
<td style="text-align: right;">-0.428743</td>
<td style="text-align: right;">0.0311829</td>
<td style="text-align: right;">-13.75</td>
<td style="text-align: left;">&lt;1e-42</td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: Star_r &amp; a1</td>
<td style="text-align: right;">0.289778</td>
<td style="text-align: right;">0.0887471</td>
<td style="text-align: right;">3.27</td>
<td style="text-align: left;">0.0011</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: S20_r &amp; a1</td>
<td style="text-align: right;">-0.0784486</td>
<td style="text-align: right;">0.0817091</td>
<td style="text-align: right;">-0.96</td>
<td style="text-align: left;">0.3370</td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: SLJ &amp; a1</td>
<td style="text-align: right;">-0.0630966</td>
<td style="text-align: right;">0.0768863</td>
<td style="text-align: right;">-0.82</td>
<td style="text-align: left;">0.4118</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: BMT &amp; a1</td>
<td style="text-align: right;">0.471313</td>
<td style="text-align: right;">0.0851504</td>
<td style="text-align: right;">5.54</td>
<td style="text-align: left;">&lt;1e-07</td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: Star_r &amp; Sex: Girls</td>
<td style="text-align: right;">0.375595</td>
<td style="text-align: right;">0.0510831</td>
<td style="text-align: right;">7.35</td>
<td style="text-align: left;">&lt;1e-12</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: S20_r &amp; Sex: Girls</td>
<td style="text-align: right;">-0.186726</td>
<td style="text-align: right;">0.0475081</td>
<td style="text-align: right;">-3.93</td>
<td style="text-align: left;">&lt;1e-04</td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: SLJ &amp; Sex: Girls</td>
<td style="text-align: right;">-0.0695077</td>
<td style="text-align: right;">0.0445161</td>
<td style="text-align: right;">-1.56</td>
<td style="text-align: left;">0.1184</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: BMT &amp; Sex: Girls</td>
<td style="text-align: right;">-0.281237</td>
<td style="text-align: right;">0.0495209</td>
<td style="text-align: right;">-5.68</td>
<td style="text-align: left;">&lt;1e-07</td>
</tr>
<tr class="even">
<td style="text-align: left;">a1 &amp; Sex: Girls</td>
<td style="text-align: right;">-0.126658</td>
<td style="text-align: right;">0.104828</td>
<td style="text-align: right;">-1.21</td>
<td style="text-align: left;">0.2269</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: Star_r &amp; a1 &amp; Sex: Girls</td>
<td style="text-align: right;">-0.138202</td>
<td style="text-align: right;">0.17558</td>
<td style="text-align: right;">-0.79</td>
<td style="text-align: left;">0.4312</td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: S20_r &amp; a1 &amp; Sex: Girls</td>
<td style="text-align: right;">0.175287</td>
<td style="text-align: right;">0.163335</td>
<td style="text-align: right;">1.07</td>
<td style="text-align: left;">0.2832</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test: SLJ &amp; a1 &amp; Sex: Girls</td>
<td style="text-align: right;">-0.015449</td>
<td style="text-align: right;">0.152981</td>
<td style="text-align: right;">-0.10</td>
<td style="text-align: left;">0.9196</td>
</tr>
<tr class="even">
<td style="text-align: left;">Test: BMT &amp; a1 &amp; Sex: Girls</td>
<td style="text-align: right;">0.154782</td>
<td style="text-align: right;">0.170158</td>
<td style="text-align: right;">0.91</td>
<td style="text-align: left;">0.3630</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="120" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Arrow.write("./data/m_cpx_fe.arrow", DataFrame(coeftable(m1)));</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="122" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(m1)              <span class="co"># StatsBase.coef; parts of the table</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>20-element Vector{Float64}:
 -0.013323098599731003
  0.008838610043037353
  0.009150200653972363
  0.0033786745702838548
 -0.038294149701005455
  0.19558778043000458
 -0.4287431844207055
  0.2897784524160024
 -0.07844856274209384
 -0.06309657343028045
  0.4713127757906535
  0.37559520558051235
 -0.18672567514518862
 -0.06950765283326864
 -0.28123708084784266
 -0.12665848284693404
 -0.1382024418769914
  0.17528665552673206
 -0.015448951451204404
  0.15478177087438777</code></pre>
</div>
</div>
<div id="124" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fixef</span>(m1)    <span class="co"># MixedModels.fixef: not the same as coef() for rank-deficient case</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>20-element Vector{Float64}:
 -0.013323098599731003
  0.008838610043037353
  0.009150200653972363
  0.0033786745702838548
 -0.038294149701005455
  0.19558778043000458
 -0.4287431844207055
  0.2897784524160024
 -0.07844856274209384
 -0.06309657343028045
  0.4713127757906535
  0.37559520558051235
 -0.18672567514518862
 -0.06950765283326864
 -0.28123708084784266
 -0.12665848284693404
 -0.1382024418769914
  0.17528665552673206
 -0.015448951451204404
  0.15478177087438777</code></pre>
</div>
</div>
<div id="126" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>m1.β                  <span class="co"># alternative extractor</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>20-element Vector{Float64}:
 -0.013323098599731003
  0.008838610043037353
  0.009150200653972363
  0.0033786745702838548
 -0.038294149701005455
  0.19558778043000458
 -0.4287431844207055
  0.2897784524160024
 -0.07844856274209384
 -0.06309657343028045
  0.4713127757906535
  0.37559520558051235
 -0.18672567514518862
 -0.06950765283326864
 -0.28123708084784266
 -0.12665848284693404
 -0.1382024418769914
  0.17528665552673206
 -0.015448951451204404
  0.15478177087438777</code></pre>
</div>
</div>
<div id="128" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fixefnames</span>(m1)        <span class="co"># works also for coefnames(m1)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>20-element Vector{String}:
 "(Intercept)"
 "Test: Star_r"
 "Test: S20_r"
 "Test: SLJ"
 "Test: BMT"
 "a1"
 "Sex: Girls"
 "Test: Star_r &amp; a1"
 "Test: S20_r &amp; a1"
 "Test: SLJ &amp; a1"
 "Test: BMT &amp; a1"
 "Test: Star_r &amp; Sex: Girls"
 "Test: S20_r &amp; Sex: Girls"
 "Test: SLJ &amp; Sex: Girls"
 "Test: BMT &amp; Sex: Girls"
 "a1 &amp; Sex: Girls"
 "Test: Star_r &amp; a1 &amp; Sex: Girls"
 "Test: S20_r &amp; a1 &amp; Sex: Girls"
 "Test: SLJ &amp; a1 &amp; Sex: Girls"
 "Test: BMT &amp; a1 &amp; Sex: Girls"</code></pre>
</div>
</div>
<div id="130" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vcov</span>(m1)   <span class="co"># StatsBase.vcov: var-cov matrix of fixed-effects coefficients</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>20×20 Matrix{Float64}:
  0.000368507   2.44342e-5   -1.70167e-5   …   3.88654e-6    2.86561e-6
  2.44342e-5    0.00140405   -0.000421338     -9.36638e-7   -1.02894e-7
 -1.70167e-5   -0.000421338   0.000856925      2.05905e-5   -6.93885e-7
 -2.70244e-5    5.45269e-5   -0.000468523     -2.44479e-5    1.37177e-6
 -0.000143181   3.24318e-5   -7.84036e-6       1.42252e-6   -1.19388e-5
 -4.45756e-5   -7.41319e-5    2.71349e-5   …  -6.00773e-5   -5.10063e-5
 -4.42921e-5    6.31848e-5    4.36702e-5      -7.38387e-5    0.000282261
 -2.72845e-5   -0.000442502   0.000212823      8.7135e-6     2.60536e-6
  3.37114e-6    0.000213207  -0.000395339     -0.000104421   8.19859e-6
 -2.00104e-5    9.27317e-8    0.000175292      0.000158974  -6.11699e-5
  7.30239e-5   -2.67159e-5    2.85901e-5   …  -5.78764e-5    8.27668e-5
  6.87754e-6    8.83986e-7   -2.07244e-6       8.74402e-6   -0.000108167
  5.13701e-6   -1.97254e-6    7.70952e-6       0.000673632   0.000118037
 -5.21248e-6   -1.56374e-6   -4.65457e-6      -0.00136386    0.000576685
 -1.1505e-6     6.37318e-7   -9.09835e-7       0.000577351  -0.00171455
 -4.53729e-6   -1.20613e-5    3.47115e-7   …   0.000152123  -0.00391934
 -1.27935e-5   -2.83726e-5    2.85735e-5      -0.000140172   0.00179133
  4.7094e-7     2.86411e-5   -4.71121e-5      -0.0115791    -0.00195509
  3.88654e-6   -9.36638e-7    2.05905e-5       0.0234033    -0.00998405
  2.86561e-6   -1.02894e-7   -6.93885e-7      -0.00998405    0.0289536</code></pre>
</div>
</div>
<div id="132" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vcov</span>(m1; corr<span class="op">=</span><span class="cn">true</span>) <span class="co"># StatsBase.vcov: correlation matrix of fixed-effects coefficients</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>20×20 Matrix{Float64}:
  1.0           0.0339691    -0.0302817    …   0.00132343    0.000877288
  0.0339691     1.0          -0.384121        -0.000163396  -1.61379e-5
 -0.0302817    -0.384121      1.0              0.00459787   -0.000139304
 -0.0470023     0.0485853    -0.534375        -0.00533568    0.000269164
 -0.252202      0.0292662    -0.00905631       0.000314419  -0.00237244
 -0.0426429    -0.0363317     0.0170228    …  -0.00721181   -0.00550484
 -0.0739925     0.054076      0.0478407       -0.0154785     0.0531965
 -0.0160155    -0.133067      0.0819207        0.000641801   0.000172529
  0.00214924    0.0696369    -0.165283        -0.00835373    0.000589681
 -0.0135576     3.21875e-5    0.0778828        0.0135157    -0.0046756
  0.0446741    -0.00837319    0.0114699    …  -0.004443      0.0057124
  0.00701347    0.000461824  -0.0013859        0.00111891   -0.0124442
  0.00563274   -0.00110807    0.00554355       0.0926864     0.0146016
 -0.00609965   -0.000937468  -0.00357183      -0.200269      0.0761325
 -0.00121025    0.00034346   -0.000627628      0.0762102    -0.203475
 -0.00225475   -0.00307062    0.000113116  …   0.00948593   -0.219728
 -0.00379571   -0.00431254    0.00555926      -0.00521853    0.0599583
  0.000150198   0.00467971   -0.00985332      -0.463402     -0.0703454
  0.00132343   -0.000163396   0.00459787       1.0          -0.383546
  0.000877288  -1.61379e-5   -0.000139304     -0.383546      1.0</code></pre>
</div>
</div>
<div id="134" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stderror</span>(m1)       <span class="co"># StatsBase.stderror: SE for fixed-effects coefficients</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>20-element Vector{Float64}:
 0.01919652732574372
 0.03747068322761317
 0.029273285330210397
 0.02995116114500642
 0.029574196102221305
 0.05445374107486756
 0.031182881518992782
 0.08874709312691241
 0.08170907406598975
 0.0768863280893603
 0.08515035859926307
 0.051083135211708375
 0.047508147450545
 0.04451607577961671
 0.049520893473334576
 0.10482774123584619
 0.17557988961760165
 0.16333492470289673
 0.15298128937140495
 0.1701576435993861</code></pre>
</div>
</div>
<div id="136" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">propertynames</span>(m1)  <span class="co"># names of available extractors</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>(:formula, :reterms, :Xymat, :feterm, :sqrtwts, :parmap, :dims, :A, :L, :optsum, :θ, :theta, :β, :beta, :βs, :betas, :λ, :lambda, :stderror, :σ, :sigma, :σs, :sigmas, :σρs, :sigmarhos, :b, :u, :lowerbd, :X, :y, :corr, :vcov, :PCA, :rePCA, :objective, :pvalues)</code></pre>
</div>
</div>
</section>
<section id="covariance-parameter-estimates" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="covariance-parameter-estimates"><span class="header-section-number">6.3</span> Covariance parameter estimates</h2>
<p>These commands inform us about the model parameters associated with the RES.</p>
<pre><code>+ julia&gt; issingular(m1)        # Test singularity for param. vector m1.theta
+ julia&gt; VarCorr(m1)           # MixedModels.VarCorr: est. of RES
+ julia&gt; propertynames(m1)
+ julia&gt; m1.σ                  # residual; or: m1.sigma
+ julia&gt; m1.σs                 # VCs; m1.sigmas
+ julia&gt; m1.θ                  # Parameter vector for RES (w/o residual); m1.theta
+ julia&gt; MixedModels.sdest(m1) #  prsqrt(MixedModels.varest(m1))
+ julia&gt; BlockDescription(m1)  #  Description of blocks of A and L in an LMM</code></pre>
<div id="138" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">issingular</span>(m1) <span class="co"># Test if model is singular for parameter vector m1.theta (default)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>true</code></pre>
</div>
</div>
<div id="140" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">issingular</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>true</code></pre>
</div>
</div>
<div id="142" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VarCorr</span>(m1) <span class="co"># MixedModels.VarCorr: estimates of random-effect structure (RES)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td style="text-align: left;" data-quarto-table-cell-role="th"></td>
<td style="text-align: left;" data-quarto-table-cell-role="th">Column</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">Variance</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">Std.Dev</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">Corr.</td>
<td style="text-align: right;" data-quarto-table-cell-role="th"></td>
<td style="text-align: right;" data-quarto-table-cell-role="th"></td>
<td style="text-align: right;" data-quarto-table-cell-role="th"></td>
<td style="text-align: right;" data-quarto-table-cell-role="th"></td>
<td style="text-align: right;" data-quarto-table-cell-role="th"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Child</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.34495271</td>
<td style="text-align: right;">0.58732675</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: Star_r</td>
<td style="text-align: right;">0.55269763</td>
<td style="text-align: right;">0.74343636</td>
<td style="text-align: right;">+0.14</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: S20_r</td>
<td style="text-align: right;">0.40212511</td>
<td style="text-align: right;">0.63413336</td>
<td style="text-align: right;">+0.00</td>
<td style="text-align: right;">-0.52</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: SLJ</td>
<td style="text-align: right;">0.29385597</td>
<td style="text-align: right;">0.54208484</td>
<td style="text-align: right;">+0.05</td>
<td style="text-align: right;">-0.04</td>
<td style="text-align: right;">-0.35</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: BMT</td>
<td style="text-align: right;">0.52032198</td>
<td style="text-align: right;">0.72133347</td>
<td style="text-align: right;">-0.35</td>
<td style="text-align: right;">+0.14</td>
<td style="text-align: right;">-0.18</td>
<td style="text-align: right;">-0.22</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">School</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.04570702</td>
<td style="text-align: right;">0.21379201</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: Star_r</td>
<td style="text-align: right;">0.11076869</td>
<td style="text-align: right;">0.33281931</td>
<td style="text-align: right;">-0.06</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: S20_r</td>
<td style="text-align: right;">0.10761018</td>
<td style="text-align: right;">0.32803990</td>
<td style="text-align: right;">-0.08</td>
<td style="text-align: right;">-0.39</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: SLJ</td>
<td style="text-align: right;">0.10318843</td>
<td style="text-align: right;">0.32122956</td>
<td style="text-align: right;">-0.19</td>
<td style="text-align: right;">+0.21</td>
<td style="text-align: right;">-0.81</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: BMT</td>
<td style="text-align: right;">0.09795181</td>
<td style="text-align: right;">0.31297254</td>
<td style="text-align: right;">-0.33</td>
<td style="text-align: right;">-0.02</td>
<td style="text-align: right;">+0.13</td>
<td style="text-align: right;">-0.38</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">a1</td>
<td style="text-align: right;">0.07982565</td>
<td style="text-align: right;">0.28253433</td>
<td style="text-align: right;">+0.62</td>
<td style="text-align: right;">-0.20</td>
<td style="text-align: right;">+0.11</td>
<td style="text-align: right;">-0.61</td>
<td style="text-align: right;">+0.45</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Sex: Girls</td>
<td style="text-align: right;">0.02059180</td>
<td style="text-align: right;">0.14349843</td>
<td style="text-align: right;">-0.45</td>
<td style="text-align: right;">+0.45</td>
<td style="text-align: right;">+0.31</td>
<td style="text-align: right;">-0.27</td>
<td style="text-align: right;">-0.15</td>
<td style="text-align: right;">-0.37</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cohort</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.00017441</td>
<td style="text-align: right;">0.01320652</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: Star_r</td>
<td style="text-align: right;">0.00406549</td>
<td style="text-align: right;">0.06376120</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: S20_r</td>
<td style="text-align: right;">0.00005702</td>
<td style="text-align: right;">0.00755108</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: SLJ</td>
<td style="text-align: right;">0.00114959</td>
<td style="text-align: right;">0.03390556</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: BMT</td>
<td style="text-align: right;">0.00000000</td>
<td style="text-align: right;">0.00000000</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Residual</td>
<td style="text-align: left;"></td>
<td style="text-align: right;">0.28422522</td>
<td style="text-align: right;">0.53312777</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="144" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VarCorr</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td style="text-align: left;" data-quarto-table-cell-role="th"></td>
<td style="text-align: left;" data-quarto-table-cell-role="th">Column</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">Variance</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">Std.Dev</td>
<td style="text-align: right;" data-quarto-table-cell-role="th">Corr.</td>
<td style="text-align: right;" data-quarto-table-cell-role="th"></td>
<td style="text-align: right;" data-quarto-table-cell-role="th"></td>
<td style="text-align: right;" data-quarto-table-cell-role="th"></td>
<td style="text-align: right;" data-quarto-table-cell-role="th"></td>
<td style="text-align: right;" data-quarto-table-cell-role="th"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Child</td>
<td style="text-align: left;">Test: Run</td>
<td style="text-align: right;">0.5622290</td>
<td style="text-align: right;">0.7498193</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: Star_r</td>
<td style="text-align: right;">0.6350899</td>
<td style="text-align: right;">0.7969253</td>
<td style="text-align: right;">+0.50</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: S20_r</td>
<td style="text-align: right;">0.5890796</td>
<td style="text-align: right;">0.7675152</td>
<td style="text-align: right;">+0.56</td>
<td style="text-align: right;">+0.64</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: SLJ</td>
<td style="text-align: right;">0.6089346</td>
<td style="text-align: right;">0.7803426</td>
<td style="text-align: right;">+0.55</td>
<td style="text-align: right;">+0.60</td>
<td style="text-align: right;">+0.72</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: BMT</td>
<td style="text-align: right;">0.4854398</td>
<td style="text-align: right;">0.6967351</td>
<td style="text-align: right;">+0.19</td>
<td style="text-align: right;">+0.40</td>
<td style="text-align: right;">+0.37</td>
<td style="text-align: right;">+0.49</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">School</td>
<td style="text-align: left;">Test: Run</td>
<td style="text-align: right;">0.1370455</td>
<td style="text-align: right;">0.3701965</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: Star_r</td>
<td style="text-align: right;">0.0962783</td>
<td style="text-align: right;">0.3102874</td>
<td style="text-align: right;">+0.53</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: S20_r</td>
<td style="text-align: right;">0.1092383</td>
<td style="text-align: right;">0.3305122</td>
<td style="text-align: right;">+0.47</td>
<td style="text-align: right;">+0.48</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: SLJ</td>
<td style="text-align: right;">0.0613838</td>
<td style="text-align: right;">0.2477575</td>
<td style="text-align: right;">+0.47</td>
<td style="text-align: right;">+0.76</td>
<td style="text-align: right;">+0.41</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: BMT</td>
<td style="text-align: right;">0.0387541</td>
<td style="text-align: right;">0.1968606</td>
<td style="text-align: right;">+0.15</td>
<td style="text-align: right;">+0.38</td>
<td style="text-align: right;">+0.18</td>
<td style="text-align: right;">+0.02</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">a1</td>
<td style="text-align: right;">0.0802336</td>
<td style="text-align: right;">0.2832554</td>
<td style="text-align: right;">+0.58</td>
<td style="text-align: right;">+0.47</td>
<td style="text-align: right;">+0.56</td>
<td style="text-align: right;">-0.05</td>
<td style="text-align: right;">+0.65</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Sex: Girls</td>
<td style="text-align: right;">0.0205546</td>
<td style="text-align: right;">0.1433686</td>
<td style="text-align: right;">-0.63</td>
<td style="text-align: right;">-0.27</td>
<td style="text-align: right;">+0.06</td>
<td style="text-align: right;">-0.28</td>
<td style="text-align: right;">-0.58</td>
<td style="text-align: right;">-0.37</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cohort</td>
<td style="text-align: left;">Test: Run</td>
<td style="text-align: right;">0.0030066</td>
<td style="text-align: right;">0.0548320</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: Star_r</td>
<td style="text-align: right;">0.0004344</td>
<td style="text-align: right;">0.0208416</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: S20_r</td>
<td style="text-align: right;">0.0031716</td>
<td style="text-align: right;">0.0563170</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: SLJ</td>
<td style="text-align: right;">0.0002448</td>
<td style="text-align: right;">0.0156459</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Test: BMT</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Residual</td>
<td style="text-align: left;"></td>
<td style="text-align: right;">0.2623127</td>
<td style="text-align: right;">0.5121647</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="146" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>m1.σs      <span class="co"># VCs; m1.sigmas</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>(Child = (var"(Intercept)" = 0.58732674709639, var"Test: Star_r" = 0.7434363644610155, var"Test: S20_r" = 0.6341333569851855, var"Test: SLJ" = 0.542084839663831, var"Test: BMT" = 0.7213334730280074), School = (var"(Intercept)" = 0.21379201285323374, var"Test: Star_r" = 0.3328193108027132, var"Test: S20_r" = 0.3280398999015345, var"Test: SLJ" = 0.32122955990402635, var"Test: BMT" = 0.31297254325848156, a1 = 0.2825343257018283, var"Sex: Girls" = 0.14349842884369796), Cohort = (var"(Intercept)" = 0.013206524133973831, var"Test: Star_r" = 0.06376119875100951, var"Test: S20_r" = 0.0075510776232103555, var"Test: SLJ" = 0.033905564967234667, var"Test: BMT" = 0.0))</code></pre>
</div>
</div>
<div id="148" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>m1.θ       <span class="co"># Parameter vector for RES (w/o residual); m1.theta</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>48-element Vector{Float64}:
  1.1016622708905508
  0.199835310203799
  0.0007687193071826845
  0.04921136459080601
 -0.4672660515500969
  1.3800877425160862
 -0.6269901567906759
 -0.04925944187798209
  0.25246320095240976
  1.0107889422013527
  ⋮
 -0.1650040625391254
  0.017653103520679392
 -0.005432524642045863
  0.0
  0.024771780682443064
  0.11959834514264477
  0.014163729752105945
  0.06359744704679811
  0.0</code></pre>
</div>
</div>
<div id="150" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">BlockDescription</span>(m1) <span class="co">#  Description of blocks of A and L in a LinearMixedModel</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td style="text-align: left;" data-quarto-table-cell-role="th">rows</td>
<td style="text-align: left;" data-quarto-table-cell-role="th">Child</td>
<td style="text-align: left;" data-quarto-table-cell-role="th">School</td>
<td style="text-align: left;" data-quarto-table-cell-role="th">Cohort</td>
<td style="text-align: left;" data-quarto-table-cell-role="th">fixed</td>
</tr>
<tr class="even">
<td style="text-align: left;">9930</td>
<td style="text-align: left;">BlkDiag</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">3101</td>
<td style="text-align: left;">Sparse</td>
<td style="text-align: left;">BlkDiag</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">45</td>
<td style="text-align: left;">Dense</td>
<td style="text-align: left;">Dense</td>
<td style="text-align: left;">BlkDiag/Dense</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">21</td>
<td style="text-align: left;">Dense</td>
<td style="text-align: left;">Dense</td>
<td style="text-align: left;">Dense</td>
<td style="text-align: left;">Dense</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="152" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>m2.θ</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>48-element Vector{Float64}:
  1.464019911728255
  0.7822363274753275
  0.842409314371142
  0.8433757455902053
  0.26413446683350555
  1.3450740553826162
  0.6154158471181771
  0.5681284803530833
  0.48038263080030397
  1.075790626516376
  ⋮
 -0.18622672591150657
  0.0013289707983532247
 -6.60220078341385e-5
  0.0
  0.1070593783172049
  0.040693237170298845
  0.1099588509456823
  0.030548645240017568
  0.0</code></pre>
</div>
</div>
<div id="154" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">BlockDescription</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td style="text-align: left;" data-quarto-table-cell-role="th">rows</td>
<td style="text-align: left;" data-quarto-table-cell-role="th">Child</td>
<td style="text-align: left;" data-quarto-table-cell-role="th">School</td>
<td style="text-align: left;" data-quarto-table-cell-role="th">Cohort</td>
<td style="text-align: left;" data-quarto-table-cell-role="th">fixed</td>
</tr>
<tr class="even">
<td style="text-align: left;">9930</td>
<td style="text-align: left;">BlkDiag</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">3101</td>
<td style="text-align: left;">Sparse</td>
<td style="text-align: left;">BlkDiag</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">45</td>
<td style="text-align: left;">Dense</td>
<td style="text-align: left;">Dense</td>
<td style="text-align: left;">BlkDiag/Dense</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">21</td>
<td style="text-align: left;">Dense</td>
<td style="text-align: left;">Dense</td>
<td style="text-align: left;">Dense</td>
<td style="text-align: left;">Dense</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="model-predictions" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="model-predictions"><span class="header-section-number">6.4</span> Model “predictions”</h2>
<p>These commands inform us about extracion of conditional modes/means and (co-)variances, that using the model parameters to improve the predictions for units (levels) of the grouping (random) factors. We need this information, e.g., for partial-effect response profiles (e.g., facet plot) or effect profiles (e.g., caterpillar plot), or visualizing the borrowing-strength effect for correlation parameters (e.g., shrinkage plots). We are using the fit of LMM <code>m2</code>.</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode jl code-with-copy"><code class="sourceCode julia"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>julia<span class="op">&gt;</span> <span class="fu">condVar</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Some plotting functions are currently available from the <code>MixedModelsMakie</code> package or via custom functions.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode jl code-with-copy"><code class="sourceCode julia"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> julia<span class="op">&gt;</span> <span class="fu">caterpillar!</span>(m2)</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="op">+</span> julia<span class="op">&gt;</span> <span class="fu">shrinkage!</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="conditional-covariances" class="level3" data-number="6.4.1">
<h3 data-number="6.4.1" class="anchored" data-anchor-id="conditional-covariances"><span class="header-section-number">6.4.1</span> Conditional covariances</h3>
<div id="156" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">condVar</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3-element Vector{Array{Float64, 3}}:
 [0.058517014101499745 0.009125061044062778 … 0.003278708654799139 -0.02203512152066885; 0.009125061044062778 0.2881484213953011 … -0.00858828480580812 0.02637014650433069; … ; 0.003278708654799139 -0.00858828480580812 … 0.1948955299646874 -0.07616988873567451; -0.02203512152066885 0.02637014650433069 … -0.07616988873567451 0.25747094954024247;;; 0.06479408146453051 0.011134998138892753 … 0.003908367629588989 -0.028871049730723873; 0.011134998138892753 0.29633356972928204 … -0.007311382249300798 0.027042641223018752; … ; 0.003908367629588989 -0.007311382249300798 … 0.19801398892464123 -0.07674628588169728; -0.028871049730723873 0.027042641223018752 … -0.07674628588169728 0.2663833521833813;;; 0.06199490961166209 0.010378470648666283 … 0.0033211887933385473 -0.025799744230828064; 0.010378470648666283 0.2919637022019177 … -0.008099599279587298 0.02645587001375013; … ; 0.0033211887933385473 -0.008099599279587298 … 0.19709146464205915 -0.07626677986337765; -0.025799744230828064 0.02645587001375013 … -0.07626677986337765 0.26226810420768637;;; … ;;; 0.09251275858088985 0.011430464054488698 … -0.004372759710309024 -0.025512877879956514; 0.011430464054488698 0.29433912821382646 … -0.008626529501006942 0.02760443787517547; … ; -0.004372759710309024 -0.008626529501006942 … 0.196293768010921 -0.07428957822771329; -0.025512877879956514 0.02760443787517547 … -0.07428957822771329 0.26236636750253356;;; 0.09874036143268264 0.009185552998062238 … -0.0001573075613284164 -0.02462263824544809; 0.009185552998062238 0.2911679711936218 … -0.008776482510154664 0.027936646374801047; … ; -0.0001573075613284164 -0.008776482510154664 … 0.19584727323067816 -0.07501977375670275; -0.02462263824544809 0.027936646374801047 … -0.07501977375670275 0.2596118385454262;;; 0.08569687177833775 0.008946686416428581 … 0.0006592569895041175 -0.02086375290989933; 0.008946686416428581 0.28863042124474664 … -0.008936779278627875 0.02745669612294799; … ; 0.0006592569895041175 -0.008936779278627875 … 0.1948682013379163 -0.07525256402491896; -0.02086375290989933 0.02745669612294799 … -0.07525256402491896 0.2567755880517776]
 [0.03738662222206967 -0.0018006453467180224 … 0.029918884081614444 -0.01241043132709623; -0.0018006453467180224 0.09043180671160218 … -0.012288226712182382 0.017349422342826458; … ; 0.029918884081614444 -0.012288226712182382 … 0.06552240047084834 -0.012696720591960402; -0.01241043132709623 0.017349422342826458 … -0.012696720591960402 0.018266200494610186;;; 0.032175235508378135 0.0002020231146900986 … 0.026239700886540457 -0.010631094016241854; 0.0002020231146900986 0.07633547772742386 … -0.0076489885496848755 0.014171038510892612; … ; 0.026239700886540457 -0.0076489885496848755 … 0.057371204435359965 -0.010702426636433508; -0.010631094016241854 0.014171038510892612 … -0.010702426636433508 0.015840463462564926;;; 0.0293211217872406 -0.0031722468514524776 … 0.021508439538618022 -0.010442275909060876; -0.0031722468514524776 0.08771293893576042 … -0.013169827546768145 0.01806934628580798; … ; 0.021508439538618022 -0.013169827546768145 … 0.051822149216928896 -0.010311386841756282; -0.010442275909060876 0.01806934628580798 … -0.010311386841756282 0.016719819496053525;;; … ;;; 0.0267612826186117 0.002887196156566762 … 0.019017122735360242 -0.006845576372521417; 0.002887196156566762 0.07608301622502864 … -0.005537174830550229 0.012875566802524871; … ; 0.019017122735360242 -0.005537174830550229 … 0.050902196361920206 -0.006078576026170587; -0.006845576372521417 0.012875566802524871 … -0.006078576026170587 0.013661101965124827;;; 0.027228645015369164 0.003500454962860299 … 0.020300439683147174 -0.006150803022415798; 0.003500454962860299 0.07600122149129579 … -0.005010775855234807 0.012574439977365934; … ; 0.020300439683147174 -0.005010775855234807 … 0.05302863567353013 -0.00626554725377429; -0.006150803022415798 0.012574439977365934 … -0.00626554725377429 0.013684452210043274;;; 0.043339821193180326 -0.0030818917690474392 … 0.03637959916087954 -0.01363338241537408; -0.0030818917690474392 0.0993577864113983 … -0.015052524931708725 0.019104775094131096; … ; 0.03637959916087954 -0.015052524931708725 … 0.07506039488224463 -0.014302079998948012; -0.01363338241537408 0.019104775094131096 … -0.014302079998948012 0.019440414377459254]
 [0.00016380655132630802 6.905263271054442e-6 … -4.776505132880116e-6 0.0; 6.905263271054442e-6 0.002357685591177613 … -0.0001535595839979168 0.0; … ; -4.776505132880116e-6 -0.0001535595839979168 … 0.0008635382997135062 0.0; 0.0 0.0 … 0.0 0.0;;; 0.00016040198449826642 8.762829702597266e-6 … -6.068571712892409e-6 0.0; 8.762829702597266e-6 0.002044995779766137 … -0.0001672018085446938 0.0; … ; -6.068571712892409e-6 -0.0001672018085446938 … 0.000795065708027814 0.0; 0.0 0.0 … 0.0 0.0;;; 0.00016236819064567072 7.626721927893261e-6 … -5.190387582391803e-6 0.0; 7.626721927893261e-6 0.002242186063452188 … -0.00015894848127273218 0.0; … ; -5.190387582391803e-6 -0.00015894848127273218 … 0.0008353101094087038 0.0; 0.0 0.0 … 0.0 0.0;;; 0.00016175490481618921 8.411278134019113e-6 … -5.514796437067044e-6 0.0; 8.411278134019113e-6 0.0021643858461830056 … -0.00016336647221245931 0.0; … ; -5.514796437067044e-6 -0.00016336647221245931 … 0.0008232493551568546 0.0; 0.0 0.0 … 0.0 0.0;;; 0.00015933306329354854 8.683518670335156e-6 … -6.949857071192867e-6 0.0; 8.683518670335156e-6 0.001962786328235615 … -0.0001688729211888127 0.0; … ; -6.949857071192867e-6 -0.0001688729211888127 … 0.0007737698549017665 0.0; 0.0 0.0 … 0.0 0.0;;; 0.0001585591247886362 7.442199159884006e-6 … -7.387837364196275e-6 0.0; 7.442199159884006e-6 0.0019342658473775333 … -0.0001675218103327855 0.0; … ; -7.387837364196275e-6 -0.0001675218103327855 … 0.0007566342723566994 0.0; 0.0 0.0 … 0.0 0.0;;; 0.00016065497306304335 8.005529319817548e-6 … -6.461140807188436e-6 0.0; 8.005529319817548e-6 0.0020775998050236873 … -0.00016680712988184607 0.0; … ; -6.461140807188436e-6 -0.00016680712988184607 … 0.0007993999850391486 0.0; 0.0 0.0 … 0.0 0.0;;; 0.00015831595367890705 8.46712980408871e-6 … -7.964470854652428e-6 0.0; 8.46712980408871e-6 0.0018894476583808555 … -0.00017251367903727097 0.0; … ; -7.964470854652428e-6 -0.00017251367903727097 … 0.0007531486757886536 0.0; 0.0 0.0 … 0.0 0.0;;; 0.00015649962194566806 9.755584275305604e-6 … -7.749920208393922e-6 0.0; 9.755584275305604e-6 0.0017892434008092122 … -0.00017175668964200161 0.0; … ; -7.749920208393922e-6 -0.00017175668964200161 … 0.0007269191158251669 0.0; 0.0 0.0 … 0.0 0.0]</code></pre>
</div>
</div>
<div id="158" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">condVar</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3-element Vector{Array{Float64, 3}}:
 [0.17121835522819978 0.02755529331418949 … 0.03416706723888015 -0.00724754030926216; 0.02755529331418949 0.17389268509524453 … 0.03753020675650032 0.0188623774335696; … ; 0.03416706723888015 0.03753020675650032 … 0.16031637538660184 0.028820239120887613; -0.00724754030926216 0.0188623774335696 … 0.028820239120887613 0.160864500973238;;; 0.18242691671642797 0.0343250931186835 … 0.04147060082369551 -0.009143227675242742; 0.0343250931186835 0.18567343287578988 … 0.04866689163492084 0.021405410618718965; … ; 0.04147060082369551 0.04866689163492084 … 0.17266718224767022 0.03123733241019097; -0.009143227675242742 0.021405410618718965 … 0.03123733241019097 0.16331432606425472;;; 0.1762667317205972 0.0311279231692659 … 0.038186553972383325 -0.007994491834495502; 0.0311279231692659 0.18039096830847456 … 0.04354026417410434 0.02014451692076348; … ; 0.038186553972383325 0.04354026417410434 … 0.1670059987629768 0.030077380180769695; -0.007994491834495502 0.02014451692076348 … 0.030077380180769695 0.16204289027390376;;; … ;;; 0.21741247314653891 0.07093054334800777 … 0.06747150120313818 0.02145098713166718; 0.07093054334800777 0.22154962297484282 … 0.07284423050626627 0.05096352617049405; … ; 0.06747150120313818 0.07284423050626627 … 0.18375387349238714 0.05065449550765889; 0.02145098713166718 0.05096352617049405 … 0.05065449550765889 0.18636447571570958;;; 0.22425843774021273 0.07771036649190435 … 0.07692945052170154 0.032146495017884365; 0.07771036649190435 0.22464983667288474 … 0.07893678447646196 0.058693580990441856; … ; 0.07692945052170154 0.07893678447646196 … 0.192417812551263 0.06096244826047057; 0.032146495017884365 0.058693580990441856 … 0.06096244826047057 0.1952055411652199;;; 0.20613389930796294 0.0614937415744954 … 0.062270378347748845 0.02206740872792677; 0.0614937415744954 0.20740253938205164 … 0.06405704423364168 0.047854049528350144; … ; 0.062270378347748845 0.06405704423364168 … 0.179269076031725 0.0517136334805597; 0.02206740872792677 0.047854049528350144 … 0.0517136334805597 0.18687984024155918]
 [0.10768671208086496 0.04839952818075811 … 0.04766653444192149 -0.027767847991630235; 0.04839952818075811 0.07949753046909964 … 0.03493825637829439 -0.01030835164217005; … ; 0.04766653444192149 0.03493825637829439 … 0.06574810342307015 -0.01275585556178704; -0.027767847991630235 -0.01030835164217005 … -0.01275585556178704 0.018227082481554094;;; 0.08790407612332059 0.040393261282076404 … 0.0400599319562759 -0.02269489800607808; 0.040393261282076404 0.06914721694875275 … 0.03206702198915689 -0.008425353467929443; … ; 0.0400599319562759 0.03206702198915689 … 0.05749755077922079 -0.010761924798630933; -0.02269489800607808 -0.008425353467929443 … -0.010761924798630933 0.015807162176876503;;; 0.09636492785218488 0.035884742431221237 … 0.038333680468635785 -0.025416695484362636; 0.035884742431221237 0.06308321756031697 … 0.02476724723597186 -0.007242081284198682; … ; 0.038333680468635785 0.02476724723597186 … 0.05198552853377316 -0.010391082211543702; -0.025416695484362636 -0.007242081284198682 … -0.010391082211543702 0.01668905433983563;;; … ;;; 0.07441056179847254 0.0305275873520764 … 0.029374260939504657 -0.017029674955578736; 0.0305275873520764 0.06267297540942841 … 0.02349135736015709 -0.004060003964855782; … ; 0.029374260939504657 0.02349135736015709 … 0.05102700756299053 -0.006132825015515446; -0.017029674955578736 -0.004060003964855782 … -0.006132825015515446 0.013633872415800339;;; 0.07356358901088007 0.030536524186054008 … 0.0301082996724446 -0.016067883424430905; 0.030536524186054008 0.06346336276661714 … 0.024768348896849156 -0.0033951944729095373; … ; 0.0301082996724446 0.024768348896849156 … 0.053147386583431176 -0.006319089569004934; -0.016067883424430905 -0.0033951944729095373 … -0.006319089569004934 0.013656675423188653;;; 0.12473526100613286 0.05796391233780463 … 0.05756242970998203 -0.031000768758675107; 0.05796391233780463 0.09050849232950609 … 0.042023372901318 -0.011779510213246015; … ; 0.05756242970998203 0.042023372901318 … 0.07536073523942259 -0.014362415085092188; -0.031000768758675107 -0.011779510213246015 … -0.014362415085092188 0.01940248264853897]
 [0.0018738580389070167 3.097002198457398e-5 … 2.2076784503534793e-5 0.0; 3.097002198457398e-5 0.00039802187403120584 … 5.648497477795947e-6 0.0; … ; 2.2076784503534793e-5 5.648497477795947e-6 … 0.00023124160140848118 0.0; 0.0 0.0 … 0.0 0.0;;; 0.0016450448619856558 3.729737750101121e-5 … 2.7027760485222434e-5 0.0; 3.729737750101121e-5 0.0003867402285022758 … 7.734284697291955e-6 0.0; … ; 2.7027760485222434e-5 7.734284697291955e-6 … 0.00022686693600509704 0.0; 0.0 0.0 … 0.0 0.0;;; 0.0017882787826426782 3.243821501424111e-5 … 2.4047614324889707e-5 0.0; 3.243821501424111e-5 0.00039393409516233735 … 6.455070883862393e-6 0.0; … ; 2.4047614324889707e-5 6.455070883862393e-6 … 0.00022946203827014857 0.0; 0.0 0.0 … 0.0 0.0;;; 0.0017313946330208606 3.4368248113981814e-5 … 2.50561873272665e-5 0.0; 3.4368248113981814e-5 0.0003918409974798727 … 6.670472162105535e-6 0.0; … ; 2.50561873272665e-5 6.670472162105535e-6 … 0.0002288103664780839 0.0; 0.0 0.0 … 0.0 0.0;;; 0.0015868478954532295 3.8887650632968376e-5 … 2.7809025410647586e-5 0.0; 3.8887650632968376e-5 0.00038367187497630265 … 8.087941724439915e-6 0.0; … ; 2.7809025410647586e-5 8.087941724439915e-6 … 0.00022546408538126053 0.0; 0.0 0.0 … 0.0 0.0;;; 0.0015688425920921166 4.000704168244891e-5 … 2.8473059101798132e-5 0.0; 4.000704168244891e-5 0.00038022839783514767 … 8.897931443372262e-6 0.0; … ; 2.8473059101798132e-5 8.897931443372262e-6 … 0.00022425219715871693 0.0; 0.0 0.0 … 0.0 0.0;;; 0.0016705183562560773 3.6934723422390205e-5 … 2.6047147905636665e-5 0.0; 3.6934723422390205e-5 0.0003871521092119287 … 7.488540995030283e-6 0.0; … ; 2.6047147905636665e-5 7.488540995030283e-6 … 0.00022711057986501076 0.0; 0.0 0.0 … 0.0 0.0;;; 0.0015336542451690207 4.090147164649518e-5 … 2.9024635466401744e-5 0.0; 4.090147164649518e-5 0.00038008695637156323 … 8.800302599711073e-6 0.0; … ; 2.9024635466401744e-5 8.800302599711073e-6 … 0.00022397611621172725 0.0; 0.0 0.0 … 0.0 0.0;;; 0.001453691844155124 4.285465800881136e-5 … 3.0624467338295236e-5 0.0; 4.285465800881136e-5 0.00037403984354553936 … 9.967957192788682e-6 0.0; … ; 3.0624467338295236e-5 9.967957192788682e-6 … 0.00022206826601886315 0.0; 0.0 0.0 … 0.0 0.0]</code></pre>
</div>
</div>
<p>They are hard to look at. Let’s take pictures.</p>
</section>
<section id="caterpillar-plots" class="level3" data-number="6.4.2">
<h3 data-number="6.4.2" class="anchored" data-anchor-id="caterpillar-plots"><span class="header-section-number">6.4.2</span> Caterpillar plots</h3>
<div id="cell-fig-caterpillarCohort" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">caterpillar!</span>(</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Figure</span>(; resolution<span class="op">=</span>(<span class="fl">800</span>, <span class="fl">400</span>)), <span class="fu">ranefinfo</span>(m1, <span class="op">:</span>Cohort)</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/qMluh/src/scenes.jl:227</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div id="fig-caterpillarcohort" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-caterpillarcohort-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fggk21_files/figure-html/fig-caterpillarcohort-output-2.svg" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-caterpillarcohort-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Prediction intervals of the random effects for Cohort in model m1
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="shrinkage-plots" class="level3" data-number="6.4.3">
<h3 data-number="6.4.3" class="anchored" data-anchor-id="shrinkage-plots"><span class="header-section-number">6.4.3</span> Shrinkage plots</h3>
<p>These are just teasers. We will pick this up in a separate tutorial. Enjoy!</p>
<div id="cell-fig-m1shrinkageCohort" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shrinkageplot!</span>(<span class="fu">Figure</span>(; resolution<span class="op">=</span>(<span class="fl">800</span>, <span class="fl">800</span>)), m1, <span class="op">:</span>Cohort)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/qMluh/src/scenes.jl:227</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div id="fig-m1shrinkagecohort" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-m1shrinkagecohort-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fggk21_files/figure-html/fig-m1shrinkagecohort-output-2.svg" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-m1shrinkagecohort-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Shrinkage plot of the random effects for Cohort in model m1
</figcaption>
</figure>
</div>
</div>
</div>
<div id="cell-fig-m2shrinkageCohort" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shrinkageplot!</span>(<span class="fu">Figure</span>(; resolution<span class="op">=</span>(<span class="fl">800</span>, <span class="fl">800</span>)), m2, <span class="op">:</span>Cohort)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>┌ Warning: Found `resolution` in the theme when creating a `Scene`. The `resolution` keyword for `Scene`s and `Figure`s has been deprecated. Use `Figure(; size = ...` or `Scene(; size = ...)` instead, which better reflects that this is a unitless size and not a pixel resolution. The key could also come from `set_theme!` calls or related theming functions.
└ @ Makie ~/.julia/packages/Makie/qMluh/src/scenes.jl:227</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div id="fig-m2shrinkagecohort" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-m2shrinkagecohort-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="fggk21_files/figure-html/fig-m2shrinkagecohort-output-2.svg" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-m2shrinkagecohort-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Shrinkage plot of the random effects for Cohort in model m2
</figcaption>
</figure>
</div>
</div>
</div>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-Fuehner2021" class="csl-entry" role="listitem">
Fühner, T., Granacher, U., Golle, K., &amp; Kliegl, R. (2021). Age and sex effects in physical fitness components of 108,295 third graders including 515 primary schools and 9 cohorts. <em>Scientific Reports</em>, <em>11</em>(1). <a href="https://doi.org/10.1038/s41598-021-97000-4">https://doi.org/10.1038/s41598-021-97000-4</a>
</div>
<div id="ref-Schielzeth2008" class="csl-entry" role="listitem">
Schielzeth, H., &amp; Forstmeier, W. (2008). Conclusions beyond support: Overconfident estimates in mixed models. <em>Behavioral Ecology</em>, <em>20</em>(2), 416–420. <a href="https://doi.org/10.1093/beheco/arn145">https://doi.org/10.1093/beheco/arn145</a>
</div>
</div>


</section>
</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/RePsychLing\.github\.io\/SMLP2024");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/RePsychLing/SMLP2024/edit/main/fggk21.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/RePsychLing/SMLP2024/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>